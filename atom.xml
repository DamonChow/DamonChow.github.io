<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å¤§èŒå°è·¯</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://damonchow.github.io/"/>
  <updated>2019-01-26T08:22:49.174Z</updated>
  <id>http://damonchow.github.io/</id>
  
  <author>
    <name>Damon</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹å¤‡å¿˜å½•æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2019/01/26/design-pattern-memento/"/>
    <id>http://damonchow.github.io/2019/01/26/design-pattern-memento/</id>
    <published>2019-01-26T03:59:17.000Z</published>
    <updated>2019-01-26T08:22:49.174Z</updated>
    
    <content type="html"><![CDATA[<div class="note info">            <h1 id="å¤‡å¿˜å½•æ¨¡å¼"><a href="#å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="å¤‡å¿˜å½•æ¨¡å¼"></a>å¤‡å¿˜å½•æ¨¡å¼</h1><p>Without violating encapsulation, capture and externalize an objectâ€™s internal state allowing the object to be restored to this state later.</p><p>åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚</p>          </div><a id="more"></a><p>æ‰€è°“å¤‡å¿˜å½•æ¨¡å¼å°±æ˜¯åœ¨ä¸ç ´åå°è£…çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œè¿™æ ·å¯ä»¥åœ¨ä»¥åå°†å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ€»æ˜¯éœ€è¦è®°å½•ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œè¿™æ ·åšçš„ç›®çš„å°±æ˜¯ä¸ºäº†å…è®¸ç”¨æˆ·å–æ¶ˆä¸ç¡®å®šæˆ–è€…é”™è¯¯çš„æ“ä½œï¼Œèƒ½å¤Ÿæ¢å¤åˆ°ä»–åŸå…ˆçš„çŠ¶æ€ï¼Œä½¿å¾—ä»–æœ‰â€åæ‚”è¯â€å¯åƒã€‚é€šè¿‡ä¸€ä¸ªå¤‡å¿˜å½•ç±»ä¸“é—¨å­˜å‚¨å¯¹è±¡çŠ¶æ€ã€‚å®¢æˆ·ä¸ä¸å¤‡å¿˜å½•ç±»è€¦åˆï¼Œä¸å¤‡å¿˜å½•ç®¡ç†ç±»è€¦åˆã€‚</p><h1 id="å¤‡å¿˜å½•æ¨¡å¼UML"><a href="#å¤‡å¿˜å½•æ¨¡å¼UML" class="headerlink" title="å¤‡å¿˜å½•æ¨¡å¼UML"></a>å¤‡å¿˜å½•æ¨¡å¼UML</h1><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fzjzi674u6j30iw06omxu.jpg" alt="uml"></p><h2 id="UMLç±»å›¾"><a href="#UMLç±»å›¾" class="headerlink" title="UMLç±»å›¾"></a>UMLç±»å›¾</h2><p>Caretakerç±»æ˜¯æŒ‡ç”¨äºä¿å­˜(createMemento())å’Œè¿˜åŸ(restore(memento))å‘èµ·æ–¹å†…éƒ¨çŠ¶æ€çš„Originatorç±»ã€‚<br>å‘èµ·æ–¹ç±»å®ç°<br>ï¼ˆ1ï¼‰createMemento()ï¼Œé€šè¿‡åˆ›å»ºå’Œè¿”å›å­˜å‚¨å‘èµ·æ–¹å½“å‰å†…éƒ¨çŠ¶æ€çš„mementoå¯¹è±¡<br>ï¼ˆ2ï¼‰é€šè¿‡ä»ä¼ å…¥çš„mementoå¯¹è±¡è¿˜åŸçŠ¶æ€æ¥è¿˜åŸ(memento)ã€‚</p><h2 id="UMLæ—¶åºå›¾"><a href="#UMLæ—¶åºå›¾" class="headerlink" title="UMLæ—¶åºå›¾"></a>UMLæ—¶åºå›¾</h2><p>ï¼ˆ1ï¼‰ä¿å­˜å‘èµ·äººçš„å†…éƒ¨çŠ¶æ€ï¼šCaretakerå¯¹Originatorè°ƒç”¨createMemento()ï¼Œåˆ›å»ºmementoå¯¹è±¡ï¼Œä¿å­˜å…¶å½“å‰å†…éƒ¨çŠ¶æ€(setState())ï¼Œå¹¶å°†mementoè¿”å›ç»™Caretakerã€‚</p><p>ï¼ˆ2ï¼‰æ¢å¤å‘èµ·äººçš„å†…éƒ¨çŠ¶æ€ï¼šCaretakerå¯¹Originatorè°ƒç”¨restore(memento)ï¼Œå¹¶æŒ‡å®šå­˜å‚¨åº”æ¢å¤çŠ¶æ€çš„mementoå¯¹è±¡ã€‚å‘èµ·è€…ä»mementoè·å–çŠ¶æ€(getState())ä»¥è®¾ç½®å…¶è‡ªå·±çš„çŠ¶æ€ã€‚</p><h1 id="å¤‡å¿˜å½•æ¨¡å¼è§’è‰²ç»“æ„"><a href="#å¤‡å¿˜å½•æ¨¡å¼è§’è‰²ç»“æ„" class="headerlink" title="å¤‡å¿˜å½•æ¨¡å¼è§’è‰²ç»“æ„"></a>å¤‡å¿˜å½•æ¨¡å¼è§’è‰²ç»“æ„</h1><p>(1) å¤‡å¿˜å½•ï¼ˆMementoï¼‰è§’è‰²ï¼šå¤‡å¿˜å½•è§’è‰²å­˜å‚¨â€œå¤‡å¿˜å‘èµ·è§’è‰²â€çš„å†…éƒ¨çŠ¶æ€ã€‚â€œå¤‡å¿˜å‘èµ·è§’è‰²â€æ ¹æ®éœ€è¦å†³å®šå¤‡å¿˜å½•è§’è‰²å­˜å‚¨â€œå¤‡å¿˜å‘èµ·è§’è‰²â€çš„å“ªäº›å†…éƒ¨çŠ¶æ€ã€‚ä¸ºäº†é˜²æ­¢â€œå¤‡å¿˜å‘èµ·è§’è‰²â€ä»¥å¤–çš„å…¶ä»–å¯¹è±¡è®¿é—®å¤‡å¿˜å½•ã€‚å¤‡å¿˜å½•å®é™…ä¸Šæœ‰ä¸¤ä¸ªæ¥å£ï¼Œâ€œå¤‡å¿˜å½•ç®¡ç†è€…è§’è‰²â€åªèƒ½çœ‹åˆ°å¤‡å¿˜å½•æä¾›çš„çª„æ¥å£â€”â€”å¯¹äºå¤‡å¿˜å½•è§’è‰²ä¸­å­˜æ”¾çš„å±æ€§æ˜¯ä¸å¯è§çš„ã€‚â€œå¤‡å¿˜å‘èµ·è§’è‰²â€åˆ™èƒ½å¤Ÿçœ‹åˆ°ä¸€ä¸ªå®½æ¥å£â€”â€”èƒ½å¤Ÿå¾—åˆ°è‡ªå·±æ”¾å…¥å¤‡å¿˜å½•è§’è‰²ä¸­å±æ€§ã€‚</p><p>(2) å¤‡å¿˜å‘èµ·ï¼ˆOriginatorï¼‰è§’è‰²ï¼šâ€œå¤‡å¿˜å‘èµ·è§’è‰²â€åˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½•ï¼Œç”¨ä»¥è®°å½•å½“å‰æ—¶åˆ»å®ƒçš„å†…éƒ¨çŠ¶æ€ã€‚åœ¨éœ€è¦æ—¶ä½¿ç”¨å¤‡å¿˜å½•æ¢å¤å†…éƒ¨çŠ¶æ€ã€‚</p><p>(3) å¤‡å¿˜å½•ç®¡ç†è€…ï¼ˆCaretakerï¼‰è§’è‰²ï¼šè´Ÿè´£ä¿å­˜å¥½å¤‡å¿˜å½•ã€‚ä¸èƒ½å¯¹å¤‡å¿˜å½•çš„å†…å®¹è¿›è¡Œæ“ä½œæˆ–æ£€æŸ¥ã€‚</p><h1 id="å¹²è´§ç¤ºä¾‹"><a href="#å¹²è´§ç¤ºä¾‹" class="headerlink" title="å¹²è´§ç¤ºä¾‹"></a>å¹²è´§ç¤ºä¾‹</h1><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci9tZW1lbnRv" title="https://github.com/DamonChow/design_pattern/tree/master/memento">æºç åœ°å€<i class="fa fa-external-link"></i></span></p><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><a href="#-1">Caretaker</a></li><li class="tab"><a href="#-2">Originator</a></li><li class="tab"><a href="#-3">Memento</a></li></ul><div class="tab-content"><div class="tab-pane active" id="-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Caretaker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">â€‹        List&lt;Memento&gt; savedStates = <span class="keyword">new</span> ArrayList();</span><br><span class="line">â€‹        Originator originator = <span class="keyword">new</span> Originator();</span><br><span class="line">â€‹        originator.set(<span class="string">â€œState1â€</span>);</span><br><span class="line">â€‹        originator.set(<span class="string">â€œState2â€</span>);</span><br><span class="line">â€‹        savedStates.add(originator.saveToMemento());</span><br><span class="line"></span><br><span class="line">â€‹        originator.set(<span class="string">â€œState3â€</span>);</span><br><span class="line">â€‹        savedStates.add(originator.saveToMemento());</span><br><span class="line"></span><br><span class="line">â€‹        originator.set(<span class="string">â€œState4â€</span>);</span><br><span class="line">â€‹        originator.restoreFromMemento(savedStates.get(<span class="number">1</span>));</span><br><span class="line">â€‹    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Originator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="keyword">private</span> String state;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="comment">//çŠ¶æ€æ›´æ”¹</span></span><br><span class="line">â€‹    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">â€‹        <span class="keyword">this</span>.state = state;</span><br><span class="line">â€‹        log.info(<span class="string">â€œOriginator: Setting state to &#123;&#125;â€</span>, state);</span><br><span class="line">â€‹    &#125;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="comment">//å°†çŠ¶æ€ä¿å­˜åˆ°å¤‡å¿˜å½•é‡Œ</span></span><br><span class="line">â€‹    <span class="function"><span class="keyword">public</span> Memento <span class="title">saveToMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">â€‹        log.info(<span class="string">â€œOriginator: Saving to Memento.â€</span>);</span><br><span class="line">â€‹        <span class="keyword">return</span> <span class="keyword">new</span> Memento(<span class="keyword">this</span>.state);</span><br><span class="line">â€‹    &#125;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="comment">//ä»å¤‡å¿˜å½•é‡Œå–å‡ºçŠ¶æ€å¹¶å›æ»š</span></span><br><span class="line">â€‹    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">restoreFromMemento</span><span class="params">(Memento memento)</span> </span>&#123;</span><br><span class="line">â€‹        <span class="keyword">this</span>.state = memento.getState();</span><br><span class="line">â€‹        log.info(<span class="string">â€œOriginator: State after restoring from Memento: &#123;&#125;â€</span>, state);</span><br><span class="line">â€‹    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Memento</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="comment">//çŠ¶æ€ç»´æŠ¤</span></span><br><span class="line">â€‹    <span class="keyword">private</span> String state;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div></div><p>ç¤ºä¾‹ç»“æœ</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fzk24eet38j3258090gof.jpg" alt="image-20190126161658817"></p><p>ä»ä¸Šè¿°ä»£ç ä¸­çœ‹çš„å‡ºï¼Œéšç€çŠ¶æ€å˜æ›´ï¼Œç”¨Listç»´æŠ¤å‘èµ·è€…çš„çŠ¶æ€åˆ—è¡¨ï¼Œä»å¤‡å¿˜å½•ä¸­å–å‡ºçŠ¶æ€ä»¥ä¾¿å›é€€çŠ¶æ€ã€‚</p><h1 id="javaä¸­çš„ä½¿ç”¨"><a href="#javaä¸­çš„ä½¿ç”¨" class="headerlink" title="javaä¸­çš„ä½¿ç”¨"></a>javaä¸­çš„ä½¿ç”¨</h1><p>ç”Ÿæˆå¯¹è±¡çŠ¶æ€çš„ä¸€ä¸ªå¿«ç…§ï¼Œä»¥ä¾¿å¯¹è±¡å¯ä»¥æ¢å¤åŸå§‹çŠ¶æ€è€Œä¸ç”¨æš´éœ²è‡ªèº«çš„å†…å®¹ã€‚Dateå¯¹è±¡é€šè¿‡è‡ªèº«å†…éƒ¨çš„ä¸€ä¸ªlongå€¼æ¥å®ç°å¤‡å¿˜å½•æ¨¡å¼ã€‚</p><p>java.util.Date</p><p>java.io.Serializable</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a><strong>ä¼˜ç‚¹</strong></h2><p> 1ã€ç»™ç”¨æˆ·æä¾›äº†ä¸€ç§å¯ä»¥æ¢å¤çŠ¶æ€çš„æœºåˆ¶ï¼Œå¯ä»¥ä½¿ç”¨æˆ·èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿åœ°å›åˆ°æŸä¸ªå†å²çš„çŠ¶æ€ã€‚ 2ã€å®ç°äº†ä¿¡æ¯çš„å°è£…ï¼Œä½¿å¾—ç”¨æˆ·ä¸éœ€è¦å…³å¿ƒçŠ¶æ€çš„ä¿å­˜ç»†èŠ‚ã€‚</p><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a><strong>ç¼ºç‚¹</strong></h2><p>æ¶ˆè€—èµ„æºã€‚å¦‚æœç±»çš„æˆå‘˜å˜é‡è¿‡å¤šï¼ŒåŠ¿å¿…ä¼šå ç”¨æ¯”è¾ƒå¤§çš„èµ„æºï¼Œè€Œä¸”æ¯ä¸€æ¬¡ä¿å­˜éƒ½ä¼šæ¶ˆè€—ä¸€å®šçš„å†…å­˜ã€‚</p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a><strong>ä½¿ç”¨åœºæ™¯</strong></h2><p>1ã€éœ€è¦ä¿å­˜/æ¢å¤æ•°æ®çš„ç›¸å…³çŠ¶æ€åœºæ™¯ã€‚ 2ã€æä¾›ä¸€ä¸ªå¯å›æ»šçš„æ“ä½œã€‚</p><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a><strong>æ³¨æ„äº‹é¡¹</strong></h2><p>1ã€ä¸ºäº†ç¬¦åˆè¿ªç±³ç‰¹åŸåˆ™ï¼Œè¿˜è¦å¢åŠ ä¸€ä¸ªç®¡ç†å¤‡å¿˜å½•çš„ç±»ã€‚ 2ã€ä¸ºäº†èŠ‚çº¦å†…å­˜ï¼Œå¯ä½¿ç”¨åŸå‹æ¨¡å¼+å¤‡å¿˜å½•æ¨¡å¼ã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2Rlc2lnbi1wYXR0ZXJuL21lbWVudG8tcGF0dGVybi5odG1s" title="http://www.runoob.com/design-pattern/memento-pattern.html">å¤‡å¿˜å½•æ¨¡å¼|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTWVtZW50b19wYXR0ZXJu" title="https://en.wikipedia.org/wiki/Memento_pattern">Memento pattern<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdGlueWtpbmcvcC81OTM4NTQ3Lmh0bWw=" title="https://www.cnblogs.com/tinyking/p/5938547.html">ç»†æ•°JDKé‡Œçš„è®¾è®¡æ¨¡å¼<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;
            &lt;h1 id=&quot;å¤‡å¿˜å½•æ¨¡å¼&quot;&gt;&lt;a href=&quot;#å¤‡å¿˜å½•æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;å¤‡å¿˜å½•æ¨¡å¼&quot;&gt;&lt;/a&gt;å¤‡å¿˜å½•æ¨¡å¼&lt;/h1&gt;&lt;p&gt;Without violating encapsulation, capture and externalize an objectâ€™s internal state allowing the object to be restored to this state later.&lt;/p&gt;&lt;p&gt;åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2019/01/24/design-pattern-observer/"/>
    <id>http://damonchow.github.io/2019/01/24/design-pattern-observer/</id>
    <published>2019-01-24T02:14:09.000Z</published>
    <updated>2019-01-24T09:47:39.916Z</updated>
    
    <content type="html"><![CDATA[<div class="note info">            <h2 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h2><p>Define a one-to-many dependency between objects where a state change in one object results in all its dependents being notified and updated automatically.</p><p>ç›´è¯‘è¿‡æ¥å°±æ˜¯ï¼Œå®šä¹‰å¯¹è±¡é—´çš„ä¸€å¯¹å¤šä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å˜æ›´ä¼šè‡ªåŠ¨é€šçŸ¥å’Œæ›´æ–°æ‰€æœ‰ä¾èµ–é¡¹ã€‚åƒå‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼Œäº‹ä»¶é€šçŸ¥æ¨¡å¼ï¼Œæ•°æ®æº/ç›‘å¬æ¨¡å¼ç­‰éƒ½æ˜¯æ€§è´¨ä¸€æ ·ã€‚</p>          </div><a id="more"></a><h2 id="è§‚å¯Ÿè€…æ¨¡å¼UML"><a href="#è§‚å¯Ÿè€…æ¨¡å¼UML" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼UML"></a>è§‚å¯Ÿè€…æ¨¡å¼UML</h2><h3 id="UMLç±»å’Œæ—¶åºå›¾"><a href="#UMLç±»å’Œæ—¶åºå›¾" class="headerlink" title="UMLç±»å’Œæ—¶åºå›¾"></a>UMLç±»å’Œæ—¶åºå›¾</h3><p>ç±»å›¾ï¼šSubjectç±»ä¸ä¼šç›´æ¥æ›´æ–°ä»å±å¯¹è±¡çš„çŠ¶æ€ã€‚ç›¸åï¼ŒSubjectå¼•ç”¨äº†ç”¨äºæ›´æ–°çŠ¶æ€çš„è§‚å¯Ÿè€…æ¥å£ï¼ˆupdate()ï¼‰ï¼Œè¿™ä½¿å¾—Subjectç‹¬ç«‹äºä¾èµ–å¯¹è±¡çš„çŠ¶æ€æ›´æ–°æ–¹å¼ã€‚Observer1å’ŒObserver2ç±»é€šè¿‡å°†çŠ¶æ€ä¸Subjectçš„çŠ¶æ€åŒæ­¥æ¥å®ç°Observeræ¥å£ã€‚</p><p>æ—¶åºå›¾ï¼šObserver1å’ŒObserver2å¯¹è±¡è°ƒç”¨Subject1ä¸Šçš„attach(this)æ¥æ³¨å†Œè‡ªå·±ã€‚å‡å¦‚Subject1çš„çŠ¶æ€å‘ç”Ÿå˜æ›´ï¼ŒSubject1æœ¬èº«è°ƒç”¨notify()ã€‚notify()å¯¹å·²æ³¨å†Œçš„Observer1å’ŒObserver2å¯¹è±¡è°ƒç”¨update()ï¼Œåè€…ä»Subject1è¯·æ±‚å·²æ›´æ”¹çš„æ•°æ®ï¼ˆgetState()ï¼‰ä»¥æ›´æ–°ï¼ˆåŒæ­¥ï¼‰å…¶çŠ¶æ€ã€‚</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fzhh1ma2gjj30go06o0tv.jpg" alt="img"></p><h3 id="UMLç±»å›¾"><a href="#UMLç±»å›¾" class="headerlink" title="UMLç±»å›¾"></a>UMLç±»å›¾</h3><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fzhh2k6pqzj320m0u0766.jpg" alt="img"></p><h2 id="è§‚å¯Ÿè€…æ¨¡å¼è§’è‰²"><a href="#è§‚å¯Ÿè€…æ¨¡å¼è§’è‰²" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼è§’è‰²"></a>è§‚å¯Ÿè€…æ¨¡å¼è§’è‰²</h2><p> Subjectï¼ˆç›®æ ‡ï¼‰ï¼šç›®æ ‡åˆç§°ä¸ºä¸»é¢˜ï¼Œå®ƒæ˜¯æŒ‡è¢«è§‚å¯Ÿçš„å¯¹è±¡ã€‚åœ¨ç›®æ ‡ä¸­å®šä¹‰äº†ä¸€ä¸ªè§‚å¯Ÿè€…é›†åˆï¼Œä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„è§‚å¯Ÿè€…æ¥è§‚å¯Ÿï¼Œå®ƒæä¾›ä¸€ç³»åˆ—æ–¹æ³•æ¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡ï¼ŒåŒæ—¶å®ƒå®šä¹‰äº†é€šçŸ¥æ–¹æ³•notify()ã€‚ç›®æ ‡ç±»å¯ä»¥æ˜¯æ¥å£ï¼Œä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–å…·ä½“ç±»ã€‚ </p><p> ConcreteSubjectï¼ˆå…·ä½“ç›®æ ‡ï¼‰ï¼šå…·ä½“ç›®æ ‡æ˜¯ç›®æ ‡ç±»çš„å­ç±»ï¼Œé€šå¸¸å®ƒåŒ…å«æœ‰ç»å¸¸å‘ç”Ÿæ”¹å˜çš„æ•°æ®ï¼Œå½“å®ƒçš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå‘å®ƒçš„å„ä¸ªè§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ï¼›åŒæ—¶å®ƒè¿˜å®ç°äº†åœ¨ç›®æ ‡ç±»ä¸­å®šä¹‰çš„æŠ½è±¡ä¸šåŠ¡é€»è¾‘æ–¹æ³•ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚å¦‚æœæ— é¡»æ‰©å±•ç›®æ ‡ç±»ï¼Œåˆ™å…·ä½“ç›®æ ‡ç±»å¯ä»¥çœç•¥ã€‚ </p><p> Observerï¼ˆè§‚å¯Ÿè€…ï¼‰ï¼šè§‚å¯Ÿè€…å°†å¯¹è§‚å¯Ÿç›®æ ‡çš„æ”¹å˜åšå‡ºååº”ï¼Œè§‚å¯Ÿè€…ä¸€èˆ¬å®šä¹‰ä¸ºæ¥å£ï¼Œè¯¥æ¥å£å£°æ˜äº†æ›´æ–°æ•°æ®çš„æ–¹æ³•update()ï¼Œå› æ­¤åˆç§°ä¸ºæŠ½è±¡è§‚å¯Ÿè€…ã€‚ </p><p> ConcreteObserverï¼ˆå…·ä½“è§‚å¯Ÿè€…ï¼‰ï¼šåœ¨å…·ä½“è§‚å¯Ÿè€…ä¸­ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘å…·ä½“ç›®æ ‡å¯¹è±¡çš„å¼•ç”¨ï¼Œå®ƒå­˜å‚¨å…·ä½“è§‚å¯Ÿè€…çš„æœ‰å…³çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€éœ€è¦å’Œå…·ä½“ç›®æ ‡çš„çŠ¶æ€ä¿æŒä¸€è‡´ï¼›å®ƒå®ç°äº†åœ¨æŠ½è±¡è§‚å¯Ÿè€…Observerä¸­å®šä¹‰çš„update()æ–¹æ³•ã€‚</p><p>è§‚å¯Ÿè€…æ¨¡å¼æè¿°äº†å¦‚ä½•å»ºç«‹å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠå¦‚ä½•æ„é€ æ»¡è¶³è¿™ç§éœ€æ±‚çš„ç³»ç»Ÿã€‚è§‚å¯Ÿè€…æ¨¡å¼åŒ…å«è§‚å¯Ÿç›®æ ‡å’Œè§‚å¯Ÿè€…ä¸¤ç±»å¯¹è±¡ï¼Œä¸€ä¸ªç›®æ ‡å¯ä»¥æœ‰ä»»æ„æ•°ç›®çš„ä¸ä¹‹ç›¸ä¾èµ–çš„è§‚å¯Ÿè€…ï¼Œä¸€æ—¦è§‚å¯Ÿç›®æ ‡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œæ‰€æœ‰çš„è§‚å¯Ÿè€…éƒ½å°†å¾—åˆ°é€šçŸ¥ã€‚ä½œä¸ºå¯¹è¿™ä¸ªé€šçŸ¥çš„å“åº”ï¼Œæ¯ä¸ªè§‚å¯Ÿè€…éƒ½å°†ç›‘è§†è§‚å¯Ÿç›®æ ‡çš„çŠ¶æ€ä»¥ä½¿å…¶çŠ¶æ€ä¸ç›®æ ‡çŠ¶æ€åŒæ­¥ï¼Œè¿™ç§äº¤äº’ä¹Ÿç§°ä¸ºå‘å¸ƒ-è®¢é˜…(Publish-Subscribe)ã€‚è§‚å¯Ÿç›®æ ‡æ˜¯é€šçŸ¥çš„å‘å¸ƒè€…ï¼Œå®ƒå‘å‡ºé€šçŸ¥æ—¶å¹¶ä¸éœ€è¦çŸ¥é“è°æ˜¯å®ƒçš„è§‚å¯Ÿè€…ï¼Œå¯ä»¥æœ‰ä»»æ„æ•°ç›®çš„è§‚å¯Ÿè€…è®¢é˜…å®ƒå¹¶æ¥æ”¶é€šçŸ¥ã€‚</p><h2 id="å¹²è´§æºç è§£æ"><a href="#å¹²è´§æºç è§£æ" class="headerlink" title="å¹²è´§æºç è§£æ"></a>å¹²è´§æºç è§£æ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci9vYnNlcnZlcg==" title="https://github.com/DamonChow/design_pattern/tree/master/observer">æºç åœ°å€<i class="fa fa-external-link"></i></span></p><p>åšå®¢è®¢é˜…çš„åŠŸèƒ½ï¼ŒæŠ½è±¡ä¸»é¢˜ä¸­ç»´æŠ¤è®¢é˜…å…³ç³»ï¼ŒåŒæ—¶å¼•å…¥æ™®é€šå’Œvipè§‚å¯Ÿè€…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡ä¸»é¢˜</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸»é¢˜è®¢é˜…è€…ä»¬</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Observer&gt; observerList = Lists.newArrayList();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¢é˜…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        observerList.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å–æ¶ˆè®¢é˜…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        observerList.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‘å¸ƒä¸œè¥¿</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">publish</span><span class="params">(String msg)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠ½è±¡è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è§‚å¯Ÿè€…åç§°</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ›´æ–°çŠ¶æ€ï¼Œç”±ä¸»é¢˜è°ƒåº¦</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Object subject, Object args)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"&#123;&#125;è·å–åˆ°å˜æ›´é€šçŸ¥ï¼š&#123;&#125;"</span>, name, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åšå®¢ä¸»é¢˜</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Blog</span> <span class="keyword">extends</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">publish</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"å‘å¸ƒmsg:&#123;&#125;"</span>, msg);</span><br><span class="line">        <span class="comment">//é€šçŸ¥è®¢é˜…è€…</span></span><br><span class="line">        getObserverList().forEach(observer -&gt; observer.update(<span class="keyword">this</span>, msg));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ™®é€šç”¨æˆ·è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NormalObserver</span> <span class="keyword">extends</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NormalObserver</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Object subject, Object args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.update(subject, args);</span><br><span class="line">        log.info(<span class="string">"&#123;&#125;è·å–åˆ°å˜æ›´é€šçŸ¥ï¼šæ™®é€šç”¨æˆ·å¯ä»¥ä¸ç¼“å­˜"</span>, getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//vipç”¨æˆ·è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VipObserver</span> <span class="keyword">extends</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VipObserver</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Object subject, Object args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.update(subject, args);</span><br><span class="line">        log.info(<span class="string">"&#123;&#125;è·å–åˆ°å˜æ›´é€šçŸ¥ï¼švipå¯ä»¥ç¼“å­˜"</span>, getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Blog blog = <span class="keyword">new</span> Blog();</span><br><span class="line">        VipObserver wang = <span class="keyword">new</span> VipObserver(<span class="string">"è€ç‹99"</span>);</span><br><span class="line">        VipObserver lee = <span class="keyword">new</span> VipObserver(<span class="string">"è€æ"</span>);</span><br><span class="line">        NormalObserver four = <span class="keyword">new</span> NormalObserver(<span class="string">"å°å››"</span>);</span><br><span class="line">        NormalObserver twoEgg = <span class="keyword">new</span> NormalObserver(<span class="string">"äºŒè›‹"</span>);</span><br><span class="line">        log.info(<span class="string">"---------------------begin--------------------"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”¨æˆ·è®¢é˜…åšå®¢ï¼Œæ™®é€šå’Œvipç”¨æˆ·</span></span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            blog.register(wang);</span><br><span class="line">            sleep(<span class="number">2</span>);</span><br><span class="line">            blog.register(lee);</span><br><span class="line">            sleep(<span class="number">2</span>);</span><br><span class="line">            blog.register(four);</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åšå®¢çº¿ç¨‹æ¯éš”2ç§’å‘å¸ƒä¸€æ¬¡æ–‡ç« ,  æ€»å…±å‘å¸ƒ4æ¬¡</span></span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            IntStream.rangeClosed(<span class="number">1</span>, <span class="number">4</span>).forEach(i -&gt; &#123;</span><br><span class="line">                blog.publish(String.format(<span class="string">"æ–°æŠŠæˆç¬¬%sæ¬¡"</span>, i));</span><br><span class="line">                sleep(<span class="number">2</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æœ‰ç”¨æˆ·é€€å‡ºè®¢é˜…åšå®¢ï¼Œä¹Ÿæœ‰äºŒè›‹åŠ å…¥è®¢é˜…</span></span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            sleep(<span class="number">3</span>);</span><br><span class="line">            blog.remove(lee);</span><br><span class="line">            sleep(<span class="number">2</span>);</span><br><span class="line">            blog.register(twoEgg);</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">(<span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(seconds);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            log.error(<span class="string">"error : "</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fzhs6tl0jxj31s80qegxs.jpg" alt="image-20190124170206758"></p><p>jdkå†…ç½®çš„Obverserå’ŒObservable</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObserverApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Enter Text: "</span>);</span><br><span class="line">        EventSource eventSource = <span class="keyword">new</span> EventSource();</span><br><span class="line"></span><br><span class="line">        eventSource.addObserver((obj, arg) -&gt; &#123;</span><br><span class="line">            log.info(<span class="string">"Received response: &#123;&#125;"</span>, arg);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        eventSource.addObserver((obj, arg) -&gt; &#123;</span><br><span class="line">            log.info(<span class="string">"Received response2: &#123;&#125;,,&#123;&#125;"</span>, arg, obj</span><br><span class="line">            );</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread(eventSource).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventSource</span> <span class="keyword">extends</span> <span class="title">Observable</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            String response = <span class="keyword">new</span> Scanner(System.in).next();</span><br><span class="line">            setChanged();</span><br><span class="line">            notifyObservers(response);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Javaä¸­çš„ä½¿ç”¨"><a href="#Javaä¸­çš„ä½¿ç”¨" class="headerlink" title="Javaä¸­çš„ä½¿ç”¨"></a>Javaä¸­çš„ä½¿ç”¨</h2><p>å®ƒä½¿å¾—ä¸€ä¸ªå¯¹è±¡å¯ä»¥çµæ´»çš„å°†æ¶ˆæ¯å‘é€ç»™æ„Ÿå…´è¶£çš„å¯¹è±¡</p><blockquote><p>java.util.EventListener</p><p>javax.servlet.http.HttpSessionBindingListener</p><p>javax.servlet.http.HttpSessionAttributeListener</p><p>javax.faces.event.PhaseListener</p></blockquote><p>Listenerä»åå­—ä¸Šçœ‹å°±æ˜ç™½æ˜¯ç›‘å¬çš„æ„æ€äº†ã€‚</p><h3 id="JDKä¸­å†…ç½®çš„Obverserå’ŒObservable"><a href="#JDKä¸­å†…ç½®çš„Obverserå’ŒObservable" class="headerlink" title="JDKä¸­å†…ç½®çš„Obverserå’ŒObservable"></a>JDKä¸­å†…ç½®çš„Obverserå’ŒObservable</h3><p>jdkä¸­å†…ç½®çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚å³æ˜¯java.util.Observer(æ¥å£)å’Œjava.util.Observable(ç±»)ã€‚</p><p>ç®€å•çš„è¯´è¯´è¿™ä¸ªã€‚è§‚å¯Ÿè€…æ¥å£(java.util.Observer)ï¼Œä¸»é¢˜(java.util.Observable)ã€‚å®ç°è§‚å¯Ÿè€…æ¥å£å’Œç»§æ‰¿ä¸»é¢˜ã€‚é€šè¿‡æŠ½è±¡ä¸»é¢˜çš„addObserver()æ³¨å†Œè§‚å¯Ÿè€…ï¼ŒdeleteObserver()ç§»é™¤è§‚å¯Ÿè€…ã€‚</p><p>é¦–å…ˆé€šè¿‡è°ƒç”¨ä¸»é¢˜ç±»çš„setChange()å‘ŠçŸ¥çŠ¶æ€å˜æ›´ï¼Œéšåè°ƒç”¨notifyObserversæ–¹æ³•ï¼ˆå¯ä¼ å¯ä¸ä¼ å‚æ•°ï¼‰å»é€šçŸ¥è§‚å¯Ÿè€…ï¼Œæœ€åå› ä¸ºä¸»é¢˜åœ¨notifyObserversæ—¶ä¼šä¸»åŠ¨è°ƒç”¨è§‚å¯Ÿè€…çš„update()æ–¹æ³•ï¼Œæ”¹æ–¹æ³•æœ‰2ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºä¸»é¢˜å¯¹è±¡ï¼Œç¬¬äºŒä¸ªä¸ºå¯å˜å‚æ•°ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§ä½¿ç”¨é¢‘ç‡éå¸¸é«˜çš„è®¾è®¡æ¨¡å¼ï¼ŒJDKä¸­å°±å¸¦æœ‰å®ç°ã€‚æ— è®ºæ˜¯ç§»åŠ¨åº”ç”¨ã€Webåº”ç”¨æˆ–è€…æ¡Œé¢åº”ç”¨ï¼Œè§‚å¯Ÿè€…æ¨¡å¼å‡ ä¹æ— å¤„ä¸åœ¨ï¼Œå®ƒä¸ºå®ç°å¯¹è±¡ä¹‹é—´çš„è”åŠ¨æä¾›äº†ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼Œå‡¡æ˜¯æ¶‰åŠåˆ°ä¸€å¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤šçš„å¯¹è±¡äº¤äº’åœºæ™¯éƒ½å¯ä»¥ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚è§‚å¯Ÿè€…æ¨¡å¼å¹¿æ³›åº”ç”¨äºå„ç§ç¼–ç¨‹è¯­è¨€çš„GUIäº‹ä»¶å¤„ç†çš„å®ç°ï¼Œåœ¨åŸºäºäº‹ä»¶çš„XMLè§£ææŠ€æœ¯ï¼ˆå¦‚SAX2ï¼‰ä»¥åŠWebäº‹ä»¶å¤„ç†ä¸­ä¹Ÿéƒ½ä½¿ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p><h3 id="è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç‚¹"><a href="#è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç‚¹" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç‚¹"></a>è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç‚¹</h3><p>(1) è§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥å®ç°è¡¨ç¤ºå±‚å’Œæ•°æ®é€»è¾‘å±‚çš„åˆ†ç¦»ï¼Œå®šä¹‰äº†ç¨³å®šçš„æ¶ˆæ¯æ›´æ–°ä¼ é€’æœºåˆ¶ï¼Œå¹¶æŠ½è±¡äº†æ›´æ–°æ¥å£ï¼Œä½¿å¾—å¯ä»¥æœ‰å„ç§å„æ ·ä¸åŒçš„è¡¨ç¤ºå±‚å……å½“å…·ä½“è§‚å¯Ÿè€…è§’è‰²ã€‚<br>(2) è§‚å¯Ÿè€…æ¨¡å¼åœ¨è§‚å¯Ÿç›®æ ‡å’Œè§‚å¯Ÿè€…ä¹‹é—´å»ºç«‹ä¸€ä¸ªæŠ½è±¡çš„è€¦åˆã€‚è§‚å¯Ÿç›®æ ‡åªéœ€è¦ç»´æŒä¸€ä¸ªæŠ½è±¡è§‚å¯Ÿè€…çš„é›†åˆï¼Œæ— é¡»äº†è§£å…¶å…·ä½“è§‚å¯Ÿè€…ã€‚ç”±äºè§‚å¯Ÿç›®æ ‡å’Œè§‚å¯Ÿè€…æ²¡æœ‰ç´§å¯†åœ°è€¦åˆåœ¨ä¸€èµ·ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥å±äºä¸åŒçš„æŠ½è±¡åŒ–å±‚æ¬¡ã€‚<br>(3) è§‚å¯Ÿè€…æ¨¡å¼æ”¯æŒå¹¿æ’­é€šä¿¡ï¼Œè§‚å¯Ÿç›®æ ‡ä¼šå‘æ‰€æœ‰å·²æ³¨å†Œçš„è§‚å¯Ÿè€…å¯¹è±¡å‘é€é€šçŸ¥ï¼Œç®€åŒ–äº†ä¸€å¯¹å¤šç³»ç»Ÿè®¾è®¡çš„éš¾åº¦ã€‚<br>(4) è§‚å¯Ÿè€…æ¨¡å¼æ»¡è¶³â€œå¼€é—­åŸåˆ™â€çš„è¦æ±‚ï¼Œå¢åŠ æ–°çš„å…·ä½“è§‚å¯Ÿè€…æ— é¡»ä¿®æ”¹åŸæœ‰ç³»ç»Ÿä»£ç ï¼Œåœ¨å…·ä½“è§‚å¯Ÿè€…ä¸è§‚å¯Ÿç›®æ ‡ä¹‹é—´ä¸å­˜åœ¨å…³è”å…³ç³»çš„æƒ…å†µä¸‹ï¼Œå¢åŠ æ–°çš„è§‚å¯Ÿç›®æ ‡ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚</p><h3 id="è§‚å¯Ÿè€…æ¨¡å¼çš„ç¼ºç‚¹"><a href="#è§‚å¯Ÿè€…æ¨¡å¼çš„ç¼ºç‚¹" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼çš„ç¼ºç‚¹"></a>è§‚å¯Ÿè€…æ¨¡å¼çš„ç¼ºç‚¹</h3><p>(1) å¦‚æœä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å¯¹è±¡æœ‰å¾ˆå¤šç›´æ¥å’Œé—´æ¥è§‚å¯Ÿè€…ï¼Œå°†æ‰€æœ‰çš„è§‚å¯Ÿè€…éƒ½é€šçŸ¥åˆ°ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ã€‚<br>(2) å¦‚æœåœ¨è§‚å¯Ÿè€…å’Œè§‚å¯Ÿç›®æ ‡ä¹‹é—´å­˜åœ¨å¾ªç¯ä¾èµ–ï¼Œè§‚å¯Ÿç›®æ ‡ä¼šè§¦å‘å®ƒä»¬ä¹‹é—´è¿›è¡Œå¾ªç¯è°ƒç”¨ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚<br>(3) è§‚å¯Ÿè€…æ¨¡å¼æ²¡æœ‰ç›¸åº”çš„æœºåˆ¶è®©è§‚å¯Ÿè€…çŸ¥é“æ‰€è§‚å¯Ÿçš„ç›®æ ‡å¯¹è±¡æ˜¯æ€ä¹ˆå‘ç”Ÿå˜åŒ–çš„ï¼Œè€Œä»…ä»…åªæ˜¯çŸ¥é“è§‚å¯Ÿç›®æ ‡å‘ç”Ÿäº†å˜åŒ–ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>1ã€JAVA ä¸­å·²ç»æœ‰äº†å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒç±»ã€‚ 2ã€é¿å…å¾ªç¯å¼•ç”¨ã€‚ 3ã€å¦‚æœé¡ºåºæ‰§è¡Œï¼ŒæŸä¸€è§‚å¯Ÿè€…é”™è¯¯ä¼šå¯¼è‡´ç³»ç»Ÿå¡å£³ï¼Œä¸€èˆ¬é‡‡ç”¨å¼‚æ­¥æ–¹å¼ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvT2JzZXJ2ZXJfcGF0dGVybg==" title="https://en.wikipedia.org/wiki/Observer_pattern">Observer pattern<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2Rlc2lnbi1wYXR0ZXJuL29ic2VydmVyLXBhdHRlcm4uaHRtbA==" title="http://www.runoob.com/design-pattern/observer-pattern.html">è§‚å¯Ÿè€…æ¨¡å¼|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdGlueWtpbmcvcC81OTM4NTQ3Lmh0bWw=" title="https://www.cnblogs.com/tinyking/p/5938547.html">ç»†æ•°JDKé‡Œçš„è®¾è®¡æ¨¡å¼<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcmVuaHVpL3AvNjQ3OTc0OC5odG1s" title="https://www.cnblogs.com/renhui/p/6479748.html">è®¾è®¡æ¨¡å¼æ€»ç»“ï¼ˆJavaï¼‰â€”â€” è§‚å¯Ÿè€…æ¨¡å¼<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;
            &lt;h2 id=&quot;è§‚å¯Ÿè€…æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è§‚å¯Ÿè€…æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è§‚å¯Ÿè€…æ¨¡å¼&quot;&gt;&lt;/a&gt;è§‚å¯Ÿè€…æ¨¡å¼&lt;/h2&gt;&lt;p&gt;Define a one-to-many dependency between objects where a state change in one object results in all its dependents being notified and updated automatically.&lt;/p&gt;&lt;p&gt;ç›´è¯‘è¿‡æ¥å°±æ˜¯ï¼Œå®šä¹‰å¯¹è±¡é—´çš„ä¸€å¯¹å¤šä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å˜æ›´ä¼šè‡ªåŠ¨é€šçŸ¥å’Œæ›´æ–°æ‰€æœ‰ä¾èµ–é¡¹ã€‚åƒå‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼Œäº‹ä»¶é€šçŸ¥æ¨¡å¼ï¼Œæ•°æ®æº/ç›‘å¬æ¨¡å¼ç­‰éƒ½æ˜¯æ€§è´¨ä¸€æ ·ã€‚&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="è§‚å¯Ÿè€…" scheme="http://damonchow.github.io/tags/%E8%A7%82%E5%AF%9F%E8%80%85/"/>
    
  </entry>
  
  <entry>
    <title>Mysqlæˆ‘æ˜¯æ€ä¹ˆéšæœºæˆªå–å­—ç¬¦æ•°ç»„é‡Œçš„å­—ç¬¦ä¸²å¹¶ä¸”ä¸€ä¸€å¯¹åº”</title>
    <link href="http://damonchow.github.io/2019/01/17/annual-personal-report/"/>
    <id>http://damonchow.github.io/2019/01/17/annual-personal-report/</id>
    <published>2019-01-17T06:16:30.000Z</published>
    <updated>2019-01-17T07:17:04.079Z</updated>
    
    <content type="html"><![CDATA[<div class="note info">            <p>åœºæ™¯ï¼šä¸´è¿‘å¹´åº•ï¼Œå„ä¸ªAppéƒ½ä¼šæœ‰ä¸ªäººå¹´åº¦è´¦å•ï¼Œé¡¹ç›®é‡Œä¸ºäº†å›¾å¿«ï¼Œä»¥åŠèŠ‚çœå„ä¸ªç³»ç»Ÿæ¨¡å—ä¹‹é—´çš„æ¥å£è”è°ƒã€‚ç›´æ¥äººå·¥ç»Ÿè®¡æ•°æ®ï¼ˆğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ï¼‰ï¼Œæ„é€ è´¦å•æ•°æ®JSONã€‚</p>          </div><a id="more"></a><p>è¯ä¸å¤šè¯´ï¼Œè€å¤«æ‹¿èµ·é”®ç›˜å°±æ˜¯å¹²ã€‚</p><p>äº”æ¯’æœ‰æ¬§ï¼Œæ•°æ®ä¿ºä¸ä¹ç­çš„ç”±å…¶ä»–å„ä¸ªç³»ç»Ÿå°ç»„æä¾›ï¼Œä½†æ˜¯æœ‰äº›æ•°æ®æ˜¯éšæœºç”Ÿæˆçš„ä¸€äº›æè¿°æ€§çš„æ–‡æœ¬ï¼Œè€Œè¯¥æ–‡æœ¬ä»å›ºå®šçš„æ–‡æœ¬æ•°ç»„è€Œæ¥ã€‚å‰ç«¯å±•ç¤ºæ•ˆæœåˆè¦å°†éšæœºæ–‡æœ¬æ‹†æˆå‡ ä¸ªéƒ¨åˆ†æ¥ã€‚</p><p>æ­£å¸¸çš„sqlæ‹¼æ¥æˆjsonè¿˜æ–¹ä¾¿ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CONCAT('\"app\":&#123;\"time\":\"', DATE_FORMAT(time, "%Y-%m-%d %T"), '\",\"days\":', days, </span><br><span class="line">case when typeTime is null then '' else CONCAT(',\"typeTime\":\"', DATE_FORMAT(typeTime, "%Y-%m-%d %T"), '\"') <span class="keyword">end</span>,<span class="string">'&#125;'</span>)</span><br></pre></td></tr></table></figure><p>éšæœºæ–‡æœ¬æ¥äº†</p><blockquote><p>å­¦å¯Œäº”è½¦ï¼šå†ç¾çš„æ°”è´¨ï¼Œä¹Ÿæ©ç›–ä¸äº†ä½ æ‰åæœ¬è´¨<br>è¶³æ™ºå¤šè°‹ï¼šè„‘åŠ›ä½¿ç”¨ç§¯æåˆ†å­ï¼Œéä½ è«å±<br>ä»—ä¹‰æ‰§è¨€ï¼šä½ çš„è§è§£ï¼Œé¢é¢ä¿±åˆ°ï¼Œæ·±å…¥äººå¿ƒ<br>ç«çœ¼é‡‘ç›ï¼šç‹¬ç‰¹çš„æ´å¯ŸåŠ›ï¼Œæ€»èƒ½è·æ‚‰ä¸€åˆ‡<br>è§å¤šè¯†å¹¿ï¼šæœ€ç¾çš„é˜…å†ï¼Œå°±æ˜¯æ²¿è·¯çš„é£æ™¯<br>è´£ä»»æ‹…å½“ï¼šå…ˆå¤©ä¸‹ä¹‹å¿§è€Œå¿§,åå¤©ä¸‹ä¹‹ä¹è€Œä¹</p></blockquote><p>ä»ä¸Šé¢å¯ä»¥çœ‹çš„å‡ºï¼Œå®ƒä»¬ä¹‹é—´ä¸€ä¸€å¯¹åº”çš„ã€‚</p><p>å”¯ç‹¬é‚£äº›éšæœºæ–‡æœ¬ç€å®æ€è€ƒç‰‡åˆ»ã€‚æ¥ï¼Œæˆ‘ä»¬å±‚å±‚å‰–æå®ƒã€‚</p><h2 id="æˆªå–æ–‡æœ¬"><a href="#æˆªå–æ–‡æœ¬" class="headerlink" title="æˆªå–æ–‡æœ¬"></a>æˆªå–æ–‡æœ¬</h2><p>mysqlä¸­æ€ä¹ˆä»æ•°ç»„ä¸­å–éšæœºçš„æ–‡æœ¬ï¼Œå‚è€ƒsubstring_indexå‡½æ•°ã€‚åˆ†ä¸ºä¸¤æ­¥èµ°ï¼Œç¬¬ä¸€æ­¥å…ˆå»å€’æ•°å¼€å§‹å¾€å‰æ•°å€’æ•°å‡ ä½ï¼Œç¬¬äºŒæ­¥å†ä»æ–°çš„æ•°ç»„ä¸­å–ç¬¬ä¸€ä½ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">substring_index(substring_index(array, 'ç¬¦åˆé—´éš”', -n), 'ç¬¦åˆé—´éš”', 1)</span><br></pre></td></tr></table></figure><h2 id="æ„é€ éšæœºå› å­"><a href="#æ„é€ éšæœºå› å­" class="headerlink" title="æ„é€ éšæœºå› å­"></a>æ„é€ éšæœºå› å­</h2><p>ç°åœ¨å†çœ‹çœ‹è¿™ä¸ªéšæœºå› å­æ€ä¹ˆå–ï¼Œå‚è€ƒrand()å‡½æ•°ã€‚</p><p>å› ä¸ºå–çš„æ˜¯-1åˆ°-7ä¹‹é—´çš„éšæœºæ•°ã€‚æ‰€ä»¥æœ€ç»ˆçš„æ•ˆæœå°±æ˜¯å¦‚ä¸‹ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-floor(rand()*7+1)</span><br></pre></td></tr></table></figure><p>å–éšæœºèŒƒå›´å†…çš„å€¼å¯ä»¥å‚è€ƒè¿™ä¸ªå…¬å¼</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLOOR(start_num + RAND() * (end_num - start_num + 1))</span><br></pre></td></tr></table></figure><h2 id="å¼€å§‹ç¬¬ä¸€æ¬¡æˆªå–"><a href="#å¼€å§‹ç¬¬ä¸€æ¬¡æˆªå–" class="headerlink" title="å¼€å§‹ç¬¬ä¸€æ¬¡æˆªå–"></a>å¼€å§‹ç¬¬ä¸€æ¬¡æˆªå–</h2><p>éšæœºä¸²æˆªå–æ–¹æ³•æœ‰äº†ï¼Œéšæœºæ•°ä¹Ÿæœ‰äº†ï¼Œå¼€å¹²ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> user_id, <span class="keyword">CONCAT</span>(<span class="string">'\"desc\": &#123;\"label\":\"'</span>, </span><br><span class="line">substring_index(substring_index(<span class="string">'å­¦å¯Œäº”è½¦;è¶³æ™ºå¤šè°‹;ä»—ä¹‰æ‰§è¨€;ç«çœ¼é‡‘ç›;è§å¤šè¯†å¹¿;è´£ä»»æ‹…å½“;ä¹è§‚ç§¯æ'</span>,<span class="string">';'</span>,-<span class="keyword">FLOOR</span>(<span class="keyword">rand</span>()*<span class="number">7</span>+<span class="number">1</span>)),<span class="string">';'</span>,<span class="number">1</span>),<span class="string">'\"'</span>,</span><br><span class="line"><span class="string">',\"description\": \"'</span>, substring_index(substring_index(<span class="string">'å†ç¾çš„æ°”è´¨ï¼Œä¹Ÿæ©ç›–ä¸äº†ä½ æ‰åæœ¬è´¨;è„‘åŠ›ä½¿ç”¨ç§¯æåˆ†å­ï¼Œéä½ è«å±;ä½ çš„è§è§£ï¼Œé¢é¢ä¿±åˆ°ï¼Œæ·±å…¥äººå¿ƒ;ç‹¬ç‰¹çš„æ´å¯ŸåŠ›ï¼Œæ€»èƒ½è·æ‚‰ä¸€åˆ‡;æœ€ç¾çš„é˜…å†ï¼Œå°±æ˜¯æ²¿è·¯çš„é£æ™¯;å…ˆå¤©ä¸‹ä¹‹å¿§è€Œå¿§,åå¤©ä¸‹ä¹‹ä¹è€Œä¹;çˆ±ç¬‘çš„ä½ è¿æ°”ä¸€å®šä¸ä¼šå·®'</span>,<span class="string">';'</span>,-<span class="keyword">FLOOR</span>(<span class="keyword">rand</span>()*<span class="number">7</span>+<span class="number">1</span>)),<span class="string">';'</span>,<span class="number">1</span>),</span><br><span class="line"><span class="string">'\"&#125;'</span></span><br><span class="line">) <span class="keyword">as</span> report_content <span class="keyword">from</span> <span class="keyword">data</span>;</span><br></pre></td></tr></table></figure><p>ç»“æœå‘ç°å¯¹ä¸ä¸Šå•Šï¼Œã€è´£ä»»æ‹…å½“ã€‘åº”è¯¥å¯¹åº”ã€å…ˆå¤©ä¸‹ä¹‹å¿§è€Œå¿§,åå¤©ä¸‹ä¹‹ä¹è€Œä¹ã€‘ï¼Œè€Œç»“æœå‡ºç°éƒ¨åˆ†å¯¹åº”åˆ°ã€å†ç¾çš„æ°”è´¨ï¼Œä¹Ÿæ©ç›–ä¸äº†ä½ æ‰åæœ¬è´¨ã€‘<img src="https://ws3.sinaimg.cn/large/006tNc79gy1fz9ku49r3tj30uu0gi7gf.jpg" alt="img"></p><h2 id="åŠªåŠ›ç¬¬äºŒæ¬¡æˆªå–"><a href="#åŠªåŠ›ç¬¬äºŒæ¬¡æˆªå–" class="headerlink" title="åŠªåŠ›ç¬¬äºŒæ¬¡æˆªå–"></a>åŠªåŠ›ç¬¬äºŒæ¬¡æˆªå–</h2><p>è¿™æ¬¡è€ƒè™‘åˆ°ä¸Šå›æˆ‘ä»¬æ˜¯æŠŠéšæœºå› å­æ”¾åœ¨sqlé‡Œæ²¡å¥è¯é‡Œï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½æ‰§è¡Œäº†2æ¬¡ï¼Œç”Ÿæˆæ˜¯éšæœºå› å­å°±ä¸ä¸€æ ·äº†ï¼Œæˆªå–çš„ç»“æœå°±å¯¹åº”ä¸ä¸Šï¼Œé‚£ï¼Œæˆ‘ä»¬å…ˆåœ¨å­æŸ¥è¯¢é‡Œå…ˆæŠŠéšæœºå› å­ç”Ÿæˆåï¼Œå†åœ¨å¤–å±‚ç”¨è¿™ä¸ªéšæœºå› å­è¿™ä¸‹åº”è¯¥ä¸ä¸€æ ·äº†æŠŠã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> temp.user_id, <span class="keyword">CONCAT</span>(<span class="string">'\"desc\": &#123;\"label\":\"'</span>, </span><br><span class="line">substring_index(substring_index(<span class="string">'å­¦å¯Œäº”è½¦;è¶³æ™ºå¤šè°‹;ä»—ä¹‰æ‰§è¨€;ç«çœ¼é‡‘ç›;è§å¤šè¯†å¹¿;è´£ä»»æ‹…å½“;ä¹è§‚ç§¯æ'</span>,<span class="string">';'</span>,temp.desc_index),<span class="string">';'</span>,<span class="number">1</span>),<span class="string">'\"'</span>,</span><br><span class="line"><span class="string">',\"description\": \"'</span>, substring_index(substring_index(<span class="string">'å†ç¾çš„æ°”è´¨ï¼Œä¹Ÿæ©ç›–ä¸äº†ä½ æ‰åæœ¬è´¨;è„‘åŠ›ä½¿ç”¨ç§¯æåˆ†å­ï¼Œéä½ è«å±;ä½ çš„è§è§£ï¼Œé¢é¢ä¿±åˆ°ï¼Œæ·±å…¥äººå¿ƒ;ç‹¬ç‰¹çš„æ´å¯ŸåŠ›ï¼Œæ€»èƒ½è·æ‚‰ä¸€åˆ‡;æœ€ç¾çš„é˜…å†ï¼Œå°±æ˜¯æ²¿è·¯çš„é£æ™¯;å…ˆå¤©ä¸‹ä¹‹å¿§è€Œå¿§,åå¤©ä¸‹ä¹‹ä¹è€Œä¹;çˆ±ç¬‘çš„ä½ è¿æ°”ä¸€å®šä¸ä¼šå·®'</span>,<span class="string">';'</span>,temp.desc_index),<span class="string">';'</span>,<span class="number">1</span>),</span><br><span class="line"><span class="string">'\"&#125;'</span></span><br><span class="line">) <span class="keyword">as</span> report_content <span class="keyword">from</span> (<span class="keyword">select</span> user_id, -<span class="keyword">FLOOR</span>(<span class="keyword">rand</span>()*<span class="number">7</span>+<span class="number">1</span>) <span class="keyword">as</span> desc_index <span class="keyword">from</span> <span class="keyword">data</span>) temp</span><br></pre></td></tr></table></figure><p>åè¡€çš„å›¾ç‰‡åœ¨æŸ¥æ‰¾ä¸­ï¼Œä»å¼€å¤´çœ‹å°±çœ‹çš„å‡ºæ¥ï¼Œå¯¹åº”ä¸ä¸Šå•¦ï¼Œå‰å‡ ä¸ªå°±å‰éƒ¨å¯¹åº”ã€çˆ±ç¬‘çš„ä½ è¿æ°”ä¸€å®šä¸ä¼šå·®ã€‘ï¼Œçˆ±ç¬‘çš„æˆ‘ï¼Œè¿æ°”å°±æ˜¯è¿™ä¹ˆå·®ã€‚</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fz9l1didszj313g0qedmh.jpg" alt="image-20190117145010072"></p><p>æ”¹å˜ä¸‹è¯­å¥æŠŠéšæœºå› å­æ‰“å°å‡ºæ¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> temp.user_id, desc_index, <span class="keyword">CONCAT</span>(desc_index, <span class="string">'\"desc\": &#123;\"label\":\"'</span>, </span><br><span class="line">substring_index(substring_index(<span class="string">'å­¦å¯Œäº”è½¦;è¶³æ™ºå¤šè°‹;ä»—ä¹‰æ‰§è¨€;ç«çœ¼é‡‘ç›;è§å¤šè¯†å¹¿;è´£ä»»æ‹…å½“;ä¹è§‚ç§¯æ'</span>,<span class="string">';'</span>,temp.desc_index),<span class="string">';'</span>,<span class="number">1</span>),<span class="string">'\"'</span>,</span><br><span class="line"><span class="string">',\"description\": \"'</span>, substring_index(substring_index(<span class="string">'å†ç¾çš„æ°”è´¨ï¼Œä¹Ÿæ©ç›–ä¸äº†ä½ æ‰åæœ¬è´¨;è„‘åŠ›ä½¿ç”¨ç§¯æåˆ†å­ï¼Œéä½ è«å±;ä½ çš„è§è§£ï¼Œé¢é¢ä¿±åˆ°ï¼Œæ·±å…¥äººå¿ƒ;ç‹¬ç‰¹çš„æ´å¯ŸåŠ›ï¼Œæ€»èƒ½è·æ‚‰ä¸€åˆ‡;æœ€ç¾çš„é˜…å†ï¼Œå°±æ˜¯æ²¿è·¯çš„é£æ™¯;å…ˆå¤©ä¸‹ä¹‹å¿§è€Œå¿§,åå¤©ä¸‹ä¹‹ä¹è€Œä¹;çˆ±ç¬‘çš„ä½ è¿æ°”ä¸€å®šä¸ä¼šå·®'</span>,<span class="string">';'</span>,temp.desc_index),<span class="string">';'</span>,<span class="number">1</span>),</span><br><span class="line"><span class="string">'\"&#125;'</span></span><br><span class="line">) <span class="keyword">as</span> report_content <span class="keyword">from</span> (<span class="keyword">select</span> user_id, -<span class="keyword">FLOOR</span>(<span class="keyword">rand</span>()*<span class="number">7</span>+<span class="number">1</span>) <span class="keyword">as</span> desc_index <span class="keyword">from</span> <span class="keyword">data</span>) temp</span><br></pre></td></tr></table></figure><p><strong><em>**</em></strong>ï¼Œå‰é¢è¿™äº›æ‰“æ˜Ÿå·çš„ï¼Œéƒ½æ˜¯è„è¯ï¼Œå¿½ç•¥å®ƒï¼Œéšæœºå› å­ï¼Œæ˜æ˜åœ¨å­æŸ¥è¯¢éƒ½ç”Ÿæˆäº†ï¼Œä¸ºæ¯›è¿˜æ˜¯ä¸ä¸€æ ·ã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fz9l70jwg2j30zy0nydzb.jpg" alt="image-20190117145539095"></p><h2 id="æœ€ç»ˆç»å°½è„‘æ±çš„æˆªå–"><a href="#æœ€ç»ˆç»å°½è„‘æ±çš„æˆªå–" class="headerlink" title="æœ€ç»ˆç»å°½è„‘æ±çš„æˆªå–"></a>æœ€ç»ˆç»å°½è„‘æ±çš„æˆªå–</h2><p>æœ¬æƒ³åœ¨å­æŸ¥è¯¢ä¸­ä½¿ç”¨rand()æŠŠéšæœºå› å­å¯ä»¥æå‡ºæ¥ï¼Œå“ªæˆæƒ³ï¼Œåœ¨å¤–å±‚çš„æŸ¥è¯¢æ—¶rand()åˆTMMçš„é‡ç®—äº†ä¸€éã€‚</p><p>ä¸€é¡¿å‚è€ƒä¸€é¡¿æ‰¾èµ„æ–™ï¼Œå¶ç„¶é—´å‘ç°äº†é—®é¢˜æ‰€åœ¨</p><p><span class="exturl" data-url="aHR0cHM6Ly9idWdzLm15c3FsLmNvbS9idWcucGhwP2lkPTg2NjI0" title="https://bugs.mysql.com/bug.php?id=86624">Mysqlå°½ç„¶æœ‰è¿™æ ·çš„bug<i class="fa fa-external-link"></i></span>  </p><p>2017å¹´æœ‰ä¸ªå“¥ä»¬æäº†è¿™æ ·çš„ä¸€ä¸ªissueï¼Œå°±æ˜¯ä¸Šé¢çš„é“¾æ¥ã€‚</p><p>é‡Œé¢è¯´äº†ä¸€äº›æƒ…å†µï¼Œåœ¨mysql5.6é‡Œï¼Œéšæœºæ•°æ˜¯ä¸€æ ·çš„ï¼Œ5.7é‡Œéšæœºæ•°ä¸ä¸€æ ·ã€‚å¦‚æœå­æŸ¥è¯¢é‡Œä¸ä½¿ç”¨è¡¨ï¼Œéšæœºæ•°ä¹Ÿæ˜¯ä¸€æ ·ã€‚åˆšåˆšå¥½mysqlå°±æ˜¯5.7ï¼Œåˆšåˆšå¥½ä¸­æ‹›äº†ã€‚</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fz9lojw8glj31rm0okadq.jpg" alt="image-20190117151229364"></p><p>æ ¹æ®ä½œè€…å’ŒRoy Lysengçš„å»ºè®®ï¼Œæˆ‘ç”¨limitï¼Œæ²¡æƒ³åˆ°ï¼Œå°½ç„¶é˜”ä»¥å•¦ï¼Œè€æ³ªçºµæ¨ªå•Šã€‚</p><p>è¿˜æ˜¯è€å¤–å¥½ï¼ŒæˆåŠŸçš„è§£å†³æ–¹æ¡ˆï¼Œä¹Ÿä¼šåœ¨issueé‡Œè¯´æ˜ä¸‹çš„ã€‚</p><p>æ”¹é€ åçš„æœ€ç»ˆæ ·å­ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> temp.user_id, desc_index, <span class="keyword">CONCAT</span>(desc_index, <span class="string">'\"desc\": &#123;\"label\":\"'</span>, </span><br><span class="line">substring_index(substring_index(<span class="string">'å­¦å¯Œäº”è½¦;è¶³æ™ºå¤šè°‹;ä»—ä¹‰æ‰§è¨€;ç«çœ¼é‡‘ç›;è§å¤šè¯†å¹¿;è´£ä»»æ‹…å½“;ä¹è§‚ç§¯æ'</span>,<span class="string">';'</span>,temp.desc_index),<span class="string">';'</span>,<span class="number">1</span>),<span class="string">'\"'</span>,</span><br><span class="line"><span class="string">',\"description\": \"'</span>, substring_index(substring_index(<span class="string">'å†ç¾çš„æ°”è´¨ï¼Œä¹Ÿæ©ç›–ä¸äº†ä½ æ‰åæœ¬è´¨;è„‘åŠ›ä½¿ç”¨ç§¯æåˆ†å­ï¼Œéä½ è«å±;ä½ çš„è§è§£ï¼Œé¢é¢ä¿±åˆ°ï¼Œæ·±å…¥äººå¿ƒ;ç‹¬ç‰¹çš„æ´å¯ŸåŠ›ï¼Œæ€»èƒ½è·æ‚‰ä¸€åˆ‡;æœ€ç¾çš„é˜…å†ï¼Œå°±æ˜¯æ²¿è·¯çš„é£æ™¯;å…ˆå¤©ä¸‹ä¹‹å¿§è€Œå¿§,åå¤©ä¸‹ä¹‹ä¹è€Œä¹;çˆ±ç¬‘çš„ä½ è¿æ°”ä¸€å®šä¸ä¼šå·®'</span>,<span class="string">';'</span>,temp.desc_index),<span class="string">';'</span>,<span class="number">1</span>),</span><br><span class="line"><span class="string">'\"&#125;'</span></span><br><span class="line">) <span class="keyword">as</span> report_content <span class="keyword">from</span> (<span class="keyword">select</span> user_id, -<span class="keyword">FLOOR</span>(<span class="keyword">rand</span>()*<span class="number">7</span>+<span class="number">1</span>) <span class="keyword">as</span> desc_index <span class="keyword">from</span> <span class="keyword">data</span> <span class="keyword">limit</span> <span class="number">100000</span>) temp</span><br></pre></td></tr></table></figure><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fz9lqsx0q6j312p0u0e56.jpg" alt="image-20190117151435160"></p>]]></content>
    
    <summary type="html">
    
      &lt;div class=&quot;note info&quot;&gt;
            &lt;p&gt;åœºæ™¯ï¼šä¸´è¿‘å¹´åº•ï¼Œå„ä¸ªAppéƒ½ä¼šæœ‰ä¸ªäººå¹´åº¦è´¦å•ï¼Œé¡¹ç›®é‡Œä¸ºäº†å›¾å¿«ï¼Œä»¥åŠèŠ‚çœå„ä¸ªç³»ç»Ÿæ¨¡å—ä¹‹é—´çš„æ¥å£è”è°ƒã€‚ç›´æ¥äººå·¥ç»Ÿè®¡æ•°æ®ï¼ˆğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ğŸ˜³ï¼‰ï¼Œæ„é€ è´¦å•æ•°æ®JSONã€‚&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
      <category term="Mysql" scheme="http://damonchow.github.io/categories/Mysql/"/>
    
    
  </entry>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹ä¸­ä»‹è€…æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2019/01/15/design-pattern-mediator/"/>
    <id>http://damonchow.github.io/2019/01/15/design-pattern-mediator/</id>
    <published>2019-01-15T07:28:54.000Z</published>
    <updated>2019-01-16T07:35:14.189Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼"></a>ä¸­ä»‹è€…æ¨¡å¼</h1><div class="note info">            <p>ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰æ˜¯ç”¨æ¥é™ä½å¤šä¸ªå¯¹è±¡å’Œç±»ä¹‹é—´çš„é€šä¿¡å¤æ‚æ€§ã€‚è¿™ç§æ¨¡å¼æä¾›äº†ä¸€ä¸ªä¸­ä»‹ç±»ï¼Œè¯¥ç±»é€šå¸¸å¤„ç†ä¸åŒç±»ä¹‹é—´çš„é€šä¿¡ï¼Œå¹¶æ”¯æŒæ¾è€¦åˆï¼Œä½¿ä»£ç æ˜“äºç»´æŠ¤ã€‚ä¸­ä»‹è€…æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚</p>          </div><p>é€šä¿—ç‚¹æ¥è®²å°±æ˜¯æä¾›ä¸€ä¸ªä¸­ä»‹å¹³å°ï¼Œè¯´åˆ°å¹³å°ï¼Œé‚£å…¶å®å¾ˆå®¹æ˜“è”ç³»åˆ°æˆ‘ä»¬å¾ˆç†Ÿæ‚‰çš„æˆ¿åœ°äº§ä¸­ä»‹ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªå¹³å°å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œä¸ç”¨å¯¹è±¡è‡ªèº«ä¸å…¶ä»–å¯¹è±¡äº¤äº’ã€‚</p><a id="more"></a><p>ä¹°æˆ¿å­ç§Ÿæˆ¿å­å°±ä¸éœ€è¦å»æ‰¾æˆ¿ä¸œï¼Œåªéœ€è¦åœ¨ä¸­ä»‹é‚£é‡Œè·å–ç›¸åº”çš„æˆ¿äº§ä¿¡æ¯ã€‚å¦‚ä¸‹å›¾é‚£æ ·ï¼Œä¸¤æ–¹åªéœ€è¦æ‰¾ä¸­ä»‹å³å¯ã€‚</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fz7b4m32qsj30dw0av74t.jpg" alt="æˆ¿åœ°äº§ä¸­ä»‹"></p><p>å†æ¥çœ‹ä¸€å¼ å¯¹æ¯”å›¾ã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fz7b6s1hx1j30o709x3zn.jpg" alt="ä¸­ä»‹è€…å‰åå¯¹æ¯”"></p><p>æœ‰æ²¡æœ‰æ„Ÿè§‰æ²¡æœ‰ä½¿ç”¨ä¹‹å‰ï¼Œå¯¹è±¡é—´äº’ç›¸ä¾èµ–äº’ç›¸è°ƒç”¨ï¼Œé”™ç»¼å¤æ‚ï¼Œç›˜æ ¹é”™èŠ‚ï¼Œå½“åŠ å…¥ä¸­ä»‹è€…åï¼Œå¯¹è±¡é—´çš„å…³ç³»ä¸€ç›®äº†ç„¶ï¼Œæ¸…æ™°æ˜äº†ã€‚ç”±ä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å¯¹è±¡ä¹‹é—´çš„äº¤äº’å…³ç³»ã€‚ä¸­ä»‹è€…ä½¿å„ä¸ªå¯¹è±¡ä¹‹é—´ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿è€¦åˆæ€§é™ä½ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’è¡Œä¸ºã€‚</p><h1 id="ä¸­ä»‹è€…æ¨¡å¼UMLå›¾"><a href="#ä¸­ä»‹è€…æ¨¡å¼UMLå›¾" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼UMLå›¾"></a>ä¸­ä»‹è€…æ¨¡å¼UMLå›¾</h1><h2 id="UMLç±»å›¾å’Œæ—¶åºå›¾"><a href="#UMLç±»å›¾å’Œæ—¶åºå›¾" class="headerlink" title="UMLç±»å›¾å’Œæ—¶åºå›¾"></a>UMLç±»å›¾å’Œæ—¶åºå›¾</h2><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fz7bbp35cxj30go06o74t.jpg" alt="ç±»å›¾å’Œæ—¶åºå›¾"></p><p>collague1å’Œcollague2ç±»ä¸ç›´æ¥ç›¸äº’ä¾èµ–ï¼Œå®ƒä»¬æ˜¯ç”¨èµ·æ§åˆ¶å’Œåè°ƒäº¤äº’ä½œç”¨çš„å…¬å…±ä¸­ä»‹æ¥å£ï¼ˆmediateï¼ˆï¼‰æ–¹æ³•ï¼‰ï¼Œè¿™ä½¿å®ƒä»¬æœ‰ç‹¬ç«‹äº¤äº’çš„æ‰§è¡Œæ–¹å¼ã€‚mediate1ç±»å®ç°collague1å’Œcollague2ä¹‹é—´çš„ä¾èµ–ã€‚</p><h2 id="ä¸­ä»‹è€…æ¨¡å¼è§’è‰²"><a href="#ä¸­ä»‹è€…æ¨¡å¼è§’è‰²" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼è§’è‰²"></a>ä¸­ä»‹è€…æ¨¡å¼è§’è‰²</h2><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fz7btn37e2j30hm05c3ys.jpg" alt="è§’è‰²"></p><blockquote><p>æŠ½è±¡ä¸­ä»‹è€…(Mediator): å®šä¹‰äº†åŒäº‹å¯¹è±¡åˆ°ä¸­ä»‹è€…å¯¹è±¡ä¹‹é—´çš„æ¥å£ã€‚</p><p>å…·ä½“ä¸­ä»‹è€…(ConcreteMediator): å®ç°æŠ½è±¡ä¸­ä»‹è€…çš„æ–¹æ³•ï¼Œå®ƒéœ€è¦çŸ¥é“æ‰€æœ‰çš„å…·ä½“åŒäº‹ç±»ï¼ŒåŒæ—¶éœ€è¦ä»å…·ä½“çš„åŒäº‹ç±»é‚£é‡Œæ¥æ”¶ä¿¡æ¯ï¼Œå¹¶ä¸”å‘å…·ä½“çš„åŒäº‹ç±»å‘é€ä¿¡æ¯ã€‚</p><p>æŠ½è±¡åŒäº‹ç±»(Colleague): å®šä¹‰äº†ä¸­ä»‹è€…å¯¹è±¡çš„æ¥å£ï¼Œå®ƒåªçŸ¥é“ä¸­ä»‹è€…è€Œä¸çŸ¥é“å…¶ä»–çš„åŒäº‹å¯¹è±¡ã€‚</p><p>å…·ä½“åŒäº‹ç±»(ConcreteColleague) : æ¯ä¸ªå…·ä½“åŒäº‹ç±»éƒ½åªéœ€è¦çŸ¥é“è‡ªå·±çš„è¡Œä¸ºå³å¯ï¼Œä½†æ˜¯ä»–ä»¬éƒ½éœ€è¦è®¤è¯†ä¸­ä»‹è€…ã€‚</p></blockquote><h1 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h1><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci9tZWRpYXRvcg==" title="https://github.com/DamonChow/design_pattern/tree/master/mediator">æºç åœ°å€<i class="fa fa-external-link"></i></span></p><p>æŠ½è±¡ä¸­ä»‹è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æˆ¿ä¸œmap</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> Map&lt;People, Message&gt; landlordMap = Maps.newHashMap();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§Ÿæˆ·åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> List&lt;People&gt; renterList = Lists.newArrayList();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³¨å†Œæˆ¿ä¸œä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> landlord æˆ¿ä¸œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message  æˆ¿å±‹ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerLandlord</span><span class="params">(People landlord, Message message)</span> </span>&#123;</span><br><span class="line">        landlordMap.put(landlord, message);</span><br><span class="line">        log.info(<span class="string">"ä¸­ä»‹ä¿¡æ¯ï¼šæˆ¿ä¸œ|&#123;&#125;|åŠ å…¥åˆ°ä¸­ä»‹å¹³å°ï¼Œæˆ¿å±‹ä¿¡æ¯ï¼š&#123;&#125;"</span>, landlord.getName(), message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å˜æ›´æˆ¿ä¸œä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> landlord æˆ¿ä¸œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message  æˆ¿å±‹ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">modifyLandlordInfo</span><span class="params">(People landlord, Message message)</span> </span>&#123;</span><br><span class="line">        landlordMap.put(landlord, message);</span><br><span class="line">        log.info(<span class="string">"ä¸­ä»‹ä¿¡æ¯ï¼šæˆ¿ä¸œ|&#123;&#125;|ä¿®æ”¹ä»–åœ¨ä¸­ä»‹å¹³å°çš„æˆ¿å±‹ä¿¡æ¯ï¼Œç°æˆ¿å±‹ä¿¡æ¯ï¼š&#123;&#125;"</span>, landlord.getName(), message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³¨å†Œç§Ÿæˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> renter ç§Ÿæˆ·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerRenter</span><span class="params">(People renter)</span> </span>&#123;</span><br><span class="line">        renterList.add(renter);</span><br><span class="line">        log.info(<span class="string">"ä¸­ä»‹ä¿¡æ¯ï¼šç§Ÿæˆ·|&#123;&#125;|æ¥ä¸­ä»‹å¹³å°ç§Ÿæˆ¿"</span>, renter.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å£°æ˜æŠ½è±¡æ–¹æ³• ç”±å…·ä½“ä¸­ä»‹è€…å­ç±»å®ç° æ¶ˆæ¯çš„ä¸­è½¬å’Œåè°ƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">operation</span><span class="params">(People people, Message message)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠ½è±¡åŒäº‹ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Mediator mediator;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘ä¸­ä»‹å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(Message message)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»ä¸­ä»‹è·å–æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">getMessage</span><span class="params">(Message message)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“åŒäº‹ç±» æˆ¿ä¸œå’Œç§Ÿæˆ·</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Landlord</span> <span class="keyword">extends</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Landlord</span><span class="params">(Mediator mediator, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(mediator, name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">        getMediator().operation(<span class="keyword">this</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">getMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"æˆ¿ä¸œ|&#123;&#125;|ä»ä¸­ä»‹è·å–åˆ°ç§Ÿæˆ·çš„ä¿¡æ¯ï¼š&#123;&#125;"</span>, getName(), message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Renter</span> <span class="keyword">extends</span> <span class="title">People</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Renter</span><span class="params">(Mediator mediator, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(mediator, name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">sendMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">        getMediator().operation(<span class="keyword">this</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">getMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"ç§Ÿæˆ·|&#123;&#125;|ä»ä¸­ä»‹è·å–åˆ°æˆ¿ä¸œçš„ä¿¡æ¯ï¼š&#123;&#125;"</span>, getName(), message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“ä¸­ä»‹è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RealEstateAgent</span> <span class="keyword">extends</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation</span><span class="params">(People people, Message message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (people <span class="keyword">instanceof</span> Renter) &#123;</span><br><span class="line">            <span class="comment">// å°†ç§Ÿæˆ·çš„ç§Ÿæˆ¿æ¡ä»¶ä¿¡æ¯å‘é€ç»™æˆ¿ä¸œä»¬</span></span><br><span class="line">            landlordMap.keySet().forEach(landlord -&gt; landlord.getMessage(message));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ç§Ÿæˆ·æ”¶åˆ°ä¸­ä»‹é‚£é‡Œæˆ¿ä¸œçš„æˆ¿å±‹ä¿¡æ¯</span></span><br><span class="line">            landlordMap.values().forEach(messages -&gt; people.getMessage(messages));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (people <span class="keyword">instanceof</span> Landlord) &#123;</span><br><span class="line">            <span class="comment">// å°†æˆ¿ä¸œçš„æˆ¿å±‹ä¿¡æ¯å‘é€ç»™ç§Ÿæˆ·ä»¬</span></span><br><span class="line">            renterList.forEach(renter -&gt; renter.getMessage(message));</span><br><span class="line">            <span class="comment">// å˜æ›´ä¸­ä»‹é‡Œçš„æˆ¿ä¸œæˆ¿å±‹ä¿¡æ¯</span></span><br><span class="line">            modifyLandlordInfo(people, message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Mediator mediator = <span class="keyword">new</span> RealEstateAgent();</span><br><span class="line">        People laoWang = <span class="keyword">new</span> Landlord(mediator, <span class="string">"è€ç‹"</span>);</span><br><span class="line">        People laoLee = <span class="keyword">new</span> Landlord(mediator, <span class="string">"è€æ"</span>);</span><br><span class="line">        People laoBai = <span class="keyword">new</span> Landlord(mediator, <span class="string">"è€ç™½"</span>);</span><br><span class="line"></span><br><span class="line">        People xiaoSan = <span class="keyword">new</span> Renter(mediator, <span class="string">"å°3"</span>);</span><br><span class="line">        People xiaoWang = <span class="keyword">new</span> Renter(mediator, <span class="string">"å°ç‹"</span>);</span><br><span class="line"></span><br><span class="line">        mediator.registerLandlord(laoWang, Message.builder().msg(<span class="string">"æˆ‘è¿™æœ‰2500çš„æˆ¿å­ï¼Œå¸‚ä¸­å¿ƒ"</span>).build());</span><br><span class="line">        mediator.registerLandlord(laoBai, Message.builder().msg(<span class="string">"æˆ‘è¿™æœ‰2000çš„æˆ¿å­ï¼Œåœ°é“æ—"</span>).build());</span><br><span class="line">        mediator.registerLandlord(laoLee, Message.builder().msg(<span class="string">"æˆ‘è¿™æœ‰2000çš„æˆ¿å­ï¼Œè½åœ°é˜³å°ï¼Œå¤§ç©ºé—´ï¼Œé‡‡å…‰å¥½ï¼Œåœ°é“æ—"</span>).build());</span><br><span class="line"></span><br><span class="line">        mediator.registerRenter(xiaoSan);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"å°3å¼€å§‹æ‰¾æˆ¿å­"</span>);</span><br><span class="line">        xiaoSan.sendMessage(Message.builder().msg(<span class="string">"æƒ³æ‰¾ä¸ªæœˆç§Ÿ2000å—çš„æˆ¿å­ï¼Œé è¿‘åœ°é“"</span>).build());</span><br><span class="line">        log.info(<span class="string">"æ²¡è¿‡å¤šä¹…---------è€ç™½å‡çº§äº†æˆ¿å±‹ä¿¡æ¯"</span>);</span><br><span class="line">        laoBai.sendMessage(Message.builder().msg(<span class="string">"æˆ‘è¿™æœ‰2000çš„æˆ¿å­ï¼Œåœ°é“æ—ï¼Œæˆ‘åˆåŠ äº†ç©ºè°ƒå’Œçƒ­æ°´å™¨"</span>).build());</span><br><span class="line">        mediator.registerRenter(xiaoWang);</span><br><span class="line">        log.info(<span class="string">"å°ç‹å¼€å§‹æ‰¾æˆ¿å­"</span>);</span><br><span class="line">        xiaoWang.sendMessage(Message.builder().msg(<span class="string">"æƒ³æ‰¾ä¸ªæœˆç§Ÿ2500å—çš„æˆ¿å­ï¼Œé è¿‘åœ°é“"</span>).build());</span><br><span class="line">        log.info(<span class="string">"æ²¡è¿‡å¤šä¹…---------è€æä¹Ÿå‡çº§äº†æˆ¿å±‹ä¿¡æ¯"</span>);</span><br><span class="line">        laoBai.sendMessage(Message.builder().msg(<span class="string">"æˆ‘è¿™æœ‰2000çš„æˆ¿å­ï¼Œè½åœ°é˜³å°ï¼Œå¤§ç©ºé—´ï¼Œé‡‡å…‰å¥½ï¼Œåœ°é“æ—ï¼Œæˆ‘ä¹ŸåŠ äº†ç©ºè°ƒå’Œçƒ­æ°´å™¨"</span>).build());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå‡ºæ•ˆæœçš„å¦‚ä¸‹</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fz8fv2diwej326f0u04iw.jpg" alt="æ•ˆæœ"></p><p>ç°åœ¨æˆ‘æ¥åˆ†æä¸‹é‡Œé¢å„ä¸ªè§’è‰²çš„ä½œç”¨ï¼š</p><p>é¦–å…ˆå…ˆåˆ†æä¸¤ä¸ªæŠ½è±¡ç±»ã€‚æŠ½è±¡åŒäº‹ç±»ï¼Œå«æœ‰åç§°å’Œä¸­ä»‹è€…çš„å¼•ç”¨ï¼Œæœ‰2ä¸ªæ–¹æ³•ä»ä¸­ä»‹æ‹¿ä¿¡æ¯å’Œå‘ä¿¡æ¯ç»™ä¸­ä»‹ã€‚æŠ½è±¡ä¸­ä»‹è€…ï¼Œå…¶ä¸­å«æœ‰æˆ¿ä¸œçš„mapä¿¡æ¯ï¼Œkeyä¸ºæˆ¿ä¸œæ•°æ®ï¼Œvalueä¸ºæˆ¿ä¸œçš„æˆ¿å±‹ä¿¡æ¯ï¼Œç”¨æ¥æˆ¿ä¸œæ³¨å†Œå’Œæˆ¿ä¸œæˆ¿å±‹ä¿¡æ¯å˜æ›´ï¼›ç§Ÿæˆ·çš„åˆ—è¡¨ä¿¡æ¯ï¼Œä¾›ç§Ÿæˆ·æ³¨å†Œï¼ŒåŒæ—¶è¿˜æœ‰ä¸ªåè°ƒæ–¹æ³•ï¼Œç”¨äºåè°ƒæˆ¿ä¸œå’Œç§Ÿæˆ·ã€‚</p><p>å…·ä½“æŠ½è±¡ç±»ï¼ˆæˆ¿åœ°äº§ä¸­ä»‹ï¼‰ï¼Œå®ç°äº†æŠ½è±¡ä¸­ä»‹è€…çš„åè°ƒæ–¹æ³•ï¼Œå½“ç§Ÿæˆ·å‘é€æ¶ˆæ¯æ—¶ï¼Œå°†ç§Ÿæˆ·çš„ç§Ÿæˆ¿æ¡ä»¶ä¿¡æ¯å‘é€ç»™æ‰€æœ‰æˆ¿ä¸œä»¬åŒæ—¶è¯¥ç§Ÿæˆ·æ”¶åˆ°ä¸­ä»‹é‚£é‡Œæ‰€æœ‰æˆ¿ä¸œçš„æˆ¿å±‹ä¿¡æ¯ï¼›å½“æˆ¿ä¸œå‘é€æ¶ˆæ¯æ—¶ï¼Œå°†æˆ¿ä¸œçš„æˆ¿å±‹ä¿¡æ¯å‘é€ç»™æ‰€æœ‰ç§Ÿæˆ·ä»¬åŒæ—¶å˜æ›´ä¸­ä»‹é‡Œçš„æ”¹æˆ¿ä¸œæˆ¿å±‹ä¿¡æ¯ã€‚</p><p>å…·ä½“åŒäº‹å®ç°ç±»ï¼ˆæˆ¿ä¸œå’Œç§Ÿæˆ·ï¼‰ï¼Œå®ç°äº†æŠ½è±¡åŒäº‹ç±»çš„è¯»å–æ¶ˆæ¯æ–¹æ³•å’Œå‘é€æ¶ˆæ¯æ–¹æ³•ï¼ˆè¯¥æˆ¿å±‹å°±æ˜¯ä¾é ä¸­ä»‹è€…çš„åè°ƒæ–¹æ³•æ¥å®ç°ï¼‰ã€‚</p><h1 id="JDKä¸­çš„åº”ç”¨"><a href="#JDKä¸­çš„åº”ç”¨" class="headerlink" title="JDKä¸­çš„åº”ç”¨"></a>JDKä¸­çš„åº”ç”¨</h1><p>é€šè¿‡ä½¿ç”¨ä¸€ä¸ªä¸­é—´å¯¹è±¡æ¥è¿›è¡Œæ¶ˆæ¯åˆ†å‘ä»¥åŠå‡å°‘ç±»ä¹‹é—´çš„ç›´æ¥ä¾èµ–ã€‚</p><blockquote><p>java.util.Timer</p><p>java.util.concurrent.Executor#execute()</p><p>java.util.concurrent.ExecutorService#submit()</p><p>java.lang.reflect.Method#invoke()</p></blockquote><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><p>ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥æŠŠå¯¹ä¸ªåŒäº‹å¯¹è±¡ä¹‹é—´çš„äº¤äº’å°è£…åˆ°ä¸­ä»‹è€…å¯¹è±¡é‡Œé¢ï¼Œä»è€Œä½¿å¾—åŒäº‹å¯¹è±¡ä¹‹é—´æ¾æ•£è€¦åˆã€‚<br>ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥å°†åŸå…ˆå¤šå¯¹å¤šçš„åŒäº‹å¯¹è±¡å…³ç³»å˜æˆä¸­ä»‹è€…å¯¹è±¡ä¸€å¯¹å¤šåŒäº‹å¯¹è±¡çš„å…³ç³»ï¼Œè¿™æ ·ä¼šè®©å¯¹è±¡ä¹‹é—´çš„å…³ç³»æ›´å®¹æ˜“ç†è§£å’Œå®ç°ã€‚<br>åŒäº‹å¯¹è±¡ä¹‹é—´çš„äº¤äº’éƒ½è¢«å°è£…åˆ°ä¸­ä»‹è€…å¯¹è±¡é‡Œé¢é›†ä¸­ç®¡ç†ï¼Œé›†ä¸­äº†æ§åˆ¶äº¤äº’ã€‚å½“äº¤äº’å‘ç”Ÿæ”¹å˜æ—¶ï¼Œç€é‡ä¿®æ”¹çš„æ˜¯ä¸­ä»‹è€…å¯¹è±¡ã€‚å½“éœ€è¦æ‰©å±•ä¸­ä»‹è€…å¯¹è±¡æ—¶ï¼Œå…¶ä»–åŒäº‹å¯¹è±¡ä¸éœ€è¦åšä¿®æ”¹ã€‚</p><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><p>å¦‚æœåŒäº‹å¯¹è±¡å¤šäº†ï¼Œäº¤äº’ä¹Ÿå¤æ‚äº†ã€‚ä¸­ä»‹è€…ä¼šåºå¤§ï¼Œå˜å¾—å¤æ‚éš¾ä»¥ç»´æŠ¤ã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2Rlc2lnbi1wYXR0ZXJuL21lZGlhdG9yLXBhdHRlcm4uaHRtbA==" title="http://www.runoob.com/design-pattern/mediator-pattern.html">ä¸­ä»‹è€…æ¨¡å¼|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTWVkaWF0b3JfcGF0dGVybg==" title="https://en.wikipedia.org/wiki/Mediator_pattern">Mediator pattern<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdGlueWtpbmcvcC81OTM4NTQ3Lmh0bWw=" title="https://www.cnblogs.com/tinyking/p/5938547.html">ç»†æ•°JDKé‡Œçš„è®¾è®¡æ¨¡å¼<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2phbmljZTA1MjkvYXJ0aWNsZS9kZXRhaWxzLzQxNjg1MTc1" title="https://blog.csdn.net/janice0529/article/details/41685175">JAVAè®¾è®¡æ¨¡å¼ä¹‹ ä¸­ä»‹è€…æ¨¡å¼ã€Mediator Patternã€‘<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä¸­ä»‹è€…æ¨¡å¼&quot;&gt;&lt;a href=&quot;#ä¸­ä»‹è€…æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;ä¸­ä»‹è€…æ¨¡å¼&quot;&gt;&lt;/a&gt;ä¸­ä»‹è€…æ¨¡å¼&lt;/h1&gt;&lt;div class=&quot;note info&quot;&gt;
            &lt;p&gt;ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰æ˜¯ç”¨æ¥é™ä½å¤šä¸ªå¯¹è±¡å’Œç±»ä¹‹é—´çš„é€šä¿¡å¤æ‚æ€§ã€‚è¿™ç§æ¨¡å¼æä¾›äº†ä¸€ä¸ªä¸­ä»‹ç±»ï¼Œè¯¥ç±»é€šå¸¸å¤„ç†ä¸åŒç±»ä¹‹é—´çš„é€šä¿¡ï¼Œå¹¶æ”¯æŒæ¾è€¦åˆï¼Œä½¿ä»£ç æ˜“äºç»´æŠ¤ã€‚ä¸­ä»‹è€…æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚&lt;/p&gt;
          &lt;/div&gt;
&lt;p&gt;é€šä¿—ç‚¹æ¥è®²å°±æ˜¯æä¾›ä¸€ä¸ªä¸­ä»‹å¹³å°ï¼Œè¯´åˆ°å¹³å°ï¼Œé‚£å…¶å®å¾ˆå®¹æ˜“è”ç³»åˆ°æˆ‘ä»¬å¾ˆç†Ÿæ‚‰çš„æˆ¿åœ°äº§ä¸­ä»‹ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªå¹³å°å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œä¸ç”¨å¯¹è±¡è‡ªèº«ä¸å…¶ä»–å¯¹è±¡äº¤äº’ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="ä¸­ä»‹è€…" scheme="http://damonchow.github.io/tags/%E4%B8%AD%E4%BB%8B%E8%80%85/"/>
    
  </entry>
  
  <entry>
    <title>é˜¿é‡Œå·´å·´å¼€æºåˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ FESCARã€è½¬ã€‘</title>
    <link href="http://damonchow.github.io/2019/01/13/fescar/"/>
    <id>http://damonchow.github.io/2019/01/13/fescar/</id>
    <published>2019-01-13T03:06:08.000Z</published>
    <updated>2019-01-13T03:35:50.834Z</updated>
    
    <content type="html"><![CDATA[<p>å¶ç„¶é—´çœ‹åˆ°é˜¿é‡Œå¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡ä¸­é—´ä»¶ï¼ŒæœŸå¾…æœ‰æŠ•å…¥åˆ°ç”Ÿäº§é˜¶æ®µçš„æ —å­ã€‚ä»è“å›¾ä¸Šçœ‹å‡ºç›®å‰æœ‰æ”¯æŒdubboçš„è§£å†³æ–¹æ¡ˆï¼Œåç»­0.5.xç‰ˆæœ¬ä¼šæ¨å‡ºæ”¯æŒspring cloudçš„æ–¹æ¡ˆã€‚</p><p>ä¸‹é¢çœ‹å®˜æ–¹æ­£æ–‡ï¼Œå–œæ¬¢çš„å¯ä»¥å»å®˜æ–¹Githubä¸Šç§ç§çœ‹çœ‹ã€‚</p><p>Fescar æ˜¯ <strong>é˜¿é‡Œå·´å·´</strong> å¼€æºçš„ <strong>åˆ†å¸ƒå¼äº‹åŠ¡</strong>ä¸­é—´ä»¶ï¼Œä»¥ <strong>é«˜æ•ˆ</strong> å¹¶ä¸”å¯¹ä¸šåŠ¡ <strong>0 ä¾µå…¥</strong> çš„æ–¹å¼ï¼Œè§£å†³ <strong>å¾®æœåŠ¡</strong> åœºæ™¯ä¸‹é¢ä¸´çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚</p><a id="more"></a><h1 id="1-ä»€ä¹ˆæ˜¯å¾®æœåŠ¡åŒ–å¸¦æ¥çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯å¾®æœåŠ¡åŒ–å¸¦æ¥çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯å¾®æœåŠ¡åŒ–å¸¦æ¥çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯å¾®æœåŠ¡åŒ–å¸¦æ¥çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼Ÿ</h1><p>é¦–å…ˆï¼Œè®¾æƒ³ä¸€ä¸ªä¼ ç»Ÿçš„å•ä½“åº”ç”¨ï¼ˆMonolithic Appï¼‰ï¼Œé€šè¿‡ 3 ä¸ª Moduleï¼Œåœ¨åŒä¸€ä¸ªæ•°æ®æºä¸Šæ›´æ–°æ•°æ®æ¥å®Œæˆä¸€é¡¹ä¸šåŠ¡ã€‚</p><p>å¾ˆè‡ªç„¶çš„ï¼Œæ•´ä¸ªä¸šåŠ¡è¿‡ç¨‹çš„æ•°æ®ä¸€è‡´æ€§ç”±æœ¬åœ°äº‹åŠ¡æ¥ä¿è¯ã€‚</p><p><img src="https://camo.githubusercontent.com/03866ddf607bbc4085546a98576dd2567ee72f6f/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d663363633939313237393865386431662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Monolithic architecture"></p><p>éšç€ä¸šåŠ¡éœ€æ±‚å’Œæ¶æ„çš„å˜åŒ–ï¼Œå•ä½“åº”ç”¨è¢«æ‹†åˆ†ä¸ºå¾®æœåŠ¡ï¼šåŸæ¥çš„ 3 ä¸ª Module è¢«æ‹†åˆ†ä¸º 3 ä¸ªç‹¬ç«‹çš„æœåŠ¡ï¼Œåˆ†åˆ«ä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®æºï¼ˆ<span class="exturl" data-url="aHR0cDovL21pY3Jvc2VydmljZXMuaW8vcGF0dGVybnMvZGF0YS9kYXRhYmFzZS1wZXItc2VydmljZS5odG1s" title="http://microservices.io/patterns/data/database-per-service.html">Pattern: Database per service<i class="fa fa-external-link"></i></span>ï¼‰ã€‚ä¸šåŠ¡è¿‡ç¨‹å°†ç”± 3 ä¸ªæœåŠ¡çš„è°ƒç”¨æ¥å®Œæˆã€‚</p><p><img src="https://camo.githubusercontent.com/92d03e2b51ada19d4f0253ac2f12389b2d1444e3/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d653139383262616163363637323662352e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Microservices architecture"></p><p>æ­¤æ—¶ï¼Œæ¯ä¸€ä¸ªæœåŠ¡å†…éƒ¨çš„æ•°æ®ä¸€è‡´æ€§ä»æœ‰æœ¬åœ°äº‹åŠ¡æ¥ä¿è¯ã€‚è€Œæ•´ä¸ªä¸šåŠ¡å±‚é¢çš„å…¨å±€æ•°æ®ä¸€è‡´æ€§è¦å¦‚ä½•ä¿éšœå‘¢ï¼Ÿè¿™å°±æ˜¯å¾®æœåŠ¡æ¶æ„ä¸‹é¢ä¸´çš„ï¼Œå…¸å‹çš„åˆ†å¸ƒå¼äº‹åŠ¡éœ€æ±‚ï¼šæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆä¿éšœä¸šåŠ¡å…¨å±€çš„æ•°æ®ä¸€è‡´æ€§ã€‚</p><p><img src="https://camo.githubusercontent.com/91fa8fa3d769287475d46dcd3df33e0ad57331b3/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d323532356239653462366263323163362e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Fescar Solution"></p><h1 id="2-Fescar-çš„å‘å±•å†ç¨‹"><a href="#2-Fescar-çš„å‘å±•å†ç¨‹" class="headerlink" title="2. Fescar çš„å‘å±•å†ç¨‹"></a>2. Fescar çš„å‘å±•å†ç¨‹</h1><p>é˜¿é‡Œæ˜¯å›½å†…æœ€æ—©ä¸€æ‰¹è¿›è¡Œåº”ç”¨åˆ†å¸ƒå¼ï¼ˆå¾®æœåŠ¡åŒ–ï¼‰æ”¹é€ çš„ä¼ä¸šï¼Œæ‰€ä»¥å¾ˆæ—©å°±é‡åˆ°å¾®æœåŠ¡æ¶æ„ä¸‹çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚</p><p>2014 å¹´ï¼Œé˜¿é‡Œä¸­é—´ä»¶å›¢é˜Ÿå‘å¸ƒ <strong>TXCï¼ˆTaobao Transaction Constructorï¼‰</strong>ï¼Œä¸ºé›†å›¢å†…åº”ç”¨æä¾›åˆ†å¸ƒå¼äº‹åŠ¡æœåŠ¡ã€‚</p><p>2016 å¹´ï¼ŒTXC ç»è¿‡äº§å“åŒ–æ”¹é€ ï¼Œä»¥ <strong>GTSï¼ˆGlobal Transaction Serviceï¼‰</strong>çš„èº«ä»½ç™»é™†é˜¿é‡Œäº‘ï¼Œæˆä¸ºå½“æ—¶ä¸šç•Œå”¯ä¸€ä¸€æ¬¾äº‘ä¸Šåˆ†å¸ƒå¼äº‹åŠ¡äº§å“ï¼Œåœ¨é˜¿äº‘é‡Œçš„å…¬æœ‰äº‘ã€ä¸“æœ‰äº‘è§£å†³æ–¹æ¡ˆä¸­ï¼Œå¼€å§‹æœåŠ¡äºä¼—å¤šå¤–éƒ¨å®¢æˆ·ã€‚</p><p>2019 å¹´èµ·ï¼ŒåŸºäº TXC å’Œ GTS çš„æŠ€æœ¯ç§¯ç´¯ï¼Œé˜¿é‡Œä¸­é—´ä»¶å›¢é˜Ÿå‘èµ·äº†å¼€æºé¡¹ç›® <strong>Fescarï¼ˆFast &amp; EaSy Commit And Rollback, FESCARï¼‰</strong>ï¼Œå’Œç¤¾åŒºä¸€èµ·å»ºè®¾è¿™ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚</p><p>TXC/GTS/Fescar ä¸€è„‰ç›¸æ‰¿ï¼Œä¸ºè§£å†³å¾®æœåŠ¡æ¶æ„ä¸‹çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜äº¤å‡ºäº†ä¸€ä»½ä¸ä¼—ä¸åŒçš„ç­”å·ã€‚</p><h2 id="2-1-è®¾è®¡åˆè¡·"><a href="#2-1-è®¾è®¡åˆè¡·" class="headerlink" title="2.1 è®¾è®¡åˆè¡·"></a>2.1 è®¾è®¡åˆè¡·</h2><p>é«˜é€Ÿå¢é•¿çš„äº’è”ç½‘æ—¶ä»£ï¼Œ<strong>å¿«é€Ÿè¯•é”™</strong> çš„èƒ½åŠ›å¯¹ä¸šåŠ¡æ¥è¯´æ˜¯è‡³å…³é‡è¦çš„ï¼š</p><ul><li>ä¸€æ–¹é¢ï¼Œä¸åº”è¯¥å› ä¸ºæŠ€æœ¯æ¶æ„ä¸Šçš„å¾®æœåŠ¡åŒ–å’Œåˆ†å¸ƒå¼äº‹åŠ¡æ”¯æŒçš„å¼•å…¥ï¼Œç»™ä¸šåŠ¡å±‚é¢å¸¦æ¥é¢å¤–çš„ç ”å‘è´Ÿæ‹…ã€‚</li><li>å¦ä¸€æ–¹é¢ï¼Œå¼•å…¥åˆ†å¸ƒå¼äº‹åŠ¡æ”¯æŒçš„ä¸šåŠ¡åº”è¯¥åŸºæœ¬ä¿æŒåœ¨åŒä¸€é‡çº§ä¸Šçš„æ€§èƒ½è¡¨ç°ï¼Œä¸èƒ½å› ä¸ºäº‹åŠ¡æœºåˆ¶æ˜¾è‘—æ‹–æ…¢ä¸šåŠ¡ã€‚</li></ul><p>åŸºäºè¿™ä¸¤ç‚¹ï¼Œæˆ‘ä»¬è®¾è®¡ä¹‹åˆçš„æœ€é‡è¦çš„è€ƒé‡å°±åœ¨äºï¼š</p><ul><li><strong>å¯¹ä¸šåŠ¡æ— ä¾µå…¥ï¼š</strong> è¿™é‡Œçš„ <strong>ä¾µå…¥</strong> æ˜¯æŒ‡ï¼Œå› ä¸ºåˆ†å¸ƒå¼äº‹åŠ¡è¿™ä¸ªæŠ€æœ¯é—®é¢˜çš„åˆ¶çº¦ï¼Œè¦æ±‚åº”ç”¨åœ¨ä¸šåŠ¡å±‚é¢è¿›è¡Œè®¾è®¡å’Œæ”¹é€ ã€‚è¿™ç§è®¾è®¡å’Œæ”¹é€ å¾€å¾€ä¼šç»™åº”ç”¨å¸¦æ¥å¾ˆé«˜çš„ç ”å‘å’Œç»´æŠ¤æˆæœ¬ã€‚æˆ‘ä»¬å¸Œæœ›æŠŠåˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜åœ¨ <strong>ä¸­é—´ä»¶</strong> è¿™ä¸ªå±‚æ¬¡è§£å†³æ‰ï¼Œä¸è¦æ±‚åº”ç”¨åœ¨ä¸šåŠ¡å±‚é¢åšé¢å¤–çš„å·¥ä½œã€‚</li><li><strong>é«˜æ€§èƒ½ï¼š</strong> å¼•å…¥åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¿éšœï¼Œå¿…ç„¶ä¼šæœ‰é¢å¤–çš„å¼€é”€ï¼Œå¼•èµ·æ€§èƒ½çš„ä¸‹é™ã€‚æˆ‘ä»¬å¸Œæœ›æŠŠåˆ†å¸ƒå¼äº‹åŠ¡å¼•å…¥çš„æ€§èƒ½æŸè€—é™åˆ°éå¸¸ä½çš„æ°´å¹³ï¼Œè®©åº”ç”¨ä¸å› ä¸ºåˆ†å¸ƒå¼äº‹åŠ¡çš„å¼•å…¥å¯¼è‡´ä¸šåŠ¡çš„å¯ç”¨æ€§å—å½±å“ã€‚</li></ul><h2 id="2-2-æ—¢æœ‰çš„è§£å†³æ–¹æ¡ˆä¸ºä»€ä¹ˆä¸æ»¡è¶³ï¼Ÿ"><a href="#2-2-æ—¢æœ‰çš„è§£å†³æ–¹æ¡ˆä¸ºä»€ä¹ˆä¸æ»¡è¶³ï¼Ÿ" class="headerlink" title="2.2 æ—¢æœ‰çš„è§£å†³æ–¹æ¡ˆä¸ºä»€ä¹ˆä¸æ»¡è¶³ï¼Ÿ"></a>2.2 æ—¢æœ‰çš„è§£å†³æ–¹æ¡ˆä¸ºä»€ä¹ˆä¸æ»¡è¶³ï¼Ÿ</h2><p>æ—¢æœ‰çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆæŒ‰ç…§å¯¹ä¸šåŠ¡ä¾µå…¥æ€§åˆ†ä¸ºä¸¤ç±»ï¼Œå³ï¼šå¯¹ä¸šåŠ¡æ— ä¾µå…¥çš„å’Œå¯¹ä¸šåŠ¡æœ‰ä¾µå…¥çš„ã€‚</p><h3 id="ä¸šåŠ¡æ— ä¾µå…¥çš„æ–¹æ¡ˆ"><a href="#ä¸šåŠ¡æ— ä¾µå…¥çš„æ–¹æ¡ˆ" class="headerlink" title="ä¸šåŠ¡æ— ä¾µå…¥çš„æ–¹æ¡ˆ"></a>ä¸šåŠ¡æ— ä¾µå…¥çš„æ–¹æ¡ˆ</h3><p>æ—¢æœ‰çš„ä¸»æµåˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆä¸­ï¼Œå¯¹ä¸šåŠ¡æ— ä¾µå…¥çš„åªæœ‰åŸºäº XA çš„æ–¹æ¡ˆï¼Œä½†åº”ç”¨ XA æ–¹æ¡ˆå­˜åœ¨ 3 ä¸ªæ–¹é¢çš„é—®é¢˜ï¼š</p><ol><li>è¦æ±‚æ•°æ®åº“æä¾›å¯¹ XA çš„æ”¯æŒã€‚å¦‚æœé‡åˆ°ä¸æ”¯æŒ XAï¼ˆæˆ–æ”¯æŒå¾—ä¸å¥½ï¼Œæ¯”å¦‚ MySQL 5.7 ä»¥å‰çš„ç‰ˆæœ¬ï¼‰çš„æ•°æ®åº“ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨ã€‚</li><li>å—åè®®æœ¬èº«çš„çº¦æŸï¼Œäº‹åŠ¡èµ„æºçš„é”å®šå‘¨æœŸé•¿ã€‚é•¿å‘¨æœŸçš„èµ„æºé”å®šä»ä¸šåŠ¡å±‚é¢æ¥çœ‹ï¼Œå¾€å¾€æ˜¯ä¸å¿…è¦çš„ï¼Œè€Œå› ä¸ºäº‹åŠ¡èµ„æºçš„ç®¡ç†å™¨æ˜¯æ•°æ®åº“æœ¬èº«ï¼Œåº”ç”¨å±‚æ— æ³•æ’æ‰‹ã€‚è¿™æ ·å½¢æˆçš„å±€é¢å°±æ˜¯ï¼ŒåŸºäº XA çš„åº”ç”¨å¾€å¾€æ€§èƒ½ä¼šæ¯”è¾ƒå·®ï¼Œè€Œä¸”å¾ˆéš¾ä¼˜åŒ–ã€‚</li><li>å·²ç»è½åœ°çš„åŸºäº XA çš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆï¼Œéƒ½ä¾æ‰˜äºé‡é‡çº§çš„åº”ç”¨æœåŠ¡å™¨ï¼ˆTuxedo/WebLogic/WebSphere ç­‰)ï¼Œè¿™æ˜¯ä¸é€‚ç”¨äºå¾®æœåŠ¡æ¶æ„çš„ã€‚</li></ol><h3 id="ä¾µå…¥ä¸šåŠ¡çš„æ–¹æ¡ˆ"><a href="#ä¾µå…¥ä¸šåŠ¡çš„æ–¹æ¡ˆ" class="headerlink" title="ä¾µå…¥ä¸šåŠ¡çš„æ–¹æ¡ˆ"></a>ä¾µå…¥ä¸šåŠ¡çš„æ–¹æ¡ˆ</h3><p>å®é™…ä¸Šï¼Œæœ€åˆåˆ†å¸ƒå¼äº‹åŠ¡åªæœ‰ XA è¿™ä¸ªå”¯ä¸€æ–¹æ¡ˆã€‚XA æ˜¯å®Œå¤‡çš„ï¼Œä½†åœ¨å®è·µè¿‡ç¨‹ä¸­ï¼Œç”±äºç§ç§åŸå› ï¼ˆåŒ…å«ä½†ä¸é™äºä¸Šé¢æåˆ°çš„ 3 ç‚¹ï¼‰å¾€å¾€ä¸å¾—ä¸æ”¾å¼ƒï¼Œè½¬è€Œä»ä¸šåŠ¡å±‚é¢ç€æ‰‹æ¥è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚æ¯”å¦‚ï¼š</p><ul><li>åŸºäºå¯é æ¶ˆæ¯çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ</li><li>TCC</li><li>Saga</li></ul><p>éƒ½å±äºè¿™ä¸€ç±»ã€‚è¿™äº›æ–¹æ¡ˆçš„å…·ä½“æœºåˆ¶åœ¨è¿™é‡Œä¸åšå±•å¼€ï¼Œç½‘ä¸Šè¿™æ–¹é¢çš„è®ºè¿°æ–‡ç« éå¸¸å¤šã€‚æ€»ä¹‹ï¼Œè¿™äº›æ–¹æ¡ˆéƒ½è¦æ±‚åœ¨åº”ç”¨çš„ä¸šåŠ¡å±‚é¢æŠŠåˆ†å¸ƒå¼äº‹åŠ¡æŠ€æœ¯çº¦æŸè€ƒè™‘åˆ°è®¾è®¡ä¸­ï¼Œé€šå¸¸æ¯ä¸€ä¸ªæœåŠ¡éƒ½éœ€è¦è®¾è®¡å®ç°æ­£å‘å’Œåå‘çš„å¹‚ç­‰æ¥å£ã€‚è¿™æ ·çš„è®¾è®¡çº¦æŸï¼Œå¾€å¾€ä¼šå¯¼è‡´å¾ˆé«˜çš„ç ”å‘å’Œç»´æŠ¤æˆæœ¬ã€‚</p><h2 id="2-3-ç†æƒ³çš„æ–¹æ¡ˆåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ"><a href="#2-3-ç†æƒ³çš„æ–¹æ¡ˆåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ" class="headerlink" title="2.3 ç†æƒ³çš„æ–¹æ¡ˆåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ"></a>2.3 ç†æƒ³çš„æ–¹æ¡ˆåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ</h2><p>ä¸å¯å¦è®¤ï¼Œä¾µå…¥ä¸šåŠ¡çš„åˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆéƒ½ç»è¿‡å¤§é‡å®è·µéªŒè¯ï¼Œèƒ½æœ‰æ•ˆè§£å†³é—®é¢˜ï¼Œåœ¨å„è¡Œç§ä¸šçš„ä¸šåŠ¡åº”ç”¨ç³»ç»Ÿä¸­èµ·ç€é‡è¦ä½œç”¨ã€‚ä½†å›åˆ°åŸç‚¹æ¥æ€è€ƒï¼Œè¿™äº›æ–¹æ¡ˆçš„é‡‡ç”¨å®é™…ä¸Šéƒ½æ˜¯ <strong>è¿«äºæ— å¥ˆ</strong>ã€‚è®¾æƒ³ï¼Œå¦‚æœåŸºäº XA çš„æ–¹æ¡ˆèƒ½å¤Ÿä¸é‚£ä¹ˆ <strong>é‡</strong>ï¼Œå¹¶ä¸”èƒ½ä¿è¯ä¸šåŠ¡çš„æ€§èƒ½éœ€æ±‚ï¼Œç›¸ä¿¡ä¸ä¼šæœ‰äººæ„¿æ„æŠŠåˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜æ‹¿åˆ°ä¸šåŠ¡å±‚é¢æ¥è§£å†³ã€‚</p><p>ä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆåº”è¯¥ï¼šåƒä½¿ç”¨ <strong>æœ¬åœ°äº‹åŠ¡</strong> ä¸€æ ·ç®€å•ï¼Œä¸šåŠ¡é€»è¾‘åªå…³æ³¨ä¸šåŠ¡å±‚é¢çš„éœ€æ±‚ï¼Œä¸éœ€è¦è€ƒè™‘äº‹åŠ¡æœºåˆ¶ä¸Šçš„çº¦æŸã€‚</p><h1 id="3-åŸç†å’Œè®¾è®¡"><a href="#3-åŸç†å’Œè®¾è®¡" class="headerlink" title="3. åŸç†å’Œè®¾è®¡"></a>3. åŸç†å’Œè®¾è®¡</h1><p>æˆ‘ä»¬è¦è®¾è®¡ä¸€ä¸ªå¯¹ä¸šåŠ¡æ— ä¾µå…¥çš„æ–¹æ¡ˆï¼Œæ‰€ä»¥ä»ä¸šåŠ¡æ— ä¾µå…¥çš„ XA æ–¹æ¡ˆæ¥æ€è€ƒï¼š</p><p>æ˜¯å¦å¯ä»¥åœ¨ XA çš„åŸºç¡€ä¸Šæ¼”è¿›ï¼Œè§£å†³æ‰ XA æ–¹æ¡ˆé¢ä¸´çš„é—®é¢˜å‘¢ï¼Ÿ</p><h3 id="3-1-å¦‚ä½•å®šä¹‰ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ"><a href="#3-1-å¦‚ä½•å®šä¹‰ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ" class="headerlink" title="3.1 å¦‚ä½•å®šä¹‰ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ"></a>3.1 å¦‚ä½•å®šä¹‰ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ</h3><p>é¦–å…ˆï¼Œå¾ˆè‡ªç„¶çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ç†è§£æˆä¸€ä¸ªåŒ…å«äº†è‹¥å¹² <strong>åˆ†æ”¯äº‹åŠ¡</strong> çš„ <strong>å…¨å±€äº‹åŠ¡</strong>ã€‚<strong>å…¨å±€äº‹åŠ¡</strong> çš„èŒè´£æ˜¯åè°ƒå…¶ä¸‹ç®¡è¾–çš„ <strong>åˆ†æ”¯äº‹åŠ¡</strong> è¾¾æˆä¸€è‡´ï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸæäº¤ï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥å›æ»šã€‚æ­¤å¤–ï¼Œé€šå¸¸ <strong>åˆ†æ”¯äº‹åŠ¡</strong> æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ»¡è¶³ ACID çš„ <strong>æœ¬åœ°äº‹åŠ¡</strong>ã€‚è¿™æ˜¯æˆ‘ä»¬å¯¹åˆ†å¸ƒå¼äº‹åŠ¡ç»“æ„çš„åŸºæœ¬è®¤è¯†ï¼Œä¸ XA æ˜¯ä¸€è‡´çš„ã€‚</p><p><img src="https://camo.githubusercontent.com/64c5d781fa984e22f84f68b092da5f3831ad7fb8/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d386165303536623662633837353266302e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Global &amp; Branch Transaction"></p><p>å…¶æ¬¡ï¼Œä¸ XA çš„æ¨¡å‹ç±»ä¼¼ï¼Œæˆ‘ä»¬å®šä¹‰ 3 ä¸ªç»„ä»¶æ¥åè®®åˆ†å¸ƒå¼äº‹åŠ¡çš„å¤„ç†è¿‡ç¨‹ã€‚</p><p><img src="https://camo.githubusercontent.com/6e0c90bb0e37a0f5bd8a0bba9f129536ef1bc239/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d313538663165323238393430366565612e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="FESCAR Model"></p><ul><li><strong>Transaction Coordinator (TC)ï¼š</strong> äº‹åŠ¡åè°ƒå™¨ï¼Œç»´æŠ¤å…¨å±€äº‹åŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼Œè´Ÿè´£åè°ƒå¹¶é©±åŠ¨å…¨å±€äº‹åŠ¡çš„æäº¤æˆ–å›æ»šã€‚</li><li><strong>Transaction Manager (TM)ï¼š</strong> æ§åˆ¶å…¨å±€äº‹åŠ¡çš„è¾¹ç•Œï¼Œè´Ÿè´£å¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼Œå¹¶æœ€ç»ˆå‘èµ·å…¨å±€æäº¤æˆ–å…¨å±€å›æ»šçš„å†³è®®ã€‚</li><li><strong>Resource Manager (RM)ï¼š</strong> æ§åˆ¶åˆ†æ”¯äº‹åŠ¡ï¼Œè´Ÿè´£åˆ†æ”¯æ³¨å†Œã€çŠ¶æ€æ±‡æŠ¥ï¼Œå¹¶æ¥æ”¶äº‹åŠ¡åè°ƒå™¨çš„æŒ‡ä»¤ï¼Œé©±åŠ¨åˆ†æ”¯ï¼ˆæœ¬åœ°ï¼‰äº‹åŠ¡çš„æäº¤å’Œå›æ»šã€‚</li></ul><p>ä¸€ä¸ªå…¸å‹çš„åˆ†å¸ƒå¼äº‹åŠ¡è¿‡ç¨‹ï¼š</p><ol><li>TM å‘ TC ç”³è¯·å¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼Œå…¨å±€äº‹åŠ¡åˆ›å»ºæˆåŠŸå¹¶ç”Ÿæˆä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ XIDã€‚</li><li>XID åœ¨å¾®æœåŠ¡è°ƒç”¨é“¾è·¯çš„ä¸Šä¸‹æ–‡ä¸­ä¼ æ’­ã€‚</li><li>RM å‘ TC æ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼Œå°†å…¶çº³å…¥ XID å¯¹åº”å…¨å±€äº‹åŠ¡çš„ç®¡è¾–ã€‚</li><li>TM å‘ TC å‘èµ·é’ˆå¯¹ XID çš„å…¨å±€æäº¤æˆ–å›æ»šå†³è®®ã€‚</li><li>TC è°ƒåº¦ XID ä¸‹ç®¡è¾–çš„å…¨éƒ¨åˆ†æ”¯äº‹åŠ¡å®Œæˆæäº¤æˆ–å›æ»šè¯·æ±‚ã€‚</li></ol><p><img src="https://camo.githubusercontent.com/6a31d57b4496e83af1a0bd76ede83657de2d9d34/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d343934613534643430326232643335342e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Architecture"></p><p>è‡³æ­¤ï¼ŒFescar çš„åè®®æœºåˆ¶æ€»ä½“ä¸Šçœ‹ä¸ XA æ˜¯ä¸€è‡´çš„ã€‚</p><h3 id="3-2-ä¸-XA-çš„å·®åˆ«åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ"><a href="#3-2-ä¸-XA-çš„å·®åˆ«åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ" class="headerlink" title="3.2 ä¸ XA çš„å·®åˆ«åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ"></a>3.2 ä¸ XA çš„å·®åˆ«åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ</h3><h4 id="æ¶æ„å±‚æ¬¡"><a href="#æ¶æ„å±‚æ¬¡" class="headerlink" title="æ¶æ„å±‚æ¬¡"></a>æ¶æ„å±‚æ¬¡</h4><p><img src="https://camo.githubusercontent.com/baa0219e4b899e3da35f29650e994f0bbf920ede/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d613463396535343266656331306333392e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="RM in Architecture"></p><p>XA æ–¹æ¡ˆçš„ RM å®é™…ä¸Šæ˜¯åœ¨æ•°æ®åº“å±‚ï¼ŒRM æœ¬è´¨ä¸Šå°±æ˜¯æ•°æ®åº“è‡ªèº«ï¼ˆé€šè¿‡æä¾›æ”¯æŒ XA çš„é©±åŠ¨ç¨‹åºæ¥ä¾›åº”ç”¨ä½¿ç”¨ï¼‰ã€‚</p><p>è€Œ Fescar çš„ RM æ˜¯ä»¥äºŒæ–¹åŒ…çš„å½¢å¼ä½œä¸ºä¸­é—´ä»¶å±‚éƒ¨ç½²åœ¨åº”ç”¨ç¨‹åºè¿™ä¸€ä¾§çš„ï¼Œä¸ä¾èµ–ä¸æ•°æ®åº“æœ¬èº«å¯¹åè®®çš„æ”¯æŒï¼Œå½“ç„¶ä¹Ÿä¸éœ€è¦æ•°æ®åº“æ”¯æŒ XA åè®®ã€‚è¿™ç‚¹å¯¹äºå¾®æœåŠ¡åŒ–çš„æ¶æ„æ¥è¯´æ˜¯éå¸¸é‡è¦çš„ï¼šåº”ç”¨å±‚ä¸éœ€è¦ä¸ºæœ¬åœ°äº‹åŠ¡å’Œåˆ†å¸ƒå¼äº‹åŠ¡ä¸¤ç±»ä¸åŒåœºæ™¯æ¥é€‚é…ä¸¤å¥—ä¸åŒçš„æ•°æ®åº“é©±åŠ¨ã€‚</p><p>è¿™ä¸ªè®¾è®¡ï¼Œå‰¥ç¦»äº†åˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆå¯¹æ•°æ®åº“åœ¨ <strong>åè®®æ”¯æŒ</strong> ä¸Šçš„è¦æ±‚ã€‚</p><h4 id="ä¸¤é˜¶æ®µæäº¤"><a href="#ä¸¤é˜¶æ®µæäº¤" class="headerlink" title="ä¸¤é˜¶æ®µæäº¤"></a>ä¸¤é˜¶æ®µæäº¤</h4><p>å…ˆæ¥çœ‹ä¸€ä¸‹ XA çš„ 2PC è¿‡ç¨‹ã€‚</p><p><img src="https://camo.githubusercontent.com/0dd08140485ce7f96a1fdbe110fc6bba4c6b6c43/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d366432646331333534633733313765382e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="XA-2PC"></p><p>æ— è®º Phase2 çš„å†³è®®æ˜¯ commit è¿˜æ˜¯ rollbackï¼Œäº‹åŠ¡æ€§èµ„æºçš„é”éƒ½è¦ä¿æŒåˆ° Phase2 å®Œæˆæ‰é‡Šæ”¾ã€‚</p><p>è®¾æƒ³ä¸€ä¸ªæ­£å¸¸è¿è¡Œçš„ä¸šåŠ¡ï¼Œå¤§æ¦‚ç‡æ˜¯ 90% ä»¥ä¸Šçš„äº‹åŠ¡æœ€ç»ˆåº”è¯¥æ˜¯æˆåŠŸæäº¤çš„ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥åœ¨ Phase1 å°±å°†æœ¬åœ°äº‹åŠ¡æäº¤å‘¢ï¼Ÿè¿™æ · 90% ä»¥ä¸Šçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥çœå» Phase2 æŒé”çš„æ—¶é—´ï¼Œæ•´ä½“æé«˜æ•ˆç‡ã€‚</p><p><img src="https://camo.githubusercontent.com/07b2c490f327b408b4e0d42307f283ebea11d1a5/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d323366333736626564613339663831622e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="FESCAR-2PC"></p><p>è¿™ä¸ªè®¾è®¡ï¼Œåœ¨ç»å¤§å¤šæ•°åœºæ™¯å‡å°‘äº†äº‹åŠ¡æŒé”æ—¶é—´ï¼Œä»è€Œæé«˜äº†äº‹åŠ¡çš„å¹¶å‘åº¦ã€‚</p><p>å½“ç„¶ï¼Œä½ è‚¯å®šä¼šé—®ï¼šPhase1 å³æäº¤çš„æƒ…å†µä¸‹ï¼ŒPhase2 å¦‚ä½•å›æ»šå‘¢ï¼Ÿ</p><h2 id="3-3-åˆ†æ”¯äº‹åŠ¡å¦‚ä½•æäº¤å’Œå›æ»šï¼Ÿ"><a href="#3-3-åˆ†æ”¯äº‹åŠ¡å¦‚ä½•æäº¤å’Œå›æ»šï¼Ÿ" class="headerlink" title="3.3 åˆ†æ”¯äº‹åŠ¡å¦‚ä½•æäº¤å’Œå›æ»šï¼Ÿ"></a>3.3 åˆ†æ”¯äº‹åŠ¡å¦‚ä½•æäº¤å’Œå›æ»šï¼Ÿ</h2><p>é¦–å…ˆï¼Œåº”ç”¨éœ€è¦ä½¿ç”¨ Fescar çš„ JDBC æ•°æ®æºä»£ç†ï¼Œä¹Ÿå°±æ˜¯ Fescar çš„ RMã€‚</p><p><img src="https://camo.githubusercontent.com/f1f712e272a137ac0143e53370ec9267a50e18d0/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d653831326264663865366565386234612e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Data Source Proxy"></p><p><strong>Phase1ï¼š</strong></p><p>Fescar çš„ JDBC æ•°æ®æºä»£ç†é€šè¿‡å¯¹ä¸šåŠ¡ SQL çš„è§£æï¼ŒæŠŠä¸šåŠ¡æ•°æ®åœ¨æ›´æ–°å‰åçš„æ•°æ®é•œåƒç»„ç»‡æˆå›æ»šæ—¥å¿—ï¼Œåˆ©ç”¨ <strong>æœ¬åœ°äº‹åŠ¡</strong> çš„ ACID ç‰¹æ€§ï¼Œå°†ä¸šåŠ¡æ•°æ®çš„æ›´æ–°å’Œå›æ»šæ—¥å¿—çš„å†™å…¥åœ¨åŒä¸€ä¸ª <strong>æœ¬åœ°äº‹åŠ¡</strong> ä¸­æäº¤ã€‚</p><p>è¿™æ ·ï¼Œå¯ä»¥ä¿è¯ï¼šä»»ä½•æäº¤çš„ä¸šåŠ¡æ•°æ®çš„æ›´æ–°ä¸€å®šæœ‰ç›¸åº”çš„å›æ»šæ—¥å¿—å­˜åœ¨ã€‚</p><p><img src="https://camo.githubusercontent.com/0aab5607fd0c3c95ba207f90543dae87a3284578/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d333766653436616337303537336366652e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Branch Transaction with UNDO LOG"></p><p>åŸºäºè¿™æ ·çš„æœºåˆ¶ï¼Œåˆ†æ”¯çš„æœ¬åœ°äº‹åŠ¡ä¾¿å¯ä»¥åœ¨å…¨å±€äº‹åŠ¡çš„ Phase1 æäº¤ï¼Œé©¬ä¸Šé‡Šæ”¾æœ¬åœ°äº‹åŠ¡é”å®šçš„èµ„æºã€‚</p><p><strong>Phase2ï¼š</strong></p><ul><li>å¦‚æœå†³è®®æ˜¯å…¨å±€æäº¤ï¼Œæ­¤æ—¶åˆ†æ”¯äº‹åŠ¡æ­¤æ—¶å·²ç»å®Œæˆæäº¤ï¼Œä¸éœ€è¦åŒæ­¥åè°ƒå¤„ç†ï¼ˆåªéœ€è¦å¼‚æ­¥æ¸…ç†å›æ»šæ—¥å¿—ï¼‰ï¼ŒPhase2 å¯ä»¥éå¸¸å¿«é€Ÿåœ°å®Œæˆã€‚</li></ul><p><img src="https://camo.githubusercontent.com/c92b7676f4b0188b27ba5b42e25b54dfc57f94c9/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d316337613635626131636463656235662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Global Commit"></p><ul><li>å¦‚æœå†³è®®æ˜¯å…¨å±€å›æ»šï¼ŒRM æ”¶åˆ°åè°ƒå™¨å‘æ¥çš„å›æ»šè¯·æ±‚ï¼Œé€šè¿‡ XID å’Œ Branch ID æ‰¾åˆ°ç›¸åº”çš„å›æ»šæ—¥å¿—è®°å½•ï¼Œé€šè¿‡å›æ»šè®°å½•ç”Ÿæˆåå‘çš„æ›´æ–° SQL å¹¶æ‰§è¡Œï¼Œä»¥å®Œæˆåˆ†æ”¯çš„å›æ»šã€‚</li></ul><p><img src="https://camo.githubusercontent.com/494bc077ecf4c0209f27d03aa29dc633e575cf62/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d363237626166616639326331333030352e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Global Rollback"></p><h2 id="3-4-äº‹åŠ¡ä¼ æ’­æœºåˆ¶"><a href="#3-4-äº‹åŠ¡ä¼ æ’­æœºåˆ¶" class="headerlink" title="3.4 äº‹åŠ¡ä¼ æ’­æœºåˆ¶"></a>3.4 äº‹åŠ¡ä¼ æ’­æœºåˆ¶</h2><p>XID æ˜¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡çš„å”¯ä¸€æ ‡è¯†ï¼Œäº‹åŠ¡ä¼ æ’­æœºåˆ¶è¦åšçš„å°±æ˜¯æŠŠ XID åœ¨æœåŠ¡è°ƒç”¨é“¾è·¯ä¸­ä¼ é€’ä¸‹å»ï¼Œå¹¶ç»‘å®šåˆ°æœåŠ¡çš„äº‹åŠ¡ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™æ ·ï¼ŒæœåŠ¡é“¾è·¯ä¸­çš„æ•°æ®åº“æ›´æ–°æ“ä½œï¼Œå°±éƒ½ä¼šå‘è¯¥ XID ä»£è¡¨çš„å…¨å±€äº‹åŠ¡æ³¨å†Œåˆ†æ”¯ï¼Œçº³å…¥åŒä¸€ä¸ªå…¨å±€äº‹åŠ¡çš„ç®¡è¾–ã€‚</p><p>åŸºäºè¿™ä¸ªæœºåˆ¶ï¼ŒFescar æ˜¯å¯ä»¥æ”¯æŒä»»ä½•å¾®æœåŠ¡ RPC æ¡†æ¶çš„ã€‚åªè¦åœ¨ç‰¹å®šæ¡†æ¶ä¸­æ‰¾åˆ°å¯ä»¥é€æ˜ä¼ æ’­ XID çš„æœºåˆ¶å³å¯ï¼Œæ¯”å¦‚ï¼ŒDubbo çš„ Filter + RpcContextã€‚</p><p>å¯¹åº”åˆ° Java EE è§„èŒƒå’Œ Spring å®šä¹‰çš„äº‹åŠ¡ä¼ æ’­å±æ€§ï¼ŒFescar çš„æ”¯æŒå¦‚ä¸‹ï¼š</p><ul><li><strong>PROPAGATION_REQUIREDï¼š</strong> é»˜è®¤æ”¯æŒ</li><li><strong>PROPAGATION_SUPPORTSï¼š</strong> é»˜è®¤æ”¯æŒ</li><li>PROPAGATION_MANDATORYï¼šåº”ç”¨é€šè¿‡ API æ¥å®ç°</li><li>PROPAGATION_REQUIRES_NEWï¼šåº”ç”¨é€šè¿‡ API æ¥å®ç°</li><li>PROPAGATION_NOT_SUPPORTEDï¼šåº”ç”¨é€šè¿‡ API æ¥å®ç°</li><li>PROPAGATION_NEVERï¼šåº”ç”¨é€šè¿‡ API æ¥å®ç°</li><li>PROPAGATION_REQUIRED_NESTEDï¼šä¸æ”¯æŒ</li></ul><h2 id="3-5-éš”ç¦»æ€§"><a href="#3-5-éš”ç¦»æ€§" class="headerlink" title="3.5 éš”ç¦»æ€§"></a>3.5 éš”ç¦»æ€§</h2><p>å…¨å±€äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯å»ºç«‹åœ¨åˆ†æ”¯äº‹åŠ¡çš„æœ¬åœ°éš”ç¦»çº§åˆ«åŸºç¡€ä¹‹ä¸Šçš„ã€‚</p><p>åœ¨æ•°æ®åº“æœ¬åœ°éš”ç¦»çº§åˆ« <strong>è¯»å·²æäº¤</strong> æˆ–ä»¥ä¸Šçš„å‰æä¸‹ï¼ŒFescar è®¾è®¡äº†ç”±äº‹åŠ¡åè°ƒå™¨ç»´æŠ¤çš„ <strong>å…¨å±€å†™æ’ä»–é”</strong>ï¼Œæ¥ä¿è¯äº‹åŠ¡é—´çš„ <strong>å†™éš”ç¦»</strong>ï¼Œå°†å…¨å±€äº‹åŠ¡é»˜è®¤å®šä¹‰åœ¨ <strong>è¯»æœªæäº¤</strong> çš„éš”ç¦»çº§åˆ«ä¸Šã€‚</p><p>æˆ‘ä»¬å¯¹éš”ç¦»çº§åˆ«çš„å…±è¯†æ˜¯ï¼šç»å¤§éƒ¨åˆ†åº”ç”¨åœ¨ <strong>è¯»å·²æäº¤</strong> çš„éš”ç¦»çº§åˆ«ä¸‹å·¥ä½œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚è€Œå®é™…ä¸Šï¼Œè¿™å½“ä¸­åˆæœ‰ç»å¤§å¤šæ•°çš„åº”ç”¨åœºæ™¯ï¼Œå®é™…ä¸Šå·¥ä½œåœ¨ <strong>è¯»æœªæäº¤</strong> çš„éš”ç¦»çº§åˆ«ä¸‹åŒæ ·æ²¡æœ‰é—®é¢˜ã€‚</p><p>åœ¨æç«¯åœºæ™¯ä¸‹ï¼Œåº”ç”¨å¦‚æœéœ€è¦è¾¾åˆ°å…¨å±€çš„ <strong>è¯»å·²æäº¤</strong>ï¼ŒFescar ä¹Ÿæä¾›äº†ç›¸åº”çš„æœºåˆ¶æ¥è¾¾åˆ°ç›®çš„ã€‚é»˜è®¤ï¼ŒFescar æ˜¯å·¥ä½œåœ¨ <strong>è¯»æ— æäº¤</strong> çš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¿è¯ç»å¤§å¤šæ•°åœºæ™¯çš„é«˜æ•ˆæ€§ã€‚</p><p><img src="https://camo.githubusercontent.com/8add2045578efd41537368d0d435d1924bae4a48/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d633331393838636134646165633264642e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Isolation"></p><p>äº‹åŠ¡çš„ ACID å±æ€§åœ¨ Fescar ä¸­çš„ä½“ç°æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„è¯é¢˜ï¼Œæˆ‘ä»¬ä¼šæœ‰ä¸“é—¨çš„æ–‡ç« æ¥æ·±å…¥åˆ†æï¼Œè¿™é‡Œä¸åšè¿›ä¸€æ­¥å±•å¼€ã€‚</p><h1 id="4-é€‚ç”¨åœºæ™¯åˆ†æ"><a href="#4-é€‚ç”¨åœºæ™¯åˆ†æ" class="headerlink" title="4. é€‚ç”¨åœºæ™¯åˆ†æ"></a>4. é€‚ç”¨åœºæ™¯åˆ†æ</h1><p>å‰æ–‡æ‰€è¿°çš„ Fescar çš„æ ¸å¿ƒåŸç†ä¸­æœ‰ä¸€ä¸ª <strong>é‡è¦å‰æ</strong>ï¼šåˆ†æ”¯äº‹åŠ¡ä¸­æ¶‰åŠçš„èµ„æºï¼Œ<strong>å¿…é¡»</strong> æ˜¯æ”¯æŒ <strong>ACID äº‹åŠ¡</strong>çš„ <strong>å…³ç³»å‹æ•°æ®åº“</strong>ã€‚åˆ†æ”¯çš„æäº¤å’Œå›æ»šæœºåˆ¶ï¼Œéƒ½ä¾èµ–äºæœ¬åœ°äº‹åŠ¡çš„ä¿éšœã€‚æ‰€ä»¥ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨çš„æ•°æ®åº“æ˜¯ä¸æ”¯æŒäº‹åŠ¡çš„ï¼Œæˆ–æ ¹æœ¬ä¸æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼Œå°±ä¸é€‚ç”¨ã€‚</p><p>å¦å¤–ï¼Œç›®å‰ Fescar çš„å®ç°è¿˜å­˜åœ¨ä¸€äº›å±€é™ï¼Œæ¯”å¦‚ï¼šäº‹åŠ¡éš”ç¦»çº§åˆ«æœ€é«˜æ”¯æŒåˆ° <strong>è¯»å·²æäº¤</strong> çš„æ°´å¹³ï¼ŒSQL çš„è§£æè¿˜ä¸èƒ½æ¶µç›–å…¨éƒ¨çš„è¯­æ³•ç­‰ã€‚</p><p>ä¸ºäº†è¦†ç›– Fescar åŸç”Ÿæœºåˆ¶æš‚æ—¶ä¸èƒ½æ”¯æŒåº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬å®šä¹‰äº†å¦å¤–ä¸€ç§å·¥ä½œæ¨¡å¼ã€‚</p><p>ä¸Šé¢ä»‹ç»çš„ Fescar åŸç”Ÿå·¥ä½œæ¨¡å¼ç§°ä¸º ATï¼ˆAutomatic Transactionï¼‰æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯å¯¹ä¸šåŠ¡æ— ä¾µå…¥çš„ã€‚ä¸ä¹‹ç›¸åº”çš„å¦å¤–ä¸€ç§å·¥ä½œæ¨¡å¼ç§°ä¸º MTï¼ˆManual Transactionï¼‰æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼ä¸‹ï¼Œåˆ†æ”¯äº‹åŠ¡éœ€è¦åº”ç”¨è‡ªå·±æ¥å®šä¹‰ä¸šåŠ¡æœ¬èº«åŠæäº¤å’Œå›æ»šçš„é€»è¾‘ã€‚</p><h2 id="4-1-åˆ†æ”¯çš„åŸºæœ¬è¡Œä¸ºæ¨¡å¼"><a href="#4-1-åˆ†æ”¯çš„åŸºæœ¬è¡Œä¸ºæ¨¡å¼" class="headerlink" title="4.1 åˆ†æ”¯çš„åŸºæœ¬è¡Œä¸ºæ¨¡å¼"></a>4.1 åˆ†æ”¯çš„åŸºæœ¬è¡Œä¸ºæ¨¡å¼</h2><p>ä½œä¸ºå…¨å±€äº‹åŠ¡ä¸€éƒ¨åˆ†çš„åˆ†æ”¯äº‹åŠ¡ï¼Œé™¤æœ¬èº«çš„ä¸šåŠ¡é€»è¾‘å¤–ï¼Œéƒ½åŒ…å« 4 ä¸ªä¸åè°ƒå™¨äº¤äº’çš„è¡Œä¸ºï¼š</p><ul><li><strong>åˆ†æ”¯æ³¨å†Œï¼š</strong> åœ¨åˆ†æ”¯äº‹åŠ¡çš„æ•°æ®æ“ä½œè¿›è¡Œä¹‹å‰ï¼Œéœ€è¦å‘åè°ƒå™¨æ³¨å†Œï¼ŒæŠŠå³å°†è¿›è¡Œçš„åˆ†æ”¯äº‹åŠ¡æ•°æ®æ“ä½œï¼Œçº³å…¥ä¸€ä¸ªå·²ç»å¼€å¯çš„å…¨å±€äº‹åŠ¡çš„ç®¡ç†ä¸­å»ï¼Œåœ¨åˆ†æ”¯æ³¨å†ŒæˆåŠŸåï¼Œæ‰å¯ä»¥è¿›è¡Œæ•°æ®æ“ä½œã€‚</li><li><strong>çŠ¶æ€ä¸ŠæŠ¥ï¼š</strong> åœ¨åˆ†æ”¯äº‹åŠ¡çš„æ•°æ®æ“ä½œå®Œæˆåï¼Œéœ€è¦å‘äº‹åŠ¡åè°ƒå™¨ä¸ŠæŠ¥å…¶æ‰§è¡Œç»“æœã€‚</li><li><strong>åˆ†æ”¯æäº¤</strong>ï¼šå“åº”åè°ƒå™¨å‘å‡ºçš„åˆ†æ”¯äº‹åŠ¡æäº¤çš„è¯·æ±‚ï¼Œå®Œæˆåˆ†æ”¯æäº¤ã€‚</li><li><strong>åˆ†æ”¯å›æ»š</strong>ï¼šå“åº”åè°ƒå™¨å‘å‡ºçš„åˆ†æ”¯äº‹åŠ¡å›æ»šçš„è¯·æ±‚ï¼Œå®Œæˆåˆ†æ”¯å›æ»šã€‚</li></ul><p><img src="https://camo.githubusercontent.com/d17e9b1999b3e2a30e47b69286f630818515f447/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d646534656264326539363763613634312e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="How does RM talk to TC"></p><h2 id="4-2-AT-æ¨¡å¼åˆ†æ”¯çš„è¡Œä¸ºæ¨¡å¼"><a href="#4-2-AT-æ¨¡å¼åˆ†æ”¯çš„è¡Œä¸ºæ¨¡å¼" class="headerlink" title="4.2 AT æ¨¡å¼åˆ†æ”¯çš„è¡Œä¸ºæ¨¡å¼"></a>4.2 AT æ¨¡å¼åˆ†æ”¯çš„è¡Œä¸ºæ¨¡å¼</h2><p>ä¸šåŠ¡é€»è¾‘ä¸éœ€è¦å…³æ³¨äº‹åŠ¡æœºåˆ¶ï¼Œåˆ†æ”¯ä¸å…¨å±€äº‹åŠ¡çš„äº¤äº’è¿‡ç¨‹è‡ªåŠ¨è¿›è¡Œã€‚</p><p><img src="https://camo.githubusercontent.com/74880f23bf1acf617a57acff5bd964ca217408a7/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d393365353238666566663530323539372e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="AT branch"></p><h2 id="4-3-MT-æ¨¡å¼åˆ†æ”¯çš„è¡Œä¸ºæ¨¡å¼"><a href="#4-3-MT-æ¨¡å¼åˆ†æ”¯çš„è¡Œä¸ºæ¨¡å¼" class="headerlink" title="4.3 MT æ¨¡å¼åˆ†æ”¯çš„è¡Œä¸ºæ¨¡å¼"></a>4.3 MT æ¨¡å¼åˆ†æ”¯çš„è¡Œä¸ºæ¨¡å¼</h2><p>ä¸šåŠ¡é€»è¾‘éœ€è¦è¢«åˆ†è§£ä¸º Prepare/Commit/Rollback 3 éƒ¨åˆ†ï¼Œå½¢æˆä¸€ä¸ª MT åˆ†æ”¯ï¼ŒåŠ å…¥å…¨å±€äº‹åŠ¡ã€‚</p><p><img src="https://camo.githubusercontent.com/b74856bebe85d2a03e5c63f8bcca3f318cb224af/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d376434646532303535353861333562322e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="MT branch"></p><p>MT æ¨¡å¼ä¸€æ–¹é¢æ˜¯ AT æ¨¡å¼çš„è¡¥å……ã€‚å¦å¤–ï¼Œæ›´é‡è¦çš„ä»·å€¼åœ¨äºï¼Œé€šè¿‡ MT æ¨¡å¼å¯ä»¥æŠŠä¼—å¤šéäº‹åŠ¡æ€§èµ„æºçº³å…¥å…¨å±€äº‹åŠ¡çš„ç®¡ç†ä¸­ã€‚</p><h2 id="4-4-æ··åˆæ¨¡å¼"><a href="#4-4-æ··åˆæ¨¡å¼" class="headerlink" title="4.4 æ··åˆæ¨¡å¼"></a>4.4 æ··åˆæ¨¡å¼</h2><p>å› ä¸º AT å’Œ MT æ¨¡å¼çš„åˆ†æ”¯ä»æ ¹æœ¬ä¸Šè¡Œä¸ºæ¨¡å¼æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥å¯ä»¥å®Œå…¨å…¼å®¹ï¼Œå³ï¼Œä¸€ä¸ªå…¨å±€äº‹åŠ¡ä¸­ï¼Œå¯ä»¥åŒæ—¶å­˜åœ¨ AT å’Œ MT çš„åˆ†æ”¯ã€‚è¿™æ ·å°±å¯ä»¥è¾¾åˆ°å…¨é¢è¦†ç›–ä¸šåŠ¡åœºæ™¯çš„ç›®çš„ï¼šAT æ¨¡å¼å¯ä»¥æ”¯æŒçš„ï¼Œä½¿ç”¨ AT æ¨¡å¼ï¼›AT æ¨¡å¼æš‚æ—¶æ”¯æŒä¸äº†çš„ï¼Œç”¨ MT æ¨¡å¼æ¥æ›¿ä»£ã€‚å¦å¤–ï¼Œè‡ªç„¶çš„ï¼ŒMT æ¨¡å¼ç®¡ç†çš„éäº‹åŠ¡æ€§èµ„æºä¹Ÿå¯ä»¥å’Œæ”¯æŒäº‹åŠ¡çš„å…³ç³»å‹æ•°æ®åº“èµ„æºä¸€èµ·ï¼Œçº³å…¥åŒä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„ç®¡ç†ä¸­ã€‚</p><h2 id="4-5-åº”ç”¨åœºæ™¯çš„è¿œæ™¯"><a href="#4-5-åº”ç”¨åœºæ™¯çš„è¿œæ™¯" class="headerlink" title="4.5 åº”ç”¨åœºæ™¯çš„è¿œæ™¯"></a>4.5 åº”ç”¨åœºæ™¯çš„è¿œæ™¯</h2><p>å›åˆ°æˆ‘ä»¬è®¾è®¡çš„åˆè¡·ï¼šä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆæ˜¯ä¸åº”è¯¥ä¾µå…¥ä¸šåŠ¡çš„ã€‚MT æ¨¡å¼æ˜¯åœ¨ AT æ¨¡å¼æš‚æ—¶ä¸èƒ½å®Œå…¨è¦†ç›–æ‰€æœ‰åœºæ™¯çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ¯”è¾ƒè‡ªç„¶çš„è¡¥å……æ–¹æ¡ˆã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡ AT æ¨¡å¼çš„ä¸æ–­æ¼”è¿›å¢å¼ºï¼Œé€æ­¥æ‰©å¤§æ‰€æ”¯æŒçš„åœºæ™¯ï¼ŒMT æ¨¡å¼é€æ­¥æ”¶æ•›ã€‚æœªæ¥ï¼Œæˆ‘ä»¬ä¼šçº³å…¥å¯¹ XA çš„åŸç”Ÿæ”¯æŒï¼Œç”¨ XA è¿™ç§æ— ä¾µå…¥çš„æ–¹å¼æ¥è¦†ç›– AT æ¨¡å¼æ— æ³•è§¦è¾¾çš„åœºæ™¯ã€‚</p><p><img src="https://camo.githubusercontent.com/21d80b35eceb50eeb047cb4818796e26e30dd5b0/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d373034363263643330396531306635612e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Roadmap of transaction mode"></p><h1 id="5-æ‰©å±•ç‚¹"><a href="#5-æ‰©å±•ç‚¹" class="headerlink" title="5. æ‰©å±•ç‚¹"></a>5. æ‰©å±•ç‚¹</h1><h2 id="5-1-å¾®æœåŠ¡æ¡†æ¶çš„æ”¯æŒ"><a href="#5-1-å¾®æœåŠ¡æ¡†æ¶çš„æ”¯æŒ" class="headerlink" title="5.1 å¾®æœåŠ¡æ¡†æ¶çš„æ”¯æŒ"></a>5.1 å¾®æœåŠ¡æ¡†æ¶çš„æ”¯æŒ</h2><p>äº‹åŠ¡ä¸Šä¸‹æ–‡åœ¨å¾®æœåŠ¡é—´çš„ä¼ æ’­éœ€è¦æ ¹æ®å¾®æœåŠ¡æ¡†æ¶æœ¬èº«çš„æœºåˆ¶ï¼Œè®¢åˆ¶æœ€ä¼˜çš„ï¼Œå¯¹åº”ç”¨å±‚é€æ˜çš„è§£å†³æ–¹æ¡ˆã€‚æœ‰å…´è¶£åœ¨è¿™æ–¹é¢å…±å»ºçš„å¼€å‘è€…å¯ä»¥å‚è€ƒå†…ç½®çš„å¯¹ Dubbo çš„æ”¯æŒæ–¹æ¡ˆï¼Œæ¥å®ç°å¯¹å…¶ä»–å¾®æœåŠ¡æ¡†æ¶çš„æ”¯æŒã€‚</p><h2 id="5-2-æ‰€æ”¯æŒçš„æ•°æ®åº“ç±»å‹"><a href="#5-2-æ‰€æ”¯æŒçš„æ•°æ®åº“ç±»å‹" class="headerlink" title="5.2 æ‰€æ”¯æŒçš„æ•°æ®åº“ç±»å‹"></a>5.2 æ‰€æ”¯æŒçš„æ•°æ®åº“ç±»å‹</h2><p>å› ä¸º AT æ¶‰åŠ SQL çš„è§£æï¼Œæ‰€ä»¥åœ¨ä¸åŒç±»å‹çš„æ•°æ®åº“ä¸Šå·¥ä½œï¼Œä¼šæœ‰ä¸€äº›ç‰¹å®šçš„é€‚é…ã€‚æœ‰å…´è¶£åœ¨è¿™æ–¹é¢å…±å»ºçš„å¼€å‘è€…å¯ä»¥å‚è€ƒå†…ç½®çš„å¯¹ MySQL çš„æ”¯æŒæ–¹æ¡ˆï¼Œæ¥å®ç°å¯¹å…¶ä»–æ•°æ®åº“çš„æ”¯æŒã€‚</p><h2 id="5-3-é…ç½®å’ŒæœåŠ¡æ³¨å†Œå‘ç°"><a href="#5-3-é…ç½®å’ŒæœåŠ¡æ³¨å†Œå‘ç°" class="headerlink" title="5.3 é…ç½®å’ŒæœåŠ¡æ³¨å†Œå‘ç°"></a>5.3 é…ç½®å’ŒæœåŠ¡æ³¨å†Œå‘ç°</h2><p>æ”¯æŒæ¥å…¥ä¸åŒçš„é…ç½®å’ŒæœåŠ¡æ³¨å†Œå‘ç°è§£å†³æ–¹æ¡ˆã€‚æ¯”å¦‚ï¼šNacosã€Eurekaã€ZooKeeper ç­‰ã€‚</p><h2 id="5-4-MT-æ¨¡å¼çš„åœºæ™¯æ‹“å±•"><a href="#5-4-MT-æ¨¡å¼çš„åœºæ™¯æ‹“å±•" class="headerlink" title="5.4 MT æ¨¡å¼çš„åœºæ™¯æ‹“å±•"></a>5.4 MT æ¨¡å¼çš„åœºæ™¯æ‹“å±•</h2><p>MT æ¨¡å¼çš„ä¸€ä¸ªé‡è¦ä½œç”¨å°±æ˜¯ï¼Œå¯ä»¥æŠŠéå…³ç³»å‹æ•°æ®åº“çš„èµ„æºï¼Œé€šè¿‡ MT æ¨¡å¼åˆ†æ”¯çš„åŒ…è£…ï¼Œçº³å…¥åˆ°å…¨å±€äº‹åŠ¡çš„ç®¡è¾–ä¸­æ¥ã€‚æ¯”å¦‚ï¼ŒRedisã€HBaseã€RocketMQ çš„äº‹åŠ¡æ¶ˆæ¯ç­‰ã€‚æœ‰å…´è¶£åœ¨è¿™æ–¹é¢å…±å»ºçš„å¼€å‘è€…å¯ä»¥åœ¨è¿™é‡Œè´¡çŒ®ä¸€ç³»åˆ—ç›¸å…³ç”Ÿæ€çš„é€‚é…æ–¹æ¡ˆã€‚</p><h2 id="5-5-äº‹åŠ¡åè°ƒå™¨çš„åˆ†å¸ƒå¼é«˜å¯ç”¨æ–¹æ¡ˆ"><a href="#5-5-äº‹åŠ¡åè°ƒå™¨çš„åˆ†å¸ƒå¼é«˜å¯ç”¨æ–¹æ¡ˆ" class="headerlink" title="5.5 äº‹åŠ¡åè°ƒå™¨çš„åˆ†å¸ƒå¼é«˜å¯ç”¨æ–¹æ¡ˆ"></a>5.5 äº‹åŠ¡åè°ƒå™¨çš„åˆ†å¸ƒå¼é«˜å¯ç”¨æ–¹æ¡ˆ</h2><p>é’ˆå¯¹ä¸åŒåœºæ™¯ï¼Œæ”¯æŒä¸åŒçš„æ–¹å¼ä½œä¸ºäº‹åŠ¡åè°ƒå™¨ Server ç«¯çš„é«˜å¯ç”¨æ–¹æ¡ˆã€‚æ¯”å¦‚ï¼Œé’ˆå¯¹äº‹åŠ¡çŠ¶æ€çš„æŒä¹…åŒ–ï¼Œå¯ä»¥æ˜¯åŸºäºæ–‡ä»¶çš„å®ç°æ–¹æ¡ˆï¼Œä¹Ÿå¯ä»¥æ˜¯åŸºäºæ•°æ®åº“çš„å®ç°æ–¹æ¡ˆï¼›é›†ç¾¤é—´çš„çŠ¶æ€åŒæ­¥ï¼Œå¯ä»¥æ˜¯åŸºäº RPC é€šä¿¡çš„æ–¹æ¡ˆï¼Œä¹Ÿå¯ä»¥æ˜¯åŸºäºé«˜å¯ç”¨ KV å­˜å‚¨çš„æ–¹æ¡ˆã€‚</p><h1 id="6-Roadmap"><a href="#6-Roadmap" class="headerlink" title="6. Roadmap"></a>6. Roadmap</h1><h2 id="è“å›¾"><a href="#è“å›¾" class="headerlink" title="è“å›¾"></a>è“å›¾</h2><p><img src="https://camo.githubusercontent.com/510e5b9eff39af2d740bc27f42b8b99b08b7ce0f/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343432303736372d393530306563626439613661383635622e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="Landscape"></p><p><strong>ç»¿è‰²</strong> éƒ¨åˆ†æ˜¯å·²ç»å¼€æºå‘å¸ƒå‡ºæ¥çš„ï¼Œ<strong>é»„è‰²</strong> éƒ¨åˆ†æ˜¯å°†åœ¨åç»­ç‰ˆæœ¬ä¸­ç”±é˜¿é‡Œå‘å¸ƒå‡ºæ¥çš„ï¼Œ<strong>è“è‰²</strong> éƒ¨åˆ†æ˜¯æˆ‘ä»¬å’Œç¤¾åŒºå…±å»ºç”Ÿæ€éƒ¨åˆ†ï¼š</p><ul><li>å¯¹ä¸åŒæ•°æ®åº“çš„æ”¯æŒï¼Œå¼€å‘è€…å¯ä»¥å‚è€ƒ MySQL çš„å®ç°ã€‚</li><li>å¯¹ä¸åŒå¾®æœåŠ¡æ¡†æ¶çš„æ”¯æŒï¼Œå¼€å‘è€…å¯ä»¥å‚è€ƒ Dubbo çš„å®ç°ã€‚</li><li>å¯¹ MQã€NoSQL çš„æ”¯æŒï¼Œå¼€å‘è€…å¯ä»¥å‚è€ƒ TCC çš„å®ç°ã€‚</li><li>é…ç½®å’ŒæœåŠ¡æ³¨å†Œå‘ç°ï¼šå¼€å‘è€…é€šè¿‡å°‘é‡çš„å·¥ä½œå¯ä»¥æ¥å…¥ä»»ä½•å¯ä»¥æä¾›è¿™ç±»æœåŠ¡çš„æ¡†æ¶ã€‚</li><li>å½“ç„¶ï¼Œé <strong>è“è‰²</strong> çš„éƒ¨åˆ†ä¹Ÿéå¸¸æ¬¢è¿ç¤¾åŒºå‚ä¸è¿›æ¥ï¼Œè´¡çŒ®æ›´ä¼˜çš„è§£å†³æ–¹æ¡ˆã€‚</li><li>å¦å¤–ï¼ŒXA ä½œä¸ºåˆ†å¸ƒå¼äº‹åŠ¡çš„æ ‡å‡†ï¼Œæ˜¯ä¸€ä¸ªå®Œå¤‡çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆä¸å¯æˆ–ç¼ºçš„ï¼Œè¿œæ™¯çš„è§„åˆ’ä¸­ï¼Œæˆ‘ä»¬ä¸€å®šéœ€è¦æŠŠ XA çš„æ”¯æŒåŠ å…¥è¿›æ¥ã€‚</li></ul><h2 id="åˆæ­¥çš„ç‰ˆæœ¬è§„åˆ’"><a href="#åˆæ­¥çš„ç‰ˆæœ¬è§„åˆ’" class="headerlink" title="åˆæ­¥çš„ç‰ˆæœ¬è§„åˆ’"></a>åˆæ­¥çš„ç‰ˆæœ¬è§„åˆ’</h2><h3 id="v0-1-0"><a href="#v0-1-0" class="headerlink" title="v0.1.0"></a>v0.1.0</h3><ul><li>å¾®æœåŠ¡æ¡†æ¶æ”¯æŒ: Dubbo</li><li>æ•°æ®åº“æ”¯æŒ: MySQL</li><li>åŸºäº Spring AOP çš„ Annotation</li><li>äº‹åŠ¡åè°ƒå™¨: å•æœºç‰ˆæœ¬</li></ul><h3 id="v0-5-x"><a href="#v0-5-x" class="headerlink" title="v0.5.x"></a>v0.5.x</h3><ul><li>å¾®æœåŠ¡æ¡†æ¶æ”¯æŒ: Spring Cloud</li><li>MT æ¨¡å¼</li><li>æ”¯æŒ TCC æ¨¡å¼äº‹åŠ¡çš„é€‚é…</li><li>åŠ¨æ€é…ç½®å’ŒæœåŠ¡å‘ç°</li><li>äº‹åŠ¡åè°ƒå™¨: é«˜å¯ç”¨é›†ç¾¤ç‰ˆæœ¬</li></ul><h3 id="v0-8-x"><a href="#v0-8-x" class="headerlink" title="v0.8.x"></a>v0.8.x</h3><ul><li>Metrics</li><li>æ§åˆ¶å°: ç›‘æ§/éƒ¨ç½²/å‡çº§/æ‰©ç¼©å®¹</li></ul><h3 id="v1-0-0"><a href="#v1-0-0" class="headerlink" title="v1.0.0"></a>v1.0.0</h3><ul><li>General Availability: ç”Ÿäº§ç¯å¢ƒé€‚ç”¨</li></ul><h3 id="v1-5-x"><a href="#v1-5-x" class="headerlink" title="v1.5.x"></a>v1.5.x</h3><ul><li>æ•°æ®åº“æ”¯æŒ: Oracle/PostgreSQL/OceanBase</li><li>ä¸ä¾èµ– Spring AOP çš„ Annotation</li><li>çƒ­ç‚¹æ•°æ®çš„ä¼˜åŒ–å¤„ç†æœºåˆ¶</li><li>RocketMQ äº‹åŠ¡æ¶ˆæ¯çº³å…¥å…¨å±€äº‹åŠ¡ç®¡ç†</li><li>NoSQL çº³å…¥å…¨å±€äº‹åŠ¡ç®¡ç†çš„é€‚é…æœºåˆ¶</li><li>æ”¯æŒ HBase</li><li>æ”¯æŒ Redis</li></ul><h3 id="v2-0-0"><a href="#v2-0-0" class="headerlink" title="v2.0.0"></a>v2.0.0</h3><ul><li>æ”¯æŒ XA</li></ul><p>å½“ç„¶ï¼Œé¡¹ç›®è¿­ä»£æ¼”è¿›çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬æœ€é‡è§†çš„æ˜¯ç¤¾åŒºçš„å£°éŸ³ï¼Œè·¯çº¿å›¾ä¼šå’Œç¤¾åŒºå……åˆ†äº¤æµåŠæ—¶è¿›è¡Œè°ƒæ•´ã€‚</p><h1 id="7-ç›¸å…³é“¾æ¥"><a href="#7-ç›¸å…³é“¾æ¥" class="headerlink" title="7. ç›¸å…³é“¾æ¥"></a>7. ç›¸å…³é“¾æ¥</h1><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FsaWJhYmEvZmVzY2Fy" title="https://github.com/alibaba/fescar">FESCAR on GitHub<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9oZWxwLmFsaXl1bi5jb20vcHJvZHVjdC80ODQ0NC5odG1sP3NwbT01MTc2LmRvYzU1NTQ3LjMuMS5HZzFoY3M=" title="https://help.aliyun.com/product/48444.html?spm=5176.doc55547.3.1.Gg1hcs">GTS on Aliyun<i class="fa fa-external-link"></i></span></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¶ç„¶é—´çœ‹åˆ°é˜¿é‡Œå¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡ä¸­é—´ä»¶ï¼ŒæœŸå¾…æœ‰æŠ•å…¥åˆ°ç”Ÿäº§é˜¶æ®µçš„æ —å­ã€‚ä»è“å›¾ä¸Šçœ‹å‡ºç›®å‰æœ‰æ”¯æŒdubboçš„è§£å†³æ–¹æ¡ˆï¼Œåç»­0.5.xç‰ˆæœ¬ä¼šæ¨å‡ºæ”¯æŒspring cloudçš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çœ‹å®˜æ–¹æ­£æ–‡ï¼Œå–œæ¬¢çš„å¯ä»¥å»å®˜æ–¹Githubä¸Šç§ç§çœ‹çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;Fescar æ˜¯ &lt;strong&gt;é˜¿é‡Œå·´å·´&lt;/strong&gt; å¼€æºçš„ &lt;strong&gt;åˆ†å¸ƒå¼äº‹åŠ¡&lt;/strong&gt;ä¸­é—´ä»¶ï¼Œä»¥ &lt;strong&gt;é«˜æ•ˆ&lt;/strong&gt; å¹¶ä¸”å¯¹ä¸šåŠ¡ &lt;strong&gt;0 ä¾µå…¥&lt;/strong&gt; çš„æ–¹å¼ï¼Œè§£å†³ &lt;strong&gt;å¾®æœåŠ¡&lt;/strong&gt; åœºæ™¯ä¸‹é¢ä¸´çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="åˆ†å¸ƒå¼äº‹åŠ¡" scheme="http://damonchow.github.io/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/"/>
    
    
      <category term="åˆ†å¸ƒå¼" scheme="http://damonchow.github.io/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
      <category term="äº‹åŠ¡" scheme="http://damonchow.github.io/tags/%E4%BA%8B%E5%8A%A1/"/>
    
      <category term="XA" scheme="http://damonchow.github.io/tags/XA/"/>
    
  </entry>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹è§£é‡Šå™¨æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2019/01/10/design-pattern-interpreter/"/>
    <id>http://damonchow.github.io/2019/01/10/design-pattern-interpreter/</id>
    <published>2019-01-10T03:01:10.000Z</published>
    <updated>2019-01-12T06:09:44.090Z</updated>
    
    <content type="html"><![CDATA[<h3 id="è§£é‡Šå™¨æ¨¡å¼"><a href="#è§£é‡Šå™¨æ¨¡å¼" class="headerlink" title="è§£é‡Šå™¨æ¨¡å¼"></a>è§£é‡Šå™¨æ¨¡å¼</h3><!-- <è§£é‡Šå™¨æ¨¡å¼æ˜¯ç±»çš„è¡Œä¸ºæ¨¡å¼ã€‚ç»™å®šä¸€ä¸ªè¯­è¨€ä¹‹åï¼Œè§£é‡Šå™¨æ¨¡å¼å¯ä»¥å®šä¹‰å‡ºå…¶æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶åŒæ—¶æä¾›ä¸€ä¸ªè§£é‡Šå™¨ã€‚å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¿™ä¸ªè¯­è¨€ä¸­çš„å¥å­ã€‚--><div class="note info">            <p>æ˜¯ç±»çš„è¡Œä¸ºæ¨¡å¼ï¼Œç»™å®šä¸€ä¸ªè¯­è¨€ä¹‹åï¼Œè§£é‡Šå™¨æ¨¡å¼å¯ä»¥å®šä¹‰å‡ºå…¶æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶åŒæ—¶æä¾›ä¸€ä¸ªè§£é‡Šå™¨ã€‚å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¿™ä¸ªè¯­è¨€ä¸­çš„å¥å­ã€‚</p>          </div><a id="more"></a><p><strong>æ„å›¾</strong> ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥æ ‡è¯†æ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚</p><p><strong>ä¸»è¦è§£å†³</strong> å¯¹äºä¸€äº›å›ºå®šæ–‡æ³•æ„å»ºä¸€ä¸ªè§£é‡Šå¥å­çš„è§£é‡Šå™¨ã€‚</p><p><strong>ä½•æ—¶ä½¿ç”¨</strong> å¦‚æœä¸€ç§ç‰¹å®šç±»å‹çš„é—®é¢˜å‘ç”Ÿçš„é¢‘ç‡è¶³å¤Ÿé«˜ï¼Œé‚£ä¹ˆå¯èƒ½å°±å€¼å¾—å°†è¯¥é—®é¢˜çš„å„ä¸ªå®ä¾‹è¡¨è¿°ä¸ºä¸€ä¸ªç®€å•è¯­è¨€ä¸­çš„å¥å­ã€‚è¿™æ ·å°±å¯ä»¥æ„å»ºä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¯¥è§£é‡Šå™¨é€šè¿‡è§£é‡Šè¿™äº›å¥å­æ¥è§£å†³è¯¥é—®é¢˜ã€‚</p><p><strong>å¦‚ä½•è§£å†³</strong> æ„ä»¶è¯­æ³•æ ‘ï¼Œå®šä¹‰ç»ˆç»“ç¬¦ä¸éç»ˆç»“ç¬¦ã€‚</p><p><strong>å…³é”®ä»£ç </strong> æ„ä»¶ç¯å¢ƒç±»ï¼ŒåŒ…å«è§£é‡Šå™¨ä¹‹å¤–çš„ä¸€äº›å…¨å±€ä¿¡æ¯ï¼Œä¸€èˆ¬æ˜¯ HashMapã€‚</p><h3 id="è§£é‡Šå™¨æ¨¡å¼ç›¸å…³UMLå›¾"><a href="#è§£é‡Šå™¨æ¨¡å¼ç›¸å…³UMLå›¾" class="headerlink" title="è§£é‡Šå™¨æ¨¡å¼ç›¸å…³UMLå›¾"></a>è§£é‡Šå™¨æ¨¡å¼ç›¸å…³UMLå›¾</h3><p>ç±»å›¾</p><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bc/Interpreter_UML_class_diagram.svg/536px-Interpreter_UML_class_diagram.svg.png" alt="Interpreter UML class diagram.svg"></p><p><img src="https://upload.wikimedia.org/wikipedia/commons/3/33/W3sDesign_Interpreter_Design_Pattern_UML.jpg" alt="img"></p><p>å¯ä»¥çœ‹å‡ºå³ä¾§çš„åä½œå›¾(object collaboration diagram)å±•ç°å‡ºè¿è¡Œæ—¶çš„è§£é‡Šå™¨æ¨¡å¼ã€‚Clientå‘å³ä¾§æŠ½è±¡è¯­æ³•æ ‘å‘é€è§£é‡Šè¯·æ±‚ï¼Œè¯·æ±‚è¢«è½¬å‘å¹¶å‘ä¸‹åˆ°æ ‘ç»“æ„çš„æ‰€æœ‰å¯¹è±¡ã€‚</p><h3 id="è§£é‡Šå™¨æ¨¡å¼çš„ä¸»è¦è§’è‰²"><a href="#è§£é‡Šå™¨æ¨¡å¼çš„ä¸»è¦è§’è‰²" class="headerlink" title="è§£é‡Šå™¨æ¨¡å¼çš„ä¸»è¦è§’è‰²"></a>è§£é‡Šå™¨æ¨¡å¼çš„ä¸»è¦è§’è‰²</h3><blockquote><p>æŠ½è±¡è§£é‡Šå™¨(AbstractExpression/Expression)ï¼šå£°æ˜ä¸€ä¸ªæ‰€æœ‰å…·ä½“è¡¨è¾¾å¼éƒ½è¦å®ç°çš„æŠ½è±¡æ¥å£ï¼ˆæˆ–è€…æŠ½è±¡ç±»ï¼‰ï¼Œæ¥å£ä¸­ä¸»è¦æ˜¯ä¸€ä¸ªinterpret()æ–¹æ³•ï¼Œç§°ä¸ºè§£é‡Šæ“ä½œã€‚å…·ä½“è§£é‡Šä»»åŠ¡ç”±å®ƒçš„å„ä¸ªå®ç°ç±»æ¥å®Œæˆï¼Œå…·ä½“çš„è§£é‡Šå™¨åˆ†åˆ«ç”±ç»ˆç»“ç¬¦è§£é‡Šå™¨TerminalExpressionå’Œéç»ˆç»“ç¬¦è§£é‡Šå™¨NonterminalExpressionå®Œæˆã€‚</p><p>ç»ˆç»“ç¬¦è¡¨è¾¾å¼(TerminalExpression)ï¼šå®ç°ä¸æ–‡æ³•ä¸­çš„å…ƒç´ ç›¸å…³è”çš„è§£é‡Šæ“ä½œï¼Œé€šå¸¸ä¸€ä¸ªè§£é‡Šå™¨æ¨¡å¼ä¸­åªæœ‰ä¸€ä¸ªç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼Œä½†æœ‰å¤šä¸ªå®ä¾‹ï¼Œå¯¹åº”ä¸åŒçš„ç»ˆç»“ç¬¦ã€‚ç»ˆç»“ç¬¦ä¸€åŠæ˜¯æ–‡æ³•ä¸­çš„è¿ç®—å•å…ƒï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªç®€å•çš„å…¬å¼R=R1+R2ï¼Œåœ¨é‡Œé¢R1å’ŒR2å°±æ˜¯ç»ˆç»“ç¬¦ï¼Œå¯¹åº”çš„è§£æR1å’ŒR2çš„è§£é‡Šå™¨å°±æ˜¯ç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚ </p><p>éç»ˆç»“ç¬¦è¡¨è¾¾å¼(NonterminalExpression)ï¼šæ–‡æ³•ä¸­çš„æ¯æ¡è§„åˆ™å¯¹åº”äºä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼Œéç»ˆç»“ç¬¦è¡¨è¾¾å¼ä¸€èˆ¬æ˜¯æ–‡æ³•ä¸­çš„è¿ç®—ç¬¦æˆ–è€…å…¶ä»–å…³é”®å­—ï¼Œæ¯”å¦‚å…¬å¼R=R1+R2ä¸­ï¼Œ+å°±æ˜¯éç»ˆç»“ç¬¦ï¼Œè§£æ+çš„è§£é‡Šå™¨å°±æ˜¯ä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚éç»ˆç»“ç¬¦è¡¨è¾¾å¼æ ¹æ®é€»è¾‘çš„å¤æ‚ç¨‹åº¦è€Œå¢åŠ ï¼ŒåŸåˆ™ä¸Šæ¯ä¸ªæ–‡æ³•è§„åˆ™éƒ½å¯¹åº”ä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚</p><p>ç¯å¢ƒè§’è‰²(Context)ï¼šè¿™ä¸ªè§’è‰²çš„ä»»åŠ¡ä¸€èˆ¬æ˜¯ç”¨æ¥å­˜æ”¾æ–‡æ³•ä¸­å„ä¸ªç»ˆç»“ç¬¦æ‰€å¯¹åº”çš„å…·ä½“å€¼ï¼Œæ¯”å¦‚R=R1+R2ï¼Œæˆ‘ä»¬ç»™R1èµ‹å€¼100ï¼Œç»™R2èµ‹å€¼200ã€‚è¿™äº›ä¿¡æ¯éœ€è¦å­˜æ”¾åˆ°ç¯å¢ƒè§’è‰²ä¸­ï¼Œå¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬ä½¿ç”¨Mapæ¥å……å½“ç¯å¢ƒè§’è‰²å°±è¶³å¤Ÿäº†ã€‚</p></blockquote><h3 id="å¹²è´§ä»£ç "><a href="#å¹²è´§ä»£ç " class="headerlink" title="å¹²è´§ä»£ç "></a>å¹²è´§ä»£ç </h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci9pbnRlcnByZXRlcg==" title="https://github.com/DamonChow/design_pattern/tree/master/interpreter">è·³è½¬åˆ°æºç åœ°å€<i class="fa fa-external-link"></i></span></p><p>ç®€å•çš„ä¸€ä¸ªè§£é‡Šå™¨è®¡ç®—åŠ å‡ä¹˜é™¤ç®—æ³•ï¼Œç¯å¢ƒä¸Šä¸‹æ–‡æ²¡æœ‰ç”¨å¥½ï¼Œå…¶å®è®¡ç®—è§„åˆ™æ›´å¤šçš„æ˜¯äººä¸ºè®¾å®šçš„äº†ã€‚</p><p>æœ¬æ¬¡çš„æŠ½è±¡æ¥æ”¶å™¨ç”¨çš„æ˜¯æŠ½è±¡ç±»ï¼Œç”¨æ¥å£ä»£æ›¿ä¹Ÿå¯ä»¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡è§£é‡Šå™¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(Context context)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éç»ˆç»“è¡¨è¾¾å¼ï¼šåŠ æ³•</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Add</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AbstractExpression left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> left.interpreter(context) + right.interpreter(context);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éç»ˆç»“è¡¨è¾¾å¼ï¼šå‡æ³•</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Subtract</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AbstractExpression left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> left.interpreter(context) - right.interpreter(context);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éç»ˆç»“è¡¨è¾¾å¼ï¼šä¹˜æ³•</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Multiply</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AbstractExpression left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> left.interpreter(context) * right.interpreter(context);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éç»ˆç»“è¡¨è¾¾å¼ï¼šé™¤æ³•</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Division</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AbstractExpression left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> right = <span class="keyword">this</span>.right.interpreter(context);</span><br><span class="line">        <span class="keyword">if</span> (right != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> left.interpreter(context) / right;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»ˆç»“è¡¨è¾¾å¼ï¼šå˜é‡</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Variable</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String key;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> context.getValue(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¯å¢ƒä¸Šä¸‹æ–‡</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, Integer&gt; valueMap = Maps.newHashMap();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addValue</span><span class="params">(<span class="keyword">final</span> String key, <span class="keyword">final</span> <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        valueMap.put(key, Integer.valueOf(value));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">(<span class="keyword">final</span> String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> valueMap.get(key).intValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Context context = <span class="keyword">new</span> Context();</span><br><span class="line">        context.addValue(<span class="string">"a"</span>, <span class="number">6</span>);</span><br><span class="line">        context.addValue(<span class="string">"b"</span>, <span class="number">9</span>);</span><br><span class="line">        context.addValue(<span class="string">"c"</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        Variable a = <span class="keyword">new</span> Variable(<span class="string">"a"</span>);</span><br><span class="line">        Variable b = <span class="keyword">new</span> Variable(<span class="string">"b"</span>);</span><br><span class="line">        Variable c = <span class="keyword">new</span> Variable(<span class="string">"c"</span>);</span><br><span class="line"></span><br><span class="line">        AbstractExpression multiplyValue = <span class="keyword">new</span> Multiply(a, b);</span><br><span class="line">        AbstractExpression subtractValue = <span class="keyword">new</span> Subtract(a, b);</span><br><span class="line">        AbstractExpression addValue = <span class="keyword">new</span> Add(subtractValue, c);</span><br><span class="line">        AbstractExpression divisionValue = <span class="keyword">new</span> Division(multiplyValue, addValue);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"&#123;&#125;"</span>, context.getValueMap());</span><br><span class="line">        log.info(<span class="string">"(a*b)/(a-b+c) = &#123;&#125;"</span>, divisionValue.interpreter(context));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fz3kjs5hgrj31eu036dgk.jpg" alt="image-20190112095954448"></p><h3 id="Javaä¸­çš„åº”ç”¨"><a href="#Javaä¸­çš„åº”ç”¨" class="headerlink" title="Javaä¸­çš„åº”ç”¨"></a>Javaä¸­çš„åº”ç”¨</h3><div class="note info">            <h4 id="javaä¸­çš„è¡¨è¾¾å¼å¼•æ“"><a href="#javaä¸­çš„è¡¨è¾¾å¼å¼•æ“" class="headerlink" title="javaä¸­çš„è¡¨è¾¾å¼å¼•æ“"></a><strong>javaä¸­çš„è¡¨è¾¾å¼å¼•æ“</strong></h4><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NjaXJldW0vcGFyc2lp" title="https://github.com/scireum/parsii">parsii<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL2pldmFsLnNvdXJjZWZvcmdlLm5ldC8=" title="http://jeval.sourceforge.net/">JEval<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL2plcGxpdGUuc291cmNlZm9yZ2UubmV0Lw==" title="http://jeplite.sourceforge.net/">JEPLite<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Rhcml1cy9leHBy" title="https://github.com/darius/expr">expr<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL2RvY3MuY29kZWhhdXMub3JnL2Rpc3BsYXkvSkFOSU5PL0Jhc2lj" title="http://docs.codehaus.org/display/JANINO/Basic">Janino<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL3NvZnR3YXJlbW9uY2cub3JnL2NvZGUvbWF0aGV2YWw=" title="http://softwaremoncg.org/code/matheval">MathEval<i class="fa fa-external-link"></i></span></p>          </div><p><span class="exturl" data-url="aHR0cDovL3d3dy5maW5kc3JjLmNvbS9qYXZhL2RldGFpbC84NjY0" title="http://www.findsrc.com/java/detail/8664">Javaè¡¨è¾¾å¼å¼•æ“fel/groovy/expression4j/javaè„šæœ¬å¼•æ“çš„æ€§èƒ½å¯¹æ¯”<i class="fa fa-external-link"></i></span></p><h4 id="JDKä¸­çš„åº”ç”¨"><a href="#JDKä¸­çš„åº”ç”¨" class="headerlink" title="JDKä¸­çš„åº”ç”¨"></a>JDKä¸­çš„åº”ç”¨</h4><p>è¿™ä¸ªæ¨¡å¼é€šå¸¸å®šä¹‰äº†ä¸€ä¸ªè¯­è¨€çš„è¯­æ³•ï¼Œç„¶åè§£æç›¸åº”è¯­æ³•çš„è¯­å¥ã€‚ </p><blockquote><p>java.util.Pattern </p><p>java.text.Normalizer </p><p>java.text.Format</p></blockquote><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2Rlc2lnbi1wYXR0ZXJuL2ludGVycHJldGVyLXBhdHRlcm4uaHRtbA==" title="http://www.runoob.com/design-pattern/interpreter-pattern.html">è§£é‡Šå™¨æ¨¡å¼|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSW50ZXJwcmV0ZXJfcGF0dGVybg==" title="https://en.wikipedia.org/wiki/Interpreter_pattern">Interpreter pattern<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdGlueWtpbmcvcC81OTM4NTQ3Lmh0bWw=" title="https://www.cnblogs.com/tinyking/p/5938547.html">ç»†æ•°JDKé‡Œçš„è®¾è®¡æ¨¡å¼<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poZW5nemhiL2FydGljbGUvZGV0YWlscy83NjY2MDIw" title="https://blog.csdn.net/zhengzhb/article/details/7666020">23ç§è®¾è®¡æ¨¡å¼ï¼ˆ14ï¼‰ï¼šè§£é‡Šå™¨æ¨¡å¼<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;è§£é‡Šå™¨æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è§£é‡Šå™¨æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è§£é‡Šå™¨æ¨¡å¼&quot;&gt;&lt;/a&gt;è§£é‡Šå™¨æ¨¡å¼&lt;/h3&gt;&lt;!-- &lt;è§£é‡Šå™¨æ¨¡å¼æ˜¯ç±»çš„è¡Œä¸ºæ¨¡å¼ã€‚ç»™å®šä¸€ä¸ªè¯­è¨€ä¹‹åï¼Œè§£é‡Šå™¨æ¨¡å¼å¯ä»¥å®šä¹‰å‡ºå…¶æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶åŒæ—¶æä¾›ä¸€ä¸ªè§£é‡Šå™¨ã€‚å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¿™ä¸ªè¯­è¨€ä¸­çš„å¥å­ã€‚--&gt;
&lt;div class=&quot;note info&quot;&gt;
            &lt;p&gt;æ˜¯ç±»çš„è¡Œä¸ºæ¨¡å¼ï¼Œç»™å®šä¸€ä¸ªè¯­è¨€ä¹‹åï¼Œè§£é‡Šå™¨æ¨¡å¼å¯ä»¥å®šä¹‰å‡ºå…¶æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶åŒæ—¶æä¾›ä¸€ä¸ªè§£é‡Šå™¨ã€‚å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¿™ä¸ªè¯­è¨€ä¸­çš„å¥å­ã€‚&lt;/p&gt;
          &lt;/div&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹è®¿é—®è€…æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2019/01/07/design-pattern-visitor/"/>
    <id>http://damonchow.github.io/2019/01/07/design-pattern-visitor/</id>
    <published>2019-01-07T07:15:31.000Z</published>
    <updated>2019-01-12T06:11:20.363Z</updated>
    
    <content type="html"><![CDATA[<h3 id="è®¿é—®è€…æ¨¡å¼"><a href="#è®¿é—®è€…æ¨¡å¼" class="headerlink" title="è®¿é—®è€…æ¨¡å¼"></a>è®¿é—®è€…æ¨¡å¼</h3><blockquote><p>Represent an operation to be performed on the elements of an object structure. Visitor lets a new operation be defined without changing the classes of the elements on which it operates.</p><p><strong>è®¿é—®è€…æ¨¡å¼çš„ç›®çš„æ˜¯å°è£…ä¸€äº›æ–½åŠ äºæŸç§æ•°æ®ç»“æ„å…ƒç´ ä¹‹ä¸Šçš„æ“ä½œã€‚ä¸€æ—¦è¿™äº›æ“ä½œéœ€è¦ä¿®æ”¹çš„è¯ï¼Œæ¥å—è¿™ä¸ªæ“ä½œçš„æ•°æ®ç»“æ„åˆ™å¯ä»¥ä¿æŒä¸å˜ã€‚</strong></p></blockquote><a id="more"></a><p><strong>æ„å›¾</strong> ä¸»è¦å°†æ•°æ®ç»“æ„ä¸æ•°æ®æ“ä½œåˆ†ç¦»ã€‚</p><p><strong>ä¸»è¦è§£å†³</strong> ç¨³å®šçš„æ•°æ®ç»“æ„å’Œæ˜“å˜çš„æ“ä½œè€¦åˆé—®é¢˜ã€‚</p><p><strong>ä½•æ—¶ä½¿ç”¨</strong> éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒçš„å¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œéœ€è¦é¿å…è®©è¿™äº›æ“ä½œâ€æ±¡æŸ“â€è¿™äº›å¯¹è±¡çš„ç±»ï¼Œä½¿ç”¨è®¿é—®è€…æ¨¡å¼å°†è¿™äº›å°è£…åˆ°ç±»ä¸­ã€‚</p><h3 id="è®¿é—®è€…æ¨¡å¼çš„ä¸»è¦è§’è‰²"><a href="#è®¿é—®è€…æ¨¡å¼çš„ä¸»è¦è§’è‰²" class="headerlink" title="è®¿é—®è€…æ¨¡å¼çš„ä¸»è¦è§’è‰²"></a><strong>è®¿é—®è€…æ¨¡å¼çš„ä¸»è¦è§’è‰²</strong></h3><blockquote><p>Visitorï¼ˆæŠ½è±¡è®¿é—®è€…ï¼‰ï¼šæŠ½è±¡è®¿é—®è€…ä¸ºå¯¹è±¡ç»“æ„ä¸­æ¯ä¸€ä¸ªå…·ä½“å…ƒç´ ç±»ConcreteElementå£°æ˜ä¸€ä¸ªè®¿é—®æ“ä½œï¼Œä»è¿™ä¸ªæ“ä½œçš„åç§°æˆ–å‚æ•°ç±»å‹å¯ä»¥æ¸…æ¥šçŸ¥é“éœ€è¦è®¿é—®çš„å…·ä½“å…ƒç´ çš„ç±»å‹ï¼Œå…·ä½“è®¿é—®è€…éœ€è¦å®ç°è¿™äº›æ“ä½œæ–¹æ³•ï¼Œå®šä¹‰å¯¹è¿™äº›å…ƒç´ çš„è®¿é—®æ“ä½œã€‚</p><p>ConcreteVisitorï¼ˆå…·ä½“è®¿é—®è€…ï¼‰ï¼šå…·ä½“è®¿é—®è€…å®ç°äº†æ¯ä¸ªç”±æŠ½è±¡è®¿é—®è€…å£°æ˜çš„æ“ä½œï¼Œæ¯ä¸€ä¸ªæ“ä½œç”¨äºè®¿é—®å¯¹è±¡ç»“æ„ä¸­ä¸€ç§ç±»å‹çš„å…ƒç´ ã€‚</p><p>Elementï¼ˆæŠ½è±¡å…ƒç´ ï¼‰ï¼šæŠ½è±¡å…ƒç´ ä¸€èˆ¬æ˜¯æŠ½è±¡ç±»æˆ–è€…æ¥å£ï¼Œå®ƒå®šä¹‰ä¸€ä¸ªaccept()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•é€šå¸¸ä»¥ä¸€ä¸ªæŠ½è±¡è®¿é—®è€…ä½œä¸ºå‚æ•°ã€‚</p><p>ConcreteElementï¼ˆå…·ä½“å…ƒç´ ï¼‰ï¼šå…·ä½“å…ƒç´ å®ç°äº†accept()æ–¹æ³•ï¼Œåœ¨accept()æ–¹æ³•ä¸­è°ƒç”¨è®¿é—®è€…çš„è®¿é—®æ–¹æ³•ä»¥ä¾¿å®Œæˆå¯¹ä¸€ä¸ªå…ƒç´ çš„æ“ä½œã€‚</p><p>ObjectStructureï¼ˆå¯¹è±¡ç»“æ„ï¼‰ï¼šå¯¹è±¡ç»“æ„æ˜¯ä¸€ä¸ªå…ƒç´ çš„é›†åˆï¼Œå®ƒç”¨äºå­˜æ”¾å…ƒç´ å¯¹è±¡ï¼Œå¹¶ä¸”æä¾›äº†éå†å…¶å†…éƒ¨å…ƒç´ çš„æ–¹æ³•ã€‚å®ƒå¯ä»¥ç»“åˆç»„åˆæ¨¡å¼æ¥å®ç°ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç®€å•çš„é›†åˆå¯¹è±¡ï¼Œå¦‚ä¸€ä¸ªListå¯¹è±¡æˆ–ä¸€ä¸ªSetå¯¹è±¡ã€‚</p></blockquote><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong> 1ã€å¯¹è±¡ç»“æ„ä¸­å¯¹è±¡å¯¹åº”çš„ç±»å¾ˆå°‘æ”¹å˜ï¼Œä½†ç»å¸¸éœ€è¦åœ¨æ­¤å¯¹è±¡ç»“æ„ä¸Šå®šä¹‰æ–°çš„æ“ä½œã€‚ 2ã€éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒçš„å¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œéœ€è¦é¿å…è®©è¿™äº›æ“ä½œâ€æ±¡æŸ“â€è¿™äº›å¯¹è±¡çš„ç±»ï¼Œä¹Ÿä¸å¸Œæœ›åœ¨å¢åŠ æ–°æ“ä½œæ—¶ä¿®æ”¹è¿™äº›ç±»ã€‚</p><h3 id="è®¿é—®è€…æ¨¡å¼ç›¸å…³UMLå›¾"><a href="#è®¿é—®è€…æ¨¡å¼ç›¸å…³UMLå›¾" class="headerlink" title="è®¿é—®è€…æ¨¡å¼ç›¸å…³UMLå›¾"></a>è®¿é—®è€…æ¨¡å¼ç›¸å…³UMLå›¾</h3><p>UMLç±»å›¾å’Œæ—¶åºå›¾</p><p><img src="https://upload.wikimedia.org/wikipedia/commons/0/00/W3sDesign_Visitor_Design_Pattern_UML.jpg" alt="img"></p><p>åœ¨ç±»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒElementAå®ç°äº†æ¥å£Elementçš„accept(visitor)æ–¹æ³•ï¼Œè€Œé€šè¿‡visitor.visitElementA(this)ï¼Œç›¸åŒvisitor1ç±»é€šè¿‡å®ç°visitElementA(ElementA a)æ–¹æ³•ä¸ElementAå…³è”ã€‚ç›¸åŒçš„ElementBäº¦æ˜¯å¦‚æ­¤åŸç†ã€‚</p><p>å³ä¸Šè§’çš„æ—¶åºå›¾ï¼ŒClientå¯¹è±¡æœ‰ä¸€ç»„Elementçš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡å¾ªç¯å¯¹æ¯ä¸ªå…ƒç´ Elementè°ƒç”¨accept(visitor)æ–¹æ³•ï¼Œä¾‹å¦‚å…ˆæ˜¯ElementAè°ƒç”¨accept(visitor)ï¼Œå®é™…ä¸Šå°±æ˜¯è°ƒç”¨visitor1çš„visitElementA(A)ï¼ŒåŒæ ·æƒ…å†µå¯¹ElementBã€‚</p><p>æ›´åŠ æ¸…æ™°çš„ç±»å›¾å¦‚ä¸‹</p><p><img src="https://upload.wikimedia.org/wikipedia/en/thumb/e/eb/Visitor_design_pattern.svg/430px-Visitor_design_pattern.svg.png" alt="img"></p><h3 id="å®ä¾‹å¹²è´§"><a href="#å®ä¾‹å¹²è´§" class="headerlink" title="å®ä¾‹å¹²è´§"></a>å®ä¾‹å¹²è´§</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci92aXNpdG9y" title="https://github.com/DamonChow/design_pattern/tree/master/visitor">è·³è½¬åˆ°å¯¹åº”çš„æºç <i class="fa fa-external-link"></i></span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡å…ƒç´ </span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(ElementVisitor visitor)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“å…ƒç´ -è½¦è½®</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Wheel</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(ElementVisitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“å…ƒç´ -è½¦èº«</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Body</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(ElementVisitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“å…ƒç´ -å¼•æ“</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Engine</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(ElementVisitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“å…ƒç´ -æ•´è½¦</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(<span class="keyword">final</span> ElementVisitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠ½è±¡è®¿é—®è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ElementVisitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(Body body)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(Engine engine)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(Wheel wheel)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(Car car)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“çš„ä¸€ä¸ªè®¿é—®è€…ï¼Œçº¯æ‰“å°</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoElementVisitor</span> <span class="keyword">implements</span> <span class="title">ElementVisitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Body body)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Moving my body"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Engine engine)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Starting my engine"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Wheel wheel)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Kicking my "</span> + wheel.getName() + <span class="string">" wheel"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Car car)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Starting my car"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å•ç‹¬è¿˜å®šä¹‰å¯¹è±¡ç»“æ„ï¼Œå…¶å®å®Œå…¨å°±å¯ä»¥ä½¿ç”¨åˆ—è¡¨å°±å¯ä»¥</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElementStructure</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Element&gt; list = Lists.newArrayList();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addElement</span><span class="params">(Element element)</span></span>&#123;</span><br><span class="line">        list.add(element);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(ElementVisitor visitor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Element elem : list) &#123;</span><br><span class="line">            elem.accept(visitor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å°±æ˜¯é’ˆå¯¹è®¿é—®è€…æ¨¡å¼åšçš„ä¸€ä¸ªå¯¹äºæ±½è½¦é›¶ä»¶çš„ä¸€ä¸ªæ‰“å°æ•ˆæœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientWithVisitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ElementStructure structure = <span class="keyword">new</span> ElementStructure();</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Wheel(<span class="string">"front left"</span>));</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Wheel(<span class="string">"front right"</span>));</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Wheel(<span class="string">"back left"</span>));</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Wheel(<span class="string">"back right"</span>));</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Body());</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Engine());</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Car());</span><br><span class="line"></span><br><span class="line">        structure.accept(<span class="keyword">new</span> DoElementVisitor());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientWithoutVisitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ElementStructure structure = <span class="keyword">new</span> ElementStructure();</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Wheel(<span class="string">"front left"</span>));</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Wheel(<span class="string">"front right"</span>));</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Wheel(<span class="string">"back left"</span>));</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Wheel(<span class="string">"back right"</span>));</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Body());</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Engine());</span><br><span class="line">        structure.addElement(<span class="keyword">new</span> Car());</span><br><span class="line"></span><br><span class="line">        structure.getList().forEach(e -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (e <span class="keyword">instanceof</span> Body) &#123;</span><br><span class="line">                log.info(<span class="string">"Moving my body"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> Engine) &#123;</span><br><span class="line">                log.info(<span class="string">"Starting my engine"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> Car) &#123;</span><br><span class="line">                log.info(<span class="string">"Starting my car"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> Wheel) &#123;</span><br><span class="line">                log.info(<span class="string">"Kicking my "</span> + ((Wheel)e).getName() + <span class="string">" wheel"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å°ç»“æœéƒ½æ˜¯ä¸€æ ·çš„</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fyy45dgfcoj31ma092gon.jpg" alt="image-20190107164438915"></p><h3 id="æ€»ç»“åˆ†æ"><a href="#æ€»ç»“åˆ†æ" class="headerlink" title="æ€»ç»“åˆ†æ"></a>æ€»ç»“åˆ†æ</h3><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­åˆ†åˆ«ç”¨äº†è®¿é—®è€…æ¨¡å¼å’Œéè®¿é—®è€…æ¨¡å¼ä¸¤ç§æ–¹æ³•ã€‚</p><p>1ã€ä½¿ç”¨VIsitorçš„å¥½å¤„ä¸€ç›®äº†ç„¶ï¼Œå½“éœ€è¦ä¿®æ”¹æŸäº›å…ƒç´ çš„ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œåªéœ€è¦ä¿®æ”¹Visitorç±»ä¸­ç›¸å¯¹åº”çš„æ“ä½œå‡½æ•°å³å¯ã€‚ä¾‹å¦‚å‡è®¾è¦ä¿®æ”¹Wheelçš„é€»è¾‘ï¼Œåªéœ€è¦ä¿®æ”¹Visitorçš„visit(Wheel wheel)æ–¹æ³•å³å¯ã€‚</p><p>2ã€å‡è®¾æˆ‘ä»¬åˆéœ€è¦æ–°å¢ä¸€ä¸ªæ±½è½¦å…ƒç´ å¤©çª—çš„è¯ï¼Œåªéœ€è¦åœ¨visitorä¸­æ·»åŠ æ–°çš„æ¥å£ä»¥å¤„ç†æ–°å…ƒç´ ï¼Œè€Œåˆ«çš„å…ƒç´ å¯ä»¥ä¿æŒä¸åŠ¨ã€‚  è¿èƒŒå¼€é—­åŸåˆ™ã€‚</p><p>3ã€å½“æˆ‘ä»¬éœ€è¦æ·»åŠ æ–°çš„ä¸šåŠ¡æ“ä½œï¼Œåªéœ€è¦æ·»åŠ æ–°çš„å…·ä½“è®¿é—®è€…ï¼Œå…¶ä»–çš„ä¾æ—§å¯ä»¥ä¿æŒä¸å˜ã€‚ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</p><p>åŒæ ·ï¼Œæœ‰å¥½å¤„ä¹Ÿå°±æœ‰ç¼ºé™·ï¼Œå› ä¸ºé€»è¾‘åœ¨visitoré‡Œé¢ï¼Œæ‰€æœ‰visitorå’ŒElementé«˜åº¦è€¦åˆï¼ŒåŒæ ·é’ˆå¯¹visitæ–¹æ³•è¿”å›ç±»å‹ï¼Œéœ€è¦è®¾è®¡çš„ä¼˜é›…ï¼Œå¦‚è‹¥ä¸ç„¶ï¼ŒåæœŸä¸€æ—¦ä¿®æ”¹è¿”å›ç±»å‹ï¼Œå½±å“çš„èŒƒå›´å°±å¹¿ï¼Œæ‰€æœ‰è®¿é—®è€…æ¥å£å’Œå®ç°éƒ½æ³¢åŠåˆ°ã€‚è®¿é—®è€…æ¨¡å¼è¦æ±‚è®¿é—®è€…å¯¹è±¡è®¿é—®å¹¶è°ƒç”¨æ¯ä¸€ä¸ªå…ƒç´ å¯¹è±¡çš„æ“ä½œï¼Œè¿™æ„å‘³ç€å…ƒç´ å¯¹è±¡æœ‰æ—¶å€™å¿…é¡»æš´éœ²ä¸€äº›è‡ªå·±çš„å†…éƒ¨æ“ä½œå’Œå†…éƒ¨çŠ¶æ€ï¼Œå¦åˆ™æ— æ³•ä¾›è®¿é—®è€…è®¿é—®ï¼Œè¿™ä¸€ç‚¹è·Ÿè¿ªç±³ç‰¹æ³•åˆ™å’Œä¾èµ–å€’ç½®åŸåˆ™ç›¸è¿èƒŒã€‚</p><p>æ€»çš„è€Œè¨€ï¼Œè®¿é—®è€…æ¨¡å¼çš„ä½¿ç”¨æ¡ä»¶è¾ƒä¸ºè‹›åˆ»ï¼Œæœ¬èº«ç»“æ„ä¹Ÿè¾ƒä¸ºå¤æ‚ï¼Œå› æ­¤åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨é¢‘ç‡ä¸æ˜¯ç‰¹åˆ«é«˜ã€‚</p><h3 id="JDKä¸­å«æœ‰çš„è®¿é—®è€…æ¨¡å¼"><a href="#JDKä¸­å«æœ‰çš„è®¿é—®è€…æ¨¡å¼" class="headerlink" title="JDKä¸­å«æœ‰çš„è®¿é—®è€…æ¨¡å¼"></a>JDKä¸­å«æœ‰çš„è®¿é—®è€…æ¨¡å¼</h3><p>æä¾›ä¸€ä¸ªæ–¹ä¾¿çš„å¯ç»´æŠ¤çš„æ–¹å¼æ¥æ“ä½œä¸€ç»„å¯¹è±¡ã€‚å®ƒä½¿å¾—ä½ åœ¨ä¸æ”¹å˜æ“ä½œçš„å¯¹è±¡å‰æä¸‹ï¼Œå¯ä»¥ä¿®æ”¹æˆ–è€…æ‰©å±•å¯¹è±¡çš„è¡Œä¸ºã€‚ </p><blockquote><p>javax.lang.model.element.Element and javax.lang.model.element.ElementVisitor</p><p>javax.lang.model.type.TypeMirror and javax.lang.model.type.TypeVisitor</p></blockquote><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2Rlc2lnbi1wYXR0ZXJuL3Zpc2l0b3ItcGF0dGVybi5odG1s" title="http://www.runoob.com/design-pattern/visitor-pattern.html">è®¿é—®è€…æ¨¡å¼|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVmlzaXRvcl9wYXR0ZXJu" title="https://en.wikipedia.org/wiki/Visitor_pattern">Visitor pattern<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Rhb3ppODAyMy9hcnRpY2xlL2RldGFpbHMvNTE0NTc2MTY=" title="https://blog.csdn.net/taozi8023/article/details/51457616">JAVAè®¾è®¡æ¨¡å¼ï¼ˆ23ï¼‰ï¼šè¡Œä¸ºå‹-è®¿é—®è€…æ¨¡å¼ï¼ˆVisitorï¼‰<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;è®¿é—®è€…æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è®¿é—®è€…æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è®¿é—®è€…æ¨¡å¼&quot;&gt;&lt;/a&gt;è®¿é—®è€…æ¨¡å¼&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;Represent an operation to be performed on the elements of an object structure. Visitor lets a new operation be defined without changing the classes of the elements on which it operates.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è®¿é—®è€…æ¨¡å¼çš„ç›®çš„æ˜¯å°è£…ä¸€äº›æ–½åŠ äºæŸç§æ•°æ®ç»“æ„å…ƒç´ ä¹‹ä¸Šçš„æ“ä½œã€‚ä¸€æ—¦è¿™äº›æ“ä½œéœ€è¦ä¿®æ”¹çš„è¯ï¼Œæ¥å—è¿™ä¸ªæ“ä½œçš„æ•°æ®ç»“æ„åˆ™å¯ä»¥ä¿æŒä¸å˜ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="è®¿é—®è€…" scheme="http://damonchow.github.io/tags/%E8%AE%BF%E9%97%AE%E8%80%85/"/>
    
  </entry>
  
  <entry>
    <title>è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™</title>
    <link href="http://damonchow.github.io/2019/01/05/principles-of-software-design-patterns/"/>
    <id>http://damonchow.github.io/2019/01/05/principles-of-software-design-patterns/</id>
    <published>2019-01-05T02:07:39.000Z</published>
    <updated>2019-01-12T06:11:20.353Z</updated>
    
    <content type="html"><![CDATA[<h3 id="è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™"><a href="#è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™" class="headerlink" title="è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™"></a>è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™</h3><p>åœ¨æˆ‘ä»¬é¢å‘å¯¹è±¡çš„è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„codeæ—¢è¦<strong>å¯è¯»æ€§</strong>é«˜æ–¹ä¾¿ç»´æŠ¤ï¼ŒåŒæ—¶è¿˜éœ€è¦å¦å¤–ä¸€ä¸ª<strong>å¯å¤ç”¨æ€§</strong>ã€‚è¿™æ¬¡æˆ‘ä»¬æ¥å­¦ä¹ è½¯ä»¶è®¾è®¡æ¨¡å¼ä¸­æ¶‰åŠåˆ°çš„ä¸€äº›åŸåˆ™â€”â€”â€”â€”&gt;<strong>é¢å‘å¯¹è±¡è®¾è®¡</strong>   <strong>SOLID</strong></p><a id="more"></a><blockquote><p><strong>è¿™å°±æ˜¯åæ§½ï¼š</strong> ä½†æ˜¯æˆ‘ä»¬å¾€å¾€æ¥æ‰‹çš„é¡¹ç›®ï¼Œéƒ½æ˜¯è‹¦ä¸å ªè¨€ï¼Œä¸€æŠŠé¼»æ¶•ä¸€æŠŠæ³ªï¼Œçœ‹å‰äººç•™ä¸‹çš„æ°ä½œï¼Œé‚£æ˜¯ç›¸å½“ç—›è‹¦ï¼Œåƒä¸‡åŒ¹MMPå¥”è…¾ï¼Œå¡«å‘ï¼Œè¿˜æŠ€æœ¯å€ºã€‚</p></blockquote><p>å…¥æ­£é¢˜ï¼Œåœ¨æœ‰äº›è¯´ä¸ƒå¤§åŸåˆ™ï¼Œæœ‰äº›è¯´å…­å¤§åŸåˆ™ï¼Œæœ‰äº›è¯´äº”å¤§åŸåˆ™ï¼Œä½†æ˜¯æœ€é‡è¦çš„å°±æ˜¯<strong>SOLID</strong>äº†ã€‚</p><p>å›½å†…çš„åšæ–‡å¤§éƒ¨åˆ†éƒ½è¯´ä¸ƒå¤§å’Œå…­å¤§åŸåˆ™ï¼ŒGoogleä¸‹solidï¼Œçœ‹è€å¤–çš„æ–‡ç« å’Œwikiéƒ½æ˜¯äº”å¤§åŸåˆ™ã€‚</p><p>æˆ‘ä»¬å…ˆçœ‹SOLIDï¼Œæ˜¯ç½—ä¼¯ç‰¹Â·CÂ·é©¬ä¸æå‡ºæ¥çš„é¦–å­—æ¯ç¼©å†™è®°å¿†ï¼Œè¿™ä¸ªBobå¤§å”ã€‚</p><blockquote><p>Single Responsibility Principleï¼šå•ä¸€èŒè´£åŸåˆ™ï¼Œè§£é‡Šï¼šä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸä¸­çš„ç›¸åº”èŒè´£</p><p>Open Closed Principleï¼šå¼€é—­åŸåˆ™ï¼Œè§£é‡Šï¼šè½¯ä»¶å®ä½“åº”å¯¹æ‰©å±•å¼€æ”¾ï¼Œè€Œå¯¹ä¿®æ”¹å…³é—­</p><p>Liskov Substitution Principleï¼šé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œè§£é‡Šï¼šæ‰€æœ‰å¼•ç”¨åŸºç±»å¯¹è±¡çš„åœ°æ–¹èƒ½å¤Ÿé€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡</p><p>Interface Segregation Principleï¼šæ¥å£éš”ç¦»åŸåˆ™ï¼Œè§£é‡Šï¼šä½¿ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£ï¼Œè€Œä¸ä½¿ç”¨å•ä¸€çš„æ€»æ¥å£</p><p>Dependence Inversion Principleï¼šä¾èµ–å€’ç½®åŸåˆ™ï¼Œè§£é‡Šï¼šæŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡</p></blockquote><p>å‰©ä¸‹çš„ä¸¤å¤§åŸåˆ™</p><blockquote><p>Composite Reuse Principle åˆæˆå¤ç”¨åŸåˆ™ï¼Œè§£é‡Šï¼šå°½é‡ä½¿ç”¨å¯¹è±¡ç»„åˆï¼Œè€Œä¸æ˜¯ç»§æ‰¿æ¥è¾¾åˆ°å¤ç”¨çš„ç›®çš„</p><p>Law of Demeter è¿ªç±³ç‰¹æ³•åˆ™ï¼Œè§£é‡Šï¼šä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å°½å¯èƒ½å°‘åœ°ä¸å…¶ä»–å®ä½“å‘ç”Ÿç›¸äº’ä½œç”¨</p></blockquote><h4 id="å•ä¸€èŒè´£åŸåˆ™"><a href="#å•ä¸€èŒè´£åŸåˆ™" class="headerlink" title="å•ä¸€èŒè´£åŸåˆ™"></a>å•ä¸€èŒè´£åŸåˆ™</h4><blockquote><p>a class should have only a single responsibility (i.e. only changes to one part of the softwareâ€™s specification should be able to affect the specification of the class).</p></blockquote><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªèŒè´£ã€‚ä¸èƒ½æœ‰å¤šä¸ªå¯¼è‡´ç±»å˜æ›´çš„åŸå› ã€‚</p><p>è®©ç±»çš„èŒè´£å•ä¸€ï¼Œåªéœ€è¦è´Ÿè´£è‡ªå·±éƒ¨åˆ†ï¼Œå¤æ‚åº¦å°±ä¼šé™ä½ï¼Œä»£ç ç»´æŠ¤èµ·æ¥ä¹Ÿæ›´åŠ å®¹æ˜“ã€‚åŸåˆ™ä¸ä»…ä»…é€‚ç”¨äºç±»ï¼Œå¯¹äºæ¥å£å’Œæ–¹æ³•ä¹Ÿé€‚ç”¨ï¼Œå³ä¸€ä¸ªæ¥å£/æ–¹æ³•ï¼Œåªè´Ÿè´£ä¸€ä»¶äº‹ï¼Œè¿™æ ·çš„è¯ï¼Œæ¥å£å°±ä¼šå˜å¾—ç®€å•ï¼Œæ–¹æ³•ä¸­çš„ä»£ç ä¹Ÿä¼šæ›´å°‘ï¼Œæ˜“è¯»ï¼Œä¾¿äºç»´æŠ¤ã€‚<strong>äº‹å®ä¸Šï¼Œç”±äºä¸€äº›å…¶ä»–çš„å› ç´ å½±å“ï¼Œç±»çš„å•ä¸€èŒè´£åœ¨é¡¹ç›®ä¸­æ˜¯å¾ˆéš¾ä¿è¯çš„ã€‚é€šå¸¸ï¼Œæ¥å£å’Œæ–¹æ³•çš„å•ä¸€èŒè´£æ›´å®¹æ˜“å®ç°ã€‚</strong></p><p>å¥½å¤„ï¼š</p><blockquote><p>ä»£ç çš„ç²’åº¦é™ä½äº†ï¼Œç±»çš„å¤æ‚åº¦é™ä½äº†ã€‚</p><p>å¯è¯»æ€§æé«˜äº†ï¼Œæ¯ä¸ªç±»çš„èŒè´£éƒ½å¾ˆæ˜ç¡®ï¼Œå¯è¯»æ€§è‡ªç„¶æ›´å¥½ã€‚</p><p>å¯ç»´æŠ¤æ€§æé«˜äº†ï¼Œå¯è¯»æ€§æé«˜äº†ï¼Œä¸€æ—¦å‡ºç° <code>bug</code> ï¼Œè‡ªç„¶æ›´å®¹æ˜“æ‰¾åˆ°ä»–é—®é¢˜æ‰€åœ¨ã€‚</p><p>æ”¹åŠ¨ä»£ç æ‰€æ¶ˆè€—çš„èµ„æºé™ä½äº†ï¼Œæ›´æ”¹çš„é£é™©ä¹Ÿé™ä½äº†ã€‚</p><p>é«˜å†…èšã€ä½è€¦åˆ</p></blockquote><p>å‡è®¾æœ‰ä¸€ç±»Cï¼Œå«æœ‰loggingã€orderã€pay3ä¸ªæ–¹æ³•ï¼Œå®åˆ™å°±è¿™ä¸ªç±»å°±ä¸æ˜¯å•ä¸€æŒ‡è´£äº†ï¼ŒæŒ‰è¦æ±‚åæˆ‘ä»¬ä¿ç•™å•ä¸€æŒ‡è´£orderæ–¹æ³•ã€‚åæœŸéœ€æ±‚æ¥äº†ï¼Œæˆ‘ä»¬è¦å¯¹orderæ–¹æ³•è¿›è¡Œä¿®æ”¹ï¼Œäº§ç”Ÿäº†order1å’Œorder2ï¼Œå°½é‡åœ¨æ–¹æ³•çº§åˆ«ä¿ç•™äº†å•ä¸€æŒ‡è´£ï¼Œæˆ–è€…è¿™ä¸ªæ—¶å€™ä¿®æ”¹ä¸ºç±»C1å’ŒC2ï¼Œéƒ½æœ‰orderæ–¹æ³•ã€‚è¿™ä¸¤ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¾€å¾€é€‰æ‹©å‰è€…è¾ƒå¤šï¼Œä½†æ˜¯æœ‰äº›2è€…éƒ½ä¸é€‰æ‹©ï¼Œç›´æ¥å°±åœ¨ç±»Cä¸­orderæ–¹æ³•è¿›è¡Œä¿®æ”¹ï¼Œæ”¯æŒå¤šç§éœ€æ±‚ï¼Œåœ¨è¿™ä¸€æ­¥å°±è¿æ³•å•ä¸€æŒ‡è´£ã€‚éœ€æ±‚æœ‰å¯èƒ½åœ¨æœªæ¥å¯¼è‡´orderæ–¹æ³•æ‰©æ•£åˆ°nä¸ªã€‚è®°ä½ï¼Œåœ¨æŒ‡è´£æ‰©æ•£åˆ°æ— æ³•æ§åˆ¶æ—¶ï¼Œä¸€å®šè¦é‡æ„ã€‚</p><h4 id="å¼€é—­åŸåˆ™"><a href="#å¼€é—­åŸåˆ™" class="headerlink" title="å¼€é—­åŸåˆ™"></a>å¼€é—­åŸåˆ™</h4><blockquote><p><em>software entities (classes, modules, functions, etc.)</em> should be open for extension, but closed for modification.</p></blockquote><p>è½¯ä»¶å®ä½“å¦‚ç±»ã€æ¨¡å—ã€æ–¹æ³•ç­‰å¯¹äºæ‰©å±•å¼€æ”¾çš„ï¼Œä½†æ˜¯å¯¹äºä¿®æ”¹å°é—­çš„ã€‚</p><p>æˆ‘ä»¬è¯•æƒ³ä¸€ä¸‹ï¼Œäº§å“æ¥éœ€æ±‚äº†ï¼Œå¯¹æˆ‘ä»¬åŸæœ‰çš„ä»£ç è¦è¿›è¡Œå‡çº§æˆ–è€…æ”¹å˜çš„æ—¶å€™ï¼Œå¯èƒ½æˆ‘ä»¬åœ¨ä¿®æ”¹æ—§çš„ä¸šåŠ¡ä»£ç æ—¶ï¼Œå¾€å¾€ä¹Ÿä¼šæ–°å¢æ–°çš„<code>bug</code>ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæœ‰å¯èƒ½å› ä¸ºåŠŸèƒ½å¤æ‚æƒ…å†µä¸‹è¦å¯¹æ•´ä¸ªåŠŸèƒ½è¿›è¡Œé‡æ„ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±åº”è¯¥æƒ³åˆ°å¼€é—­åŸåˆ™ï¼Œé€šè¿‡æ‰©å±•å®ç°æ”¹å˜è€Œä¸æ˜¯ä¿®æ”¹åŸæœ‰çš„ä¸œè¥¿ã€‚</p><p>æœ‰æ²¡æœ‰æ„Ÿè§‰ï¼Œå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚è¯´èµ·æ¥å¾ˆç®€å•ï¼Œæ„Ÿè§‰åƒå•¥ä¹Ÿæ²¡è¯´ä¸€æ ·ï¼Œå…·ä½“èµ·æ¥è¯¥å¦‚ä½•åšã€‚</p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvT3BlbuKAk2Nsb3NlZF9wcmluY2lwbGU=" title="https://en.wikipedia.org/wiki/Openâ€“closed_principle">Openâ€“closed principle<i class="fa fa-external-link"></i></span>ä¸­ä¸€æ–‡æœ‰æè¿°ï¼Œ<strong>é€šè¿‡ç»§æ‰¿æŠ½è±¡ç±»å’Œå®ç°æ¥å£</strong>ã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fyvopfwrl1j329w0b6ae5.jpg" alt="img"></p><p>å…¶å®ï¼Œè¿™ä¹Ÿæ­£æ˜¯æˆ‘ä»¬é¢å‘å¯¹è±¡ä¸­çš„æ¡†æ¶è®¾è®¡â€”â€“<strong>æŠ½è±¡</strong>ï¼Œç”¨æŠ½è±¡æ„å»ºæ¡†æ¶ï¼Œç”¨å®ç°æ‰©å±•ç»†èŠ‚ã€‚æˆ‘ä»¬é˜Ÿæ¡†æ¶è¿›è¡Œå…³é—­ï¼Œé€šè¿‡å®ç°ç»†èŠ‚è¿›è¡Œå¼€æ”¾ã€‚è€Œæˆ‘ä»¬çš„ä¸šåŠ¡å¸¸å¸¸å°±æ˜¯è¿™äº›ç»†èŠ‚ï¼Œé€šè¿‡ç»†èŠ‚çš„å®ç°ï¼Œæˆ‘ä»¬å°±èƒ½å®Œæˆæ‰©å±•ã€‚ä½†æ˜¯å‰ææ˜¯æˆ‘ä»¬çš„æ¡†æ¶è¦è¶³å¤ŸæŠ½è±¡åŒ–ï¼Œå…·æœ‰é’ˆå¯¹éœ€æ±‚çš„æ»¡è¶³æ€§ï¼Œè¦æœ‰è¶³å¤Ÿçš„é¢„åŸ‹æ€§ï¼Œè¿™å…¶å®ä¹Ÿæ˜¯éœ€è¦ä¸€å®šçš„ç»éªŒã€‚</p><h4 id="é‡Œæ°æ›¿æ¢åŸåˆ™"><a href="#é‡Œæ°æ›¿æ¢åŸåˆ™" class="headerlink" title="é‡Œæ°æ›¿æ¢åŸåˆ™"></a>é‡Œæ°æ›¿æ¢åŸåˆ™</h4><blockquote><p>objects in a program should be replaceable with instances of their subtypes without altering the correctness of that program.</p></blockquote><p>ç¨‹åºä¸­çš„å¯¹è±¡åº”è¯¥æ˜¯å¯ä»¥åœ¨ä¸æ”¹å˜ç¨‹åºæ­£ç¡®æ€§çš„å‰æä¸‹è¢«å®ƒçš„å­ç±»æ‰€æ›¿æ¢çš„ã€‚ç®€å•ç‚¹ï¼Œå°±æ˜¯æˆ‘ç”¨åŸºç±»ä»£æ›¿å­ç±»çš„è¯ï¼Œç¨‹åºè¿˜æ˜¯ä¸€æ ·çš„ï¼Œæ˜¯å¯¹çš„ã€‚</p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGlza292X3N1YnN0aXR1dGlvbl9wcmluY2lwbGU=" title="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov substitution principle<i class="fa fa-external-link"></i></span>æœ‰è®²æ˜é‡Œæ°æ›¿æ¢åŸåˆ™çš„æ¥è·¯ã€‚<strong>Barbara Liskov</strong>å¥³å£«æå‡ºæ¥çš„ã€‚</p><p><span class="exturl" data-url="aHR0cDovL3d3dy5lbmdyLm11bi5jYS9+dGhlby9Db3Vyc2VzL3NkLzU4OTUtZG93bmxvYWRzL3NkLXByaW5jaXBsZXMtMy5wcHQucGRm" title="http://www.engr.mun.ca/~theo/Courses/sd/5895-downloads/sd-principles-3.ppt.pdf">PDFä¸­æœ‰ç›¸å…³çš„ä»‹ç»<i class="fa fa-external-link"></i></span></p><p>æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼š</p><blockquote><p>å®šä¹‰1ï¼šå¦‚æœå¯¹æ¯ä¸€ä¸ªç±»å‹ä¸º T1çš„å¯¹è±¡ o1ï¼Œéƒ½æœ‰ç±»å‹ä¸º T2 çš„å¯¹è±¡o2ï¼Œä½¿å¾—ä»¥ T1å®šä¹‰çš„æ‰€æœ‰ç¨‹åº P åœ¨æ‰€æœ‰çš„å¯¹è±¡ o1 éƒ½ä»£æ¢æˆ o2 æ—¶ï¼Œç¨‹åº P çš„è¡Œä¸ºæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç±»å‹ T2 æ˜¯ç±»å‹ T1 çš„å­ç±»å‹ã€‚</p><p>å®šä¹‰2ï¼šæ‰€æœ‰å¼•ç”¨åŸºç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ã€‚</p></blockquote><p>é€šä¿—ç‚¹ç†è§£ï¼š</p><blockquote><p>ä¾‹å¦‚æœ‰ä¸¤ä¸ªç±»ï¼Œä¸€ä¸ªç±»ä¸ºBaseClassï¼Œå¦ä¸€ä¸ªæ˜¯SubClassç±»ï¼Œå¹¶ä¸”SubClassç±»æ˜¯BaseClassç±»çš„å­ç±»ï¼Œé‚£ä¹ˆä¸€ä¸ªæ–¹æ³•å¦‚æœå¯ä»¥æ¥å—ä¸€ä¸ªBaseClassç±»å‹çš„åŸºç±»å¯¹è±¡baseçš„è¯ï¼Œå¦‚ï¼šmethod1(base)ï¼Œé‚£ä¹ˆå®ƒå¿…ç„¶å¯ä»¥æ¥å—ä¸€ä¸ªBaseClassç±»å‹çš„å­ç±»å¯¹è±¡subï¼Œmethod1(sub)èƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚åè¿‡æ¥çš„ä»£æ¢ä¸æˆç«‹ï¼Œå¦‚ä¸€ä¸ªæ–¹æ³•method2æ¥å—BaseClassç±»å‹çš„å­ç±»å¯¹è±¡subä¸ºå‚æ•°ï¼šmethod2(sub)ï¼Œé‚£ä¹ˆä¸€èˆ¬è€Œè¨€ä¸å¯ä»¥æœ‰method2(base)ï¼Œé™¤éæ˜¯é‡è½½æ–¹æ³•ã€‚</p></blockquote><p>é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯å®ç°å¼€é—­åŸåˆ™çš„é‡è¦æ–¹å¼ä¹‹ä¸€ï¼Œç”±äºä½¿ç”¨åŸºç±»å¯¹è±¡çš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å­ç±»å¯¹è±¡ï¼Œå› æ­¤<strong>åœ¨ç¨‹åºä¸­å°½é‡ä½¿ç”¨åŸºç±»ç±»å‹æ¥å¯¹å¯¹è±¡è¿›è¡Œå®šä¹‰ï¼Œè€Œåœ¨è¿è¡Œæ—¶å†ç¡®å®šå…¶å­ç±»ç±»å‹ï¼Œç”¨å­ç±»å¯¹è±¡æ¥æ›¿æ¢çˆ¶ç±»å¯¹è±¡</strong>ã€‚</p><p>åœ¨ä½¿ç”¨é‡Œæ°ä»£æ¢åŸåˆ™æ—¶éœ€è¦æ³¨æ„å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><blockquote><p>(1)å­ç±»çš„æ‰€æœ‰æ–¹æ³•å¿…é¡»åœ¨çˆ¶ç±»ä¸­å£°æ˜ï¼Œæˆ–å­ç±»å¿…é¡»å®ç°çˆ¶ç±»ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•ã€‚æ ¹æ®é‡Œæ°ä»£æ¢åŸåˆ™ï¼Œä¸ºäº†ä¿è¯ç³»ç»Ÿçš„æ‰©å±•æ€§ï¼Œåœ¨ç¨‹åºä¸­é€šå¸¸ä½¿ç”¨çˆ¶ç±»æ¥è¿›è¡Œå®šä¹‰ï¼Œå¦‚æœä¸€ä¸ªæ–¹æ³•åªå­˜åœ¨å­ç±»ä¸­ï¼Œåœ¨çˆ¶ç±»ä¸­ä¸æä¾›ç›¸åº”çš„å£°æ˜ï¼Œåˆ™æ— æ³•åœ¨ä»¥çˆ¶ç±»å®šä¹‰çš„å¯¹è±¡ä¸­ä½¿ç”¨è¯¥æ–¹æ³•ã€‚</p><p>(2) æˆ‘ä»¬åœ¨è¿ç”¨é‡Œæ°ä»£æ¢åŸåˆ™æ—¶ï¼Œå°½é‡æŠŠçˆ¶ç±»è®¾è®¡ä¸ºæŠ½è±¡ç±»æˆ–è€…æ¥å£ï¼Œè®©å­ç±»ç»§æ‰¿çˆ¶ç±»æˆ–å®ç°çˆ¶æ¥å£ï¼Œå¹¶å®ç°åœ¨çˆ¶ç±»ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œè¿è¡Œæ—¶ï¼Œå­ç±»å®ä¾‹æ›¿æ¢çˆ¶ç±»å®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰©å±•ç³»ç»Ÿçš„åŠŸèƒ½ï¼ŒåŒæ—¶æ— é¡»ä¿®æ”¹åŸæœ‰å­ç±»çš„ä»£ç ï¼Œå¢åŠ æ–°çš„åŠŸèƒ½å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªæ–°çš„å­ç±»æ¥å®ç°ã€‚é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯å¼€é—­åŸåˆ™çš„å…·ä½“å®ç°æ‰‹æ®µä¹‹ä¸€ã€‚</p><p>(3) Javaè¯­è¨€ä¸­ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µï¼ŒJavaç¼–è¯‘å™¨ä¼šæ£€æŸ¥ä¸€ä¸ªç¨‹åºæ˜¯å¦ç¬¦åˆé‡Œæ°ä»£æ¢åŸåˆ™ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å®ç°æ— å…³çš„ã€çº¯è¯­æ³•æ„ä¹‰ä¸Šçš„æ£€æŸ¥ï¼Œä½†Javaç¼–è¯‘å™¨çš„æ£€æŸ¥æ˜¯æœ‰å±€é™çš„ã€‚</p></blockquote><p><strong>é‡Œæ°æ›¿æ¢åŸåˆ™é€šä¿—çš„æ¥è®²å°±æ˜¯ï¼šå­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a-b;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">A a = <span class="keyword">new</span> A();</span><br><span class="line">System.out.println(<span class="string">"100-50="</span>+a.func1(<span class="number">100</span>, <span class="number">50</span>));</span><br><span class="line">System.out.println(<span class="string">"100-80="</span>+a.func1(<span class="number">100</span>, <span class="number">80</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><p>100-50=50</p><p>100-80=20</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> func1(a,b)+<span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">B b = <span class="keyword">new</span> B();</span><br><span class="line">System.out.println(<span class="string">"100-50="</span>+b.func1(<span class="number">100</span>, <span class="number">50</span>));</span><br><span class="line">System.out.println(<span class="string">"100-80="</span>+b.func1(<span class="number">100</span>, <span class="number">80</span>));</span><br><span class="line">System.out.println(<span class="string">"100+20+100="</span>+b.func2(<span class="number">100</span>, <span class="number">20</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»Bå®Œæˆåï¼Œè¿è¡Œç»“æœï¼š</p><p>100-50=150</p><p>100-80=180</p><p>100+20+100=220</p><p>é€šè¿‡è¿™ä¸ªä¸¾ä¾‹å¯ä»¥çœ‹å‡ºå­ç±»æ”¹å˜äº†çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½ï¼Œå­ç±»æ— æ„æˆ–è€…æœ‰æ„é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ã€‚å¯¼è‡´æœ¬æ¥çš„å‡æ³•å˜æˆäº†åŠ æ³•ã€‚</p><h4 id="æ¥å£éš”ç¦»åŸåˆ™"><a href="#æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="æ¥å£éš”ç¦»åŸåˆ™"></a>æ¥å£éš”ç¦»åŸåˆ™</h4><blockquote><p>many client-specific interfaces are better than one general-purpose interface.</p></blockquote><p>å¤šä¸ªç‰¹å®šå®¢æˆ·ç«¯æ¥å£è¦å¥½äºä¸€ä¸ªå®½æ³›ç”¨é€”çš„æ¥å£ã€‚</p><p>å»ºç«‹å•ä¸€æ¥å£ï¼Œä¸è¦å»ºç«‹åºå¤§è‡ƒè‚¿çš„æ¥å£ï¼Œå°½é‡ç»†åŒ–æ¥å£ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å°½é‡å°‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦ä¸ºå„ä¸ªç±»å»ºç«‹ä¸“ç”¨çš„æ¥å£ï¼Œè€Œä¸è¦è¯•å›¾å»å»ºç«‹ä¸€ä¸ªå¾ˆåºå¤§çš„æ¥å£ä¾›æ‰€æœ‰ä¾èµ–å®ƒçš„ç±»å»è°ƒç”¨ã€‚<strong>å°†ä¸€ä¸ªåºå¤§çš„æ¥å£å˜æ›´ä¸ºå¤šä¸ªä¸“ç”¨çš„æ¥å£æ‰€é‡‡ç”¨çš„å°±æ˜¯æ¥å£éš”ç¦»åŸåˆ™ã€‚</strong></p><p>ä¾‹å¦‚ï¼šæ¥å£Iæœ‰5ä¸ªæ–¹æ³•M1,M2,M3,M4,M5ï¼Œå‡è®¾ç°åœ¨æœ‰3ä¸ªå®ç°ç±»C1å®ç°5åˆ†æ–¹æ³•ï¼Œå®ç°ç±»C2åªå®ç°å‰é¢3ä¸ªæ–¹æ³•M1,M2,M3å…¶ä»–2ä¸ªåˆ™æ˜¯ç©ºå®ç°ï¼Œå®ç°ç±»C3åªå®ç°M4,M5å…¶ä»–3ä¸ªåˆ™æ˜¯ç©ºå®ç°ã€‚è¿™ä¸ªæ—¶å€™å°±ä½“ç°å‡ºæ¥å£åºå¤§äº†ã€‚æ­¤æ—¶åº”å°†æ¥å£Iæ‹†åˆ†æˆæ¥å£I1æœ‰æ–¹æ³•M1,M2,M3ï¼Œæ¥å£I2æœ‰æ–¹æ³•M4,M5ã€‚è€Œå®ç°ç±»C1å®ç°æ¥å£I1å’ŒI2ï¼Œå®ç°ç±»C2å®ç°æ¥å£I1ï¼Œå®ç°ç±»C3å®ç°æ¥å£I2ã€‚</p><p>æ¥å£éš”ç¦»åŸåˆ™è·Ÿå•ä¸€èŒè´£åŸåˆ™å¾ˆç›¸ä¼¼ã€‚å…¶å®ä¸ç„¶ã€‚å…¶ä¸€ï¼Œå•ä¸€èŒè´£åŸåˆ™åŸæ³¨é‡çš„æ˜¯èŒè´£ï¼›è€Œæ¥å£éš”ç¦»åŸåˆ™æ³¨é‡å¯¹æ¥å£ä¾èµ–çš„éš”ç¦»ã€‚å…¶äºŒï¼Œå•ä¸€èŒè´£åŸåˆ™ä¸»è¦æ˜¯çº¦æŸç±»ï¼Œå…¶æ¬¡æ‰æ˜¯æ¥å£å’Œæ–¹æ³•ï¼Œå®ƒé’ˆå¯¹çš„æ˜¯ç¨‹åºä¸­çš„å®ç°å’Œç»†èŠ‚ï¼›è€Œæ¥å£éš”ç¦»åŸåˆ™ä¸»è¦çº¦æŸæ¥å£æ¥å£ï¼Œä¸»è¦é’ˆå¯¹æŠ½è±¡ï¼Œé’ˆå¯¹ç¨‹åºæ•´ä½“æ¡†æ¶çš„æ„å»ºã€‚</p><p>é‡‡ç”¨æ¥å£éš”ç¦»åŸåˆ™å¯¹æ¥å£è¿›è¡Œçº¦æŸæ—¶ï¼Œè¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><blockquote><p>æ¥å£å°½é‡å°ï¼Œä½†æ˜¯è¦æœ‰é™åº¦ã€‚å¯¹æ¥å£è¿›è¡Œç»†åŒ–å¯ä»¥æé«˜ç¨‹åºè®¾è®¡çµæ´»æ€§æ˜¯ä¸æŒ£çš„äº‹å®ï¼Œä½†æ˜¯å¦‚æœè¿‡å°ï¼Œåˆ™ä¼šé€ æˆæ¥å£æ•°é‡è¿‡å¤šï¼Œä½¿è®¾è®¡å¤æ‚åŒ–ã€‚æ‰€ä»¥ä¸€å®šè¦é€‚åº¦ã€‚</p><p>ä¸ºä¾èµ–æ¥å£çš„ç±»å®šåˆ¶æœåŠ¡ï¼Œåªæš´éœ²ç»™è°ƒç”¨çš„ç±»å®ƒéœ€è¦çš„æ–¹æ³•ï¼Œå®ƒä¸éœ€è¦çš„æ–¹æ³•åˆ™éšè—èµ·æ¥ã€‚åªæœ‰ä¸“æ³¨åœ°ä¸ºä¸€ä¸ªæ¨¡å—æä¾›å®šåˆ¶æœåŠ¡ï¼Œæ‰èƒ½å»ºç«‹æœ€å°çš„ä¾èµ–å…³ç³»ã€‚</p><p>æé«˜å†…èšï¼Œå‡å°‘å¯¹å¤–äº¤äº’ã€‚ä½¿æ¥å£ç”¨æœ€å°‘çš„æ–¹æ³•å»å®Œæˆæœ€å¤šçš„äº‹æƒ…ã€‚</p></blockquote><p>è¿ç”¨æ¥å£éš”ç¦»åŸåˆ™ï¼Œä¸€å®šè¦é€‚åº¦ï¼Œæ¥å£è®¾è®¡çš„è¿‡å¤§æˆ–è¿‡å°éƒ½ä¸å¥½ã€‚è®¾è®¡æ¥å£çš„æ—¶å€™ï¼Œåªæœ‰å¤šèŠ±äº›æ—¶é—´å»æ€è€ƒå’Œç­¹åˆ’ï¼Œæ‰èƒ½å‡†ç¡®åœ°å®è·µè¿™ä¸€åŸåˆ™ã€‚</p><h4 id="ä¾èµ–å€’ç½®åŸåˆ™"><a href="#ä¾èµ–å€’ç½®åŸåˆ™" class="headerlink" title="ä¾èµ–å€’ç½®åŸåˆ™"></a>ä¾èµ–å€’ç½®åŸåˆ™</h4><blockquote><p>one should â€œdepend upon abstractions, [not] concretions.</p></blockquote><p>ä¾èµ–äºæŠ½è±¡è€Œä¸æ˜¯ä¸€ä¸ªå®ä¾‹ã€‚å…¶å®æƒ³æƒ³ä¾èµ–æ³¨å…¥æ˜¯è¯¥åŸåˆ™çš„ä¸€ç§å®ç°æ–¹å¼ã€‚</p><p>The principle states:</p><blockquote><ol><li>High-level modules should not depend on low-level modules. Both should depend on <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQWJzdHJhY3Rpb25fKGNvbXB1dGVyX3NjaWVuY2U=" title="https://en.wikipedia.org/wiki/Abstraction_(computer_science">abstractions<i class="fa fa-external-link"></i></span>).</li><li>Abstractions should not depend on details. Details should depend on abstractions.</li></ol></blockquote><p>ç¿»è¯‘è¿‡æ¥æ˜¯ï¼šé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ã€‚æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ã€‚ç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚</p><p>åœ¨Javaè¯­è¨€ä¸­çš„è¡¨ç°å°±æ˜¯ï¼šæ¨¡å—é—´çš„ä¾èµ–é€šè¿‡æŠ½è±¡å‘ç”Ÿï¼Œå®ç°ç±»ä¹‹é—´ä¸å‘ç”Ÿç›´æ¥çš„ä¾èµ–å…³ç³»ï¼Œå…¶ä¾èµ–å…³ç³»æ˜¯é€šè¿‡æ¥å£æˆ–æŠ½è±¡ç±»äº§ç”Ÿçš„ã€‚æ¥å£æˆ–æŠ½è±¡ç±»ä¸ä¾èµ–äºå®ç°ç±»ã€‚å®ç°ç±»ä¾èµ–äºæ¥å£æˆ–æŠ½è±¡ç±»ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œå°½å¯èƒ½çš„ä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œå³æ‰€è°“çš„<strong>é¢å‘æ¥å£ç¼–ç¨‹</strong>ã€‚</p><p>ä¾èµ–å€’è½¬åŸåˆ™è¦æ±‚æˆ‘ä»¬åœ¨ç¨‹åºä»£ç ä¸­ä¼ é€’å‚æ•°æ—¶æˆ–åœ¨å…³è”å…³ç³»ä¸­ï¼Œå°½é‡å¼•ç”¨å±‚æ¬¡é«˜çš„æŠ½è±¡å±‚ç±»ï¼Œå³ä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»è¿›è¡Œå˜é‡ç±»å‹å£°æ˜ã€å‚æ•°ç±»å‹å£°æ˜ã€æ–¹æ³•è¿”å›ç±»å‹å£°æ˜ï¼Œä»¥åŠæ•°æ®ç±»å‹çš„è½¬æ¢ç­‰ï¼Œè€Œä¸è¦ç”¨å…·ä½“ç±»æ¥åšè¿™äº›äº‹æƒ…ã€‚ä¸ºäº†ç¡®ä¿è¯¥åŸåˆ™çš„åº”ç”¨ï¼Œä¸€ä¸ªå…·ä½“ç±»åº”å½“åªå®ç°æ¥å£æˆ–æŠ½è±¡ç±»ä¸­å£°æ˜è¿‡çš„æ–¹æ³•ï¼Œè€Œä¸è¦ç»™å‡ºå¤šä½™çš„æ–¹æ³•ï¼Œå¦åˆ™å°†æ— æ³•è°ƒç”¨åˆ°åœ¨å­ç±»ä¸­å¢åŠ çš„æ–°æ–¹æ³•ã€‚</p><p><img src="https://upload.wikimedia.org/wikipedia/commons/9/96/Dependency_inversion.png" alt="Dependency inversion.png"></p><p>è¿™å¼ å›¾ï¼Œå…¶å®å°±å¾ˆå¥½çš„è¡¨è¾¾äº†ä¾èµ–å€’ç½®åŸåˆ™ï¼ŒObjectBåº”è¯¥ä¾èµ–InterfaceAå»ç”³æ˜ObjectAè€Œéç›´æ¥å»ä¾èµ–ObjectAï¼Œè€ŒObjectAä¹Ÿåº”è¯¥ä¾èµ–InterfaceAï¼Œè¿™å°±æ˜¯<strong>é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡</strong>å’Œ<strong>ç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡</strong>ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä¸‹çš„ç¤ºä¾‹ï¼Œåˆšå¼€å§‹ï¼Œå­¦ç”Ÿåªæ˜¯ç®€å•çš„å®Œæˆå­¦æ ¡é‡Œçš„ç™½å¤©è¯¾å ‚ä½œä¸šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SchoolWork</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å­¦ç”Ÿæ¯å¤©åœ¨å­¦æ ¡å°±å®Œæˆè¯¾å ‚ä½œä¸šäº†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">(SchoolWork schoolWork)</span> </span>&#123;</span><br><span class="line">        schoolWork.work();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®¢æˆ·ç«¯è°ƒç”¨</span></span><br><span class="line">Student student = <span class="keyword">new</span> Student();</span><br><span class="line">SchoolWork work = <span class="keyword">new</span> SchoolWork();</span><br><span class="line">student.work(work);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°ï¼Œå­¦ç”Ÿæ¯å¤©éƒ½åœ¨è¯¾å ‚ä¸Šå°±å®Œæˆäº†ä½œä¸šï¼Œä½†æ˜¯éšç€æ—¶é—´æ…¢æ…¢çš„è¿‡å»ï¼Œå­¦ç”Ÿä»¬ï¼Œè¯¾å ‚ä½œä¸šå˜å¤šäº†ï¼Œè€å¸ˆå¼€å§‹å¸ƒç½®å®¶åº­ä½œä¸šäº†ã€‚é‚£ä¹ˆStudentç±»ä¸­å†å†™ä¸€ä¸ªå†™å®¶åº­ä½œä¸šçš„æ–¹æ³•å˜›ï¼Œä¸‡ä¸€è€å¸ˆåˆç»™å­¦ç”Ÿå¸ƒç½®å…¶ä»–ä½œä¸šåˆå†™ä¸€ç§æ–¹æ³•å—ï¼Œè‚¯å®šä¸æ˜¯çš„å•¦ã€‚</p><p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦æŠŠä½œä¸šæŠ½è±¡èµ·æ¥äº†ï¼Œç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»éƒ½å¯ä»¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Work</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SchoolWork</span> <span class="keyword">implements</span> <span class="title">Work</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å­¦ç”Ÿæ¯å¤©åœ¨å­¦æ ¡å°±å®Œæˆè¯¾å ‚ä½œä¸šäº†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeWork</span> <span class="keyword">implements</span> <span class="title">Work</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å­¦ç”Ÿæ¯å¤©åœ¨å®¶å°±å®Œæˆå®¶åº­ä½œä¸šäº†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">(Work work)</span> </span>&#123;</span><br><span class="line">        work.work();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®¢æˆ·ç«¯è°ƒç”¨</span></span><br><span class="line">Student student = <span class="keyword">new</span> Student();</span><br><span class="line">Work work = <span class="keyword">new</span> SchoolWork();</span><br><span class="line">student.work(work);</span><br><span class="line">work = <span class="keyword">new</span> HomeWork();</span><br><span class="line">student.work(work);</span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯é¢å‘æ¥å£ç¼–ç¨‹ã€‚Work work = new SchoolWork();å’Œwork = new HomeWork();å°±æ˜¯<strong>å˜é‡çš„å£°æ˜ç±»å‹å°½é‡æ˜¯æŠ½è±¡ç±»æˆ–è€…æ¥å£</strong>ã€‚</p><p>åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éœ€è¦åšåˆ°å¦‚ä¸‹3ç‚¹ï¼š</p><blockquote><ul><li>ä½å±‚æ¨¡å—å°½é‡éƒ½è¦æœ‰æŠ½è±¡ç±»æˆ–æ¥å£ï¼Œæˆ–è€…ä¸¤è€…éƒ½æœ‰ã€‚</li><li>å˜é‡çš„å£°æ˜ç±»å‹å°½é‡æ˜¯æŠ½è±¡ç±»æˆ–æ¥å£ã€‚</li><li>ä½¿ç”¨ç»§æ‰¿æ—¶éµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™ã€‚</li></ul></blockquote><h4 id="è¿ªç±³ç‰¹æ³•åˆ™"><a href="#è¿ªç±³ç‰¹æ³•åˆ™" class="headerlink" title="è¿ªç±³ç‰¹æ³•åˆ™"></a>è¿ªç±³ç‰¹æ³•åˆ™</h4><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGF3X29mX0RlbWV0ZXI=" title="https://en.wikipedia.org/wiki/Law_of_Demeter">From Wikipedia, the free encyclopedia<i class="fa fa-external-link"></i></span></p><blockquote><p>Each unit should have only limited knowledge about other units: only units â€œcloselyâ€ related to the current unit.<br>Each unit should only talk to its friends; donâ€™t talk to strangers.<br>Only talk to your immediate friends.</p></blockquote><p>æ¯ä¸ªå•ä½å¯¹å…¶ä»–å•ä½çš„äº†è§£åº”è¯¥æ˜¯æœ‰é™ï¼Œé™¤äº†è·Ÿè‡ªå·±ç›¸å¯¹å¯†åˆ‡çš„å•ä½ã€‚çš„ä¸è¦å’Œé™Œç”Ÿäººè¯´è¯å•Šï¼Œåªä¸ç›´æ¥çš„æœ‹å‹é€šä¿¡ã€‚</p><p>çœ‹å®Œä¹‹åï¼Œæ˜¯ä¸æ˜¯äº‘é‡Œé›¾é‡Œï¼Œä¸çŸ¥é“è¯´ä»€ä¹ˆé¸Ÿè¯­èŠ±é¦™ã€‚å…¶å®å°±æ˜¯ï¼Œä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡ä¿æŒæœ€å°‘çš„äº†è§£ã€‚å•Šï¼Œä½ è¿˜æ˜¯ä¸çŸ¥é“å®ƒè¯´äº†ä¸ªå•¥ã€‚é€šä¿—çš„è®²å°±æ˜¯ä¸€ä¸ªç±»å¯¹è‡ªå·±ä¾èµ–çš„ç±»çŸ¥é“çš„è¶Šå°‘è¶Šå¥½ï¼Œä¹Ÿå°±æ˜¯å¯¹äºè¢«ä¾èµ–çš„ç±»ï¼Œå‘å¤–å…¬å¼€çš„æ–¹æ³•åº”è¯¥å°½å¯èƒ½çš„å°‘(å°½å¯èƒ½çš„ä¸ç”¨ç”¨publicä¿®é¥°æ–¹æ³•)ã€‚å¯¹äºä¸Šé¢çš„æœ‹å‹çš„å®šä¹‰æ¥è®²ï¼Œä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„è€¦åˆå…³ç³»ç§°ä¹‹ä¸ºæœ‹å‹ï¼Œé€šå¸¸æœ‰ä¾èµ–ã€å…³è”ã€èšåˆå’Œç»„æˆç­‰ã€‚è€Œç›´æ¥æœ‹å‹åˆ™é€šå¸¸è¡¨ç°ä¸ºå…³è”ã€èšåˆå’Œç»„æˆå…³ç³»ï¼Œå³ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´è”ç³»æ›´ä¸ºç´§å¯†ï¼Œé€šå¸¸ä»¥æˆå‘˜å˜é‡ã€æ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼çš„å½¢å¼å‡ºç°ã€‚åŒæ—¶äº†é™Œç”Ÿçš„ç±»æœ€å¥½ä¸è¦ä½œä¸ºå±€éƒ¨å˜é‡çš„å½¢å¼å‡ºç°åœ¨ç±»çš„å†…éƒ¨ã€‚</p><p>æœ‹å‹äº†ä¹Ÿæ˜¯æœ‰è¿™æ ·å‡ ç§å®šä¹‰çš„</p><blockquote><p>å½“å‰å¯¹è±¡æœ¬èº«(this)ï¼›</p><p>ä»¥å‚æ•°å½¢å¼ä¼ å…¥åˆ°å½“å‰å¯¹è±¡æ–¹æ³•ä¸­çš„å¯¹è±¡ï¼›</p><p>å½“å‰å¯¹è±¡çš„æˆå‘˜å¯¹è±¡ï¼Œå¦‚æœå½“å‰å¯¹è±¡çš„æˆå‘˜å¯¹è±¡æ˜¯ä¸€ä¸ªé›†åˆï¼Œé‚£ä¹ˆé›†åˆä¸­çš„å…ƒç´ ä¹Ÿéƒ½æ˜¯æœ‹å‹ï¼›</p><p>å½“å‰å¯¹è±¡æ‰€åˆ›å»ºçš„å¯¹è±¡ã€‚</p></blockquote><p>æ¥çœ‹ä¸ªç¤ºä¾‹ï¼Œå…³è®¡ç®—æœºçš„ä¸šåŠ¡ã€‚ ä¸»è¦æ˜¯é’ˆå¯¹åªæš´éœ²åº”è¯¥æš´éœ²çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®¡ç®—æœºç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveCurrentTask</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeScreen</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closePower</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</span><br><span class="line">        saveCurrentTask();</span><br><span class="line">        closeService();</span><br><span class="line">        closeScreen();</span><br><span class="line">        closePower();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//äºº</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Computer c;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clickCloseButton</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="comment">//ç°åœ¨ä½ è¦å¼€å§‹å…³é—­è®¡ç®—æœºäº†ï¼Œæ­£å¸¸æ¥è¯´ä½ åªéœ€è¦è°ƒç”¨closeï¼ˆï¼‰æ–¹æ³•å³å¯ï¼Œ</span></span><br><span class="line">      <span class="comment">//ä½†æ˜¯ä½ å‘ç°Computeræ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯å…¬å¼€çš„ï¼Œè¯¥æ€ä¹ˆå…³é—­å‘¢ï¼Ÿäºæ˜¯ä½ å†™ä¸‹äº†ä»¥ä¸‹å…³é—­çš„æµç¨‹ï¼š        </span></span><br><span class="line">        c.saveCurrentTask();</span><br><span class="line">        c.closePower();</span><br><span class="line">        c.close();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//äº¦æˆ–æ˜¯ä»¥ä¸‹çš„æ“ä½œ        </span></span><br><span class="line">        c.closePower();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//è¿˜å¯èƒ½æ˜¯ä»¥ä¸‹çš„æ“ä½œ</span></span><br><span class="line">        c.close();</span><br><span class="line">        c.closePower();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»è¢«ä¾èµ–è€…çš„è§’åº¦ï¼Œåªåº”è¯¥æš´éœ²åº”è¯¥æš´éœ²çš„æ–¹æ³•ã€‚é‚£ä¹ˆè¿™é‡Œçš„cå¯¹è±¡åº”è¯¥å“ªäº›æ–¹æ³•åº”è¯¥æ˜¯è¢«æš´éœ²çš„å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶ï¼Œå¯¹äºPersonæ¥è¯´ï¼Œåªéœ€è¦å…³æ³¨è®¡ç®—æœºçš„å…³é—­æ“ä½œï¼Œè€Œä¸å…³å¿ƒè®¡ç®—æœºä¼šå¦‚ä½•å¤„ç†è¿™ä¸ªå…³é—­æ“ä½œï¼Œå› æ­¤åªéœ€è¦æš´éœ²<code>closeï¼ˆï¼‰</code>æ–¹æ³•å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®¡ç®—æœºç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">saveCurrentTask</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">closeService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">closeScreen</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">closePower</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</span><br><span class="line">        saveCurrentTask();</span><br><span class="line">        closeService();</span><br><span class="line">        closeScreen();</span><br><span class="line">        closePower();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//äºº</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Computer c;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">clickCloseButton</span><span class="params">()</span></span>&#123;</span><br><span class="line">       c.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼Œåªä¾èµ–åº”è¯¥ä¾èµ–çš„å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> D <span class="title">do</span><span class="params">(B b)</span> </span>&#123;</span><br><span class="line">        C c = b.getC().;</span><br><span class="line">        c.doSomething();</span><br><span class="line">        D d = c.getResult()</span><br><span class="line">        <span class="keyword">return</span> d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> C c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//.....</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> D <span class="title">getResult</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//.....</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> D();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">D</span> </span>&#123;</span><br><span class="line">    <span class="comment">//.......</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        A a = <span class="keyword">new</span> A();</span><br><span class="line">        B b = <span class="keyword">new</span> B();</span><br><span class="line">        System.out.println(a.<span class="keyword">do</span>(b));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå¯ä»¥çœ‹å‡ºï¼Œåœ¨Aç±»çš„doæ–¹æ³•ä¸­ï¼Œç±»Cå…¶å®ç›¸å¯¹äºç±»Aæ¥è¯´å°±æ˜¯é™Œç”Ÿäººï¼Œé«˜è€¦åˆåœ¨Aç±»ä¸­ã€‚å‡è®¾æ—¥åï¼Œæˆ‘ä»¬å¯¹Cç±»çš„doSomethingå’ŒgetResultæ–¹æ³•æ”¹åŠ¨æ—¶ï¼Œå°±ä¼šå½±å“åˆ°ç±»Aã€‚</p><p>è‡³äºå¦‚ä½•ä¿®æ”¹ï¼Œæƒ³çœ‹çœ‹çœ‹å®˜ä»¬æœ‰ä»€ä¹ˆå»ºè®®æˆ–è€…å®ç°ï¼Œæ¬¢è¿ç•™è¨€ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œåœ¨å°†è¿ªç±³ç‰¹æ³•åˆ™è¿ç”¨åˆ°ç³»ç»Ÿè®¾è®¡ä¸­æ—¶ï¼Œè¦æ³¨æ„ä¸‹é¢çš„å‡ ç‚¹ï¼šåœ¨ç±»çš„åˆ’åˆ†ä¸Šï¼Œåº”å½“å°½é‡åˆ›å»ºæ¾è€¦åˆçš„ç±»ï¼Œç±»ä¹‹é—´çš„è€¦åˆåº¦è¶Šä½ï¼Œå°±è¶Šæœ‰åˆ©äºå¤ç”¨ï¼Œä¸€ä¸ªå¤„åœ¨æ¾è€¦åˆä¸­çš„ç±»ä¸€æ—¦è¢«ä¿®æ”¹ï¼Œä¸ä¼šå¯¹å…³è”çš„ç±»é€ æˆå¤ªå¤§æ³¢åŠï¼›åœ¨ç±»çš„ç»“æ„è®¾è®¡ä¸Šï¼Œæ¯ä¸€ä¸ªç±»éƒ½åº”å½“å°½é‡é™ä½å…¶æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°çš„è®¿é—®æƒé™ï¼›åœ¨ç±»çš„è®¾è®¡ä¸Šï¼Œåªè¦æœ‰å¯èƒ½ï¼Œä¸€ä¸ªç±»å‹åº”å½“è®¾è®¡æˆä¸å˜ç±»ï¼›åœ¨å¯¹å…¶ä»–ç±»çš„å¼•ç”¨ä¸Šï¼Œä¸€ä¸ªå¯¹è±¡å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨åº”å½“é™åˆ°æœ€ä½ã€‚<strong>é«˜å†…èšï¼Œä½è€¦åˆã€‚</strong></p><h4 id="åˆæˆå¤ç”¨åŸåˆ™"><a href="#åˆæˆå¤ç”¨åŸåˆ™" class="headerlink" title="åˆæˆå¤ç”¨åŸåˆ™"></a>åˆæˆå¤ç”¨åŸåˆ™</h4><p>ä¹Ÿç§°ä¸ºåˆæˆ/èšåˆå¤ç”¨åŸåˆ™ï¼Œè¦å°½é‡å…ˆä½¿ç”¨ç»„åˆæˆ–è€…èšåˆç­‰å…³è”å…³ç³»æ¥å®ç°ï¼Œå…¶æ¬¡æ‰è€ƒè™‘ä½¿ç”¨ç»§æ‰¿å…³ç³»æ¥å®ç°ã€‚</p><p>å…¶åŸåˆ™å°±æ˜¯åœ¨ä¸€ä¸ªæ–°çš„å¯¹è±¡é‡Œé¢ä½¿ç”¨ä¸€äº›å·²æœ‰çš„å¯¹è±¡ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼›æ–°çš„å¯¹è±¡é€šè¿‡å‘è¿™äº›å¯¹è±¡çš„å§”æ´¾è¾¾åˆ°å¤ç”¨å·²æœ‰åŠŸèƒ½çš„ç›®çš„ã€‚</p><p>å¦‚æœä¸¤ä¸ªç±»ä¹‹é—´æ˜¯â€œHas-Aâ€çš„å…³ç³»åº”ä½¿ç”¨ç»„åˆæˆ–èšåˆï¼Œå¦‚æœæ˜¯â€œIs-Aâ€å…³ç³»å¯ä½¿ç”¨ç»§æ‰¿ã€‚â€Is-Aâ€æ˜¯ä¸¥æ ¼çš„åˆ†ç±»å­¦æ„ä¹‰ä¸Šçš„å®šä¹‰ï¼Œæ„æ€æ˜¯ä¸€ä¸ªç±»æ˜¯å¦ä¸€ä¸ªç±»çš„â€ä¸€ç§â€ï¼›è€Œâ€Has-Aâ€åˆ™ä¸åŒï¼Œå®ƒè¡¨ç¤ºæŸä¸€ä¸ªè§’è‰²å…·æœ‰æŸä¸€é¡¹è´£ä»»ã€‚</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fyw21qfycbj30bn089aab.jpg" alt=""></p><p>èšåˆï¼ˆAggregationï¼‰è¡¨ç¤ºä¸€ç§å¼±çš„â€˜æ‹¥æœ‰â€™å…³ç³»ï¼Œä½“ç°çš„æ˜¯Aå¯¹è±¡å¯ä»¥åŒ…å«Bå¯¹è±¡ä½†Bå¯¹è±¡ä¸æ˜¯Aå¯¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚å¦‚ä¸Šå›¾ä¸­çš„å¤§é›å±äºé›ç¾¤çš„ï¼Œä¸€ä¸ªé›ç¾¤æ˜¯æœ‰å¾ˆå¤šå¤§é›ã€‚èšåˆå…³ç³»ç”¨ç©ºå¿ƒçš„è±å½¢+å®çº¿æ¥è¡¨ç¤ºã€‚</p><p>åˆæˆï¼ˆCompositionï¼‰åˆ™æ˜¯ä¸€ç§å¼ºçš„â€™æ‹¥æœ‰â€™å…³ç³»ï¼Œä½“ç°äº†ä¸¥æ ¼çš„éƒ¨åˆ†å’Œæ•´ä½“å…³ç³»ï¼Œéƒ¨åˆ†å’Œæ•´ä½“çš„ç”Ÿå‘½å‘¨æœŸä¸€æ ·ã€‚ä¾‹å¦‚ä¸Šå›¾å¤§é›äººæ˜¯æœ‰å¤´ã€ç¿…è†€ç­‰åˆæˆçš„ï¼Œå¤§é›å’Œå¤´ã€ç¿…è†€çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸€æ ·çš„ï¼Œå¤§å®¶ä¸€èµ·ç©å®Œã€‚åˆæˆå…³ç³»ç”¨å®å¿ƒçš„è±å½¢+å®çº¿æ¥è¡¨ç¤ºã€‚</p><p>é€šå¸¸ç±»çš„å¤ç”¨åˆ†ä¸ºç»§æ‰¿å¤ç”¨å’Œåˆæˆå¤ç”¨</p><p>ä¸¤ç§ï¼Œç»§æ‰¿å¤ç”¨è™½ç„¶æœ‰ç®€å•å’Œæ˜“å®ç°çš„ä¼˜ç‚¹ï¼Œä½†å®ƒä¹Ÿå­˜åœ¨ä»¥ä¸‹ç¼ºç‚¹ã€‚</p><blockquote><ol><li>ç»§æ‰¿å¤ç”¨ç ´åäº†ç±»çš„å°è£…æ€§ã€‚å› ä¸ºç»§æ‰¿ä¼šå°†çˆ¶ç±»çš„å®ç°ç»†èŠ‚æš´éœ²ç»™å­ç±»ï¼Œçˆ¶ç±»å¯¹å­ç±»æ˜¯é€æ˜çš„ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¸ºâ€œç™½ç®±â€å¤ç”¨ã€‚</li><li>å­ç±»ä¸çˆ¶ç±»çš„è€¦åˆåº¦é«˜ã€‚çˆ¶ç±»çš„å®ç°çš„ä»»ä½•æ”¹å˜éƒ½ä¼šå¯¼è‡´å­ç±»çš„å®ç°å‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸åˆ©äºç±»çš„æ‰©å±•ä¸ç»´æŠ¤ã€‚</li><li>å®ƒé™åˆ¶äº†å¤ç”¨çš„çµæ´»æ€§ã€‚ä»çˆ¶ç±»ç»§æ‰¿è€Œæ¥çš„å®ç°æ˜¯é™æ€çš„ï¼Œåœ¨ç¼–è¯‘æ—¶å·²ç»å®šä¹‰ï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶ä¸å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚</li></ol></blockquote><p>é‡‡ç”¨ç»„åˆæˆ–èšåˆå¤ç”¨æ—¶ï¼Œå¯ä»¥å°†å·²æœ‰å¯¹è±¡çº³å…¥æ–°å¯¹è±¡ä¸­ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œæ–°å¯¹è±¡å¯ä»¥è°ƒç”¨å·²æœ‰å¯¹è±¡çš„åŠŸèƒ½ï¼Œå®ƒæœ‰ä»¥ä¸‹ä¼˜ç‚¹ã€‚</p><blockquote><ol><li>å®ƒç»´æŒäº†ç±»çš„å°è£…æ€§ã€‚å› ä¸ºæˆåˆ†å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚æ˜¯æ–°å¯¹è±¡çœ‹ä¸è§çš„ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¸ºâ€œé»‘ç®±â€å¤ç”¨ã€‚</li><li>æ–°æ—§ç±»ä¹‹é—´çš„è€¦åˆåº¦ä½ã€‚è¿™ç§å¤ç”¨æ‰€éœ€çš„ä¾èµ–è¾ƒå°‘ï¼Œæ–°å¯¹è±¡å­˜å–æˆåˆ†å¯¹è±¡çš„å”¯ä¸€æ–¹æ³•æ˜¯é€šè¿‡æˆåˆ†å¯¹è±¡çš„æ¥å£ã€‚</li><li>å¤ç”¨çš„çµæ´»æ€§é«˜ã€‚è¿™ç§å¤ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€è¿›è¡Œï¼Œæ–°å¯¹è±¡å¯ä»¥åŠ¨æ€åœ°å¼•ç”¨ä¸æˆåˆ†å¯¹è±¡ç±»å‹ç›¸åŒçš„å¯¹è±¡ã€‚</li></ol></blockquote><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å•ä¸€èŒè´£åŸåˆ™å‘Šè¯‰æˆ‘ä»¬å®ç°ç±»è¦èŒè´£å•ä¸€ï¼›é‡Œæ°æ›¿æ¢åŸåˆ™å‘Šè¯‰æˆ‘ä»¬ä¸è¦ç ´åç»§æ‰¿ä½“ç³»ï¼›ä¾èµ–å€’ç½®åŸåˆ™å‘Šè¯‰æˆ‘ä»¬è¦é¢å‘æ¥å£ç¼–ç¨‹ï¼›æ¥å£éš”ç¦»åŸåˆ™å‘Šè¯‰æˆ‘ä»¬åœ¨è®¾è®¡æ¥å£çš„æ—¶å€™è¦ç²¾ç®€å•ä¸€ï¼›è¿ªç±³ç‰¹æ³•åˆ™å‘Šè¯‰æˆ‘ä»¬è¦é™ä½è€¦åˆã€‚è€Œå¼€é—­åŸåˆ™æ˜¯æ€»çº²ï¼Œä»–å‘Šè¯‰æˆ‘ä»¬è¦å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><span class="exturl" data-url="aHR0cHM6Ly9zdGFja2lmeS5jb20vc29saWQtZGVzaWduLXByaW5jaXBsZXMv" title="https://stackify.com/solid-design-principles/">SOLID Design Principles Explained<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9kem9uZS5jb20vYXJ0aWNsZXMvdGhlLXNvbGlkLXByaW5jaXBsZXMtaW4tcmVhbC1saWZl" title="https://dzone.com/articles/the-solid-principles-in-real-life">The SOLID Principles in Real Life<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9zY290Y2guaW8vYmFyLXRhbGsvcy1vLWwtaS1kLXRoZS1maXJzdC1maXZlLXByaW5jaXBsZXMtb2Ytb2JqZWN0LW9yaWVudGVkLWRlc2lnbg==" title="https://scotch.io/bar-talk/s-o-l-i-d-the-first-five-principles-of-object-oriented-design">S.O.L.I.D: The First 5 Principles of Object Oriented Design<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU09MSUQ=" title="https://en.wikipedia.org/wiki/SOLID">SOLID<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3JvY2tldGVlcmxpL2FydGljbGUvZGV0YWlscy84MTU4NTcwNQ==" title="https://blog.csdn.net/rocketeerli/article/details/81585705">è®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™â€”â€”SOLID<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL3d3dy51bWwub3JnLmNuL3NqbXMvMjAxMjExMDIzLmFzcA==" title="http://www.uml.org.cn/sjms/201211023.asp">è½¯ä»¶è®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vT2NlYW5FeWVzL3Avb3ZlcnZpZXctb2Ytc29saWQtcHJpbmNpcGxlcy5odG1s" title="https://www.cnblogs.com/OceanEyes/p/overview-of-solid-principles.html">æµ…è°ˆ SOLID åŸåˆ™çš„å…·ä½“ä½¿ç”¨<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8xNDU4OWZiNjk3OGU=" title="https://www.jianshu.com/p/14589fb6978e">ç™½è¯è®¾è®¡â€”â€”æµ…è°ˆè¿ªç±³ç‰¹æ³•åˆ™<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL2MuYmlhbmNoZW5nLm5ldC92aWV3LzEzMzMuaHRtbA==" title="http://c.biancheng.net/view/1333.html">åˆæˆå¤ç”¨åŸåˆ™â€”â€”é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™&quot;&gt;&lt;a href=&quot;#è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™&quot; class=&quot;headerlink&quot; title=&quot;è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™&quot;&gt;&lt;/a&gt;è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™&lt;/h3&gt;&lt;p&gt;åœ¨æˆ‘ä»¬é¢å‘å¯¹è±¡çš„è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„codeæ—¢è¦&lt;strong&gt;å¯è¯»æ€§&lt;/strong&gt;é«˜æ–¹ä¾¿ç»´æŠ¤ï¼ŒåŒæ—¶è¿˜éœ€è¦å¦å¤–ä¸€ä¸ª&lt;strong&gt;å¯å¤ç”¨æ€§&lt;/strong&gt;ã€‚è¿™æ¬¡æˆ‘ä»¬æ¥å­¦ä¹ è½¯ä»¶è®¾è®¡æ¨¡å¼ä¸­æ¶‰åŠåˆ°çš„ä¸€äº›åŸåˆ™â€”â€”â€”â€”&amp;gt;&lt;strong&gt;é¢å‘å¯¹è±¡è®¾è®¡&lt;/strong&gt;   &lt;strong&gt;SOLID&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹è¿­ä»£å™¨æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2019/01/02/design-pattern-iterator/"/>
    <id>http://damonchow.github.io/2019/01/02/design-pattern-iterator/</id>
    <published>2019-01-02T13:31:13.000Z</published>
    <updated>2019-01-12T06:11:20.358Z</updated>
    
    <content type="html"><![CDATA[<h3 id="è¿­ä»£å™¨æ¨¡å¼"><a href="#è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼"></a>è¿­ä»£å™¨æ¨¡å¼</h3><blockquote><p>Provide a way to access the elements of an aggregate object sequentially without exposing its underlying representation.</p><p>æä¾›ä¸€ç§ä¸å…¬ç¤ºå…¶åº•å±‚ç»†èŠ‚(ç»“æ„)çš„æƒ…å†µä¸‹èƒ½é¡ºåºè®¿é—®èšåˆå¯¹è±¡å…ƒç´ çš„æ–¹æ³•ã€‚<br><a id="more"></a><br>å…¶å®åœ¨javaä½“ç³»ä¸­ï¼Œjdkå·²ç»å¼•å…¥äº†è¿­ä»£å™¨æ¥å£ä»¥åŠå¯¹äºçš„å®¹å™¨æ¥å£ç­‰ã€‚å°±æ‹¿è¿­ä»£å™¨ä¸­çš„è§’è‰²ï¼Œåœ¨javaä¸­æ‰¾å‡ºå…¶å¯¹åº”çš„ç±»ã€‚</p></blockquote><h3 id="å…·ä½“è§’è‰²"><a href="#å…·ä½“è§’è‰²" class="headerlink" title="å…·ä½“è§’è‰²"></a>å…·ä½“è§’è‰²</h3><blockquote><p>(1)è¿­ä»£å™¨è§’è‰²(Iterator)ï¼šå®šä¹‰éå†å…ƒç´ æ‰€éœ€è¦çš„æ–¹æ³•ï¼Œä¸€èˆ¬æ¥è¯´ä¼šæœ‰è¿™ä¹ˆä¸‰ä¸ªæ–¹æ³•ï¼šå–å¾—ä¸‹ä¸€ä¸ªå…ƒç´ çš„æ–¹æ³•next()ï¼Œåˆ¤æ–­æ˜¯å¦éå†ç»“æŸçš„æ–¹æ³•hasNext()ï¼‰ï¼Œç§»å‡ºå½“å‰å¯¹è±¡çš„æ–¹æ³•remove(), </p><p>(2)å…·ä½“è¿­ä»£å™¨è§’è‰²(Concrete Iterator)ï¼šå®ç°è¿­ä»£å™¨æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå®Œæˆé›†åˆçš„è¿­ä»£ã€‚</p><p>(3)å®¹å™¨è§’è‰²(Aggregate):  ä¸€èˆ¬æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæä¾›ä¸€ä¸ªiterator()æ–¹æ³•ï¼Œä¾‹å¦‚javaä¸­çš„Collectionæ¥å£ï¼ŒListæ¥å£ï¼ŒSetæ¥å£ç­‰</p><p>(4)å…·ä½“å®¹å™¨è§’è‰²(ConcreteAggregate)ï¼šå°±æ˜¯æŠ½è±¡å®¹å™¨çš„å…·ä½“å®ç°ç±»ï¼Œæ¯”å¦‚Listæ¥å£çš„æœ‰åºåˆ—è¡¨å®ç°ArrayListï¼ŒListæ¥å£çš„é“¾è¡¨å®ç°LinkListï¼ŒSetæ¥å£çš„å“ˆå¸Œåˆ—è¡¨çš„å®ç°HashSetç­‰ã€‚</p></blockquote><p>å•ç‹¬ä¸¾å‡ºArrayListçš„è§’è‰²ï¼Œ</p><p>è¿­ä»£å™¨è§’è‰²å¯¹åº”javaä¸­çš„java.lang.Iteratorï¼Œè¿™ä¸ªè¿­ä»£å™¨æ˜¯javaå®¹å™¨å…¬ç”¨çš„ã€‚</p><p>å®¹å™¨è§’è‰²å¯¹åº”java.lang.Iterableï¼Œå…¶è¿˜æœ‰Iterator<t> iterator()æ–¹æ³•è·å–è¿­ä»£å™¨ã€‚</t></p><p>å…·ä½“è¿­ä»£å™¨è§’è‰²å¯¹åº”java.lang.ArrayList.Itrï¼Œå®ç°äº†å¯¹åº”çš„hasNextã€nextã€removeæ–¹æ³•ã€‚</p><p>å…·ä½“å®¹å™¨è§’è‰²é‚£å°±æ˜¯java.lang.ArrayListäº†ï¼Œå®ç°iteratoræ–¹æ³•è¿”å›Itrå…·ä½“è¿­ä»£å™¨ï¼Œç”¨æ¸¸æ ‡å½¢å¼å®ç°ã€‚</p><h3 id="å†çœ‹çœ‹UMLç±»"><a href="#å†çœ‹çœ‹UMLç±»" class="headerlink" title="å†çœ‹çœ‹UMLç±»"></a>å†çœ‹çœ‹UMLç±»</h3><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/13/Iterator_UML_class_diagram.svg/500px-Iterator_UML_class_diagram.svg.png" alt="img"></p><h3 id="é¡¹ç›®å®ä¾‹"><a href="#é¡¹ç›®å®ä¾‹" class="headerlink" title="é¡¹ç›®å®ä¾‹"></a>é¡¹ç›®å®ä¾‹</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci9pdGVyYXRvcg==" title="https://github.com/DamonChow/design_pattern/tree/master/iterator">æºç åœ¨Github<i class="fa fa-external-link"></i></span></p><p>é¡¹ç›®ä¸­å¾ˆç®€å•çš„å®ç°äº†ä¸€ä¸ªå®¹å™¨å’Œè¿­ä»£å™¨ã€‚å¤§è‡´å‚è€ƒäº†ArrayListå®ç°ï¼Œä½†æ˜¯æ˜¯ç®€æ´ç‰ˆæœ¬ï¼Œå»é™¤å¾ˆå¤šæ— å…³ä»¥åŠæ€§èƒ½ä¸Šçš„ä¸œè¥¿ï¼Œåªä¿ç•™æœ€åŸºæœ¬çš„è¿­ä»£å™¨å…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Aggregate&lt;Integer&gt; aggregate = <span class="keyword">new</span> ConcreteAggregate&lt;&gt;();</span><br><span class="line">        aggregate.add(<span class="number">1</span>);</span><br><span class="line">        aggregate.add(<span class="number">2</span>);</span><br><span class="line">        aggregate.add(<span class="number">3</span>);</span><br><span class="line">        aggregate.add(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        Iterator&lt;Integer&gt; iterator = aggregate.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            log.info(<span class="string">"å¾ªç¯æ•°æ®&#123;&#125;"</span>, iterator.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœå¦‚ä¸‹</p><p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fysdz7f3j1j317s06ajt1.jpg" alt="image-20190102175121620"></p><p>ç®€å•çš„è¿­ä»£å™¨å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">E <span class="title">next</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•å®¹å™¨å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Aggregate</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">Iterator&lt;T&gt; <span class="title">iterator</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(T t)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“å®¹å™¨å’Œå…·ä½“çš„è¿­ä»£å™¨å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteAggregate</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">Aggregate</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object[] elements;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteAggregate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        elements = <span class="keyword">new</span> Object[<span class="number">16</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">        elements[size++] = e;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteIterator&lt;E&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteIterator</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> cursor;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor != size;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (cursor &gt;= size) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> (E) elements[cursor++];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“å®¹å™¨ä¸­ç”¨æ•°ç»„æ¥ä½œä¸ºå®¹å™¨æ¥å­˜å‚¨å…ƒç´ ï¼Œè€Œä¸”æœ€ç®€å•çš„å®¹å™¨ï¼Œå›ºå®šäº†å¤§å°ï¼Œå¹¶æ²¡æœ‰å®ç°æ‰©å®¹çš„ç®—æ³•ç­‰ç­‰ï¼Œåªæ˜¯ä¸€ä¸ªç®€å•çš„æ ·ä¾‹ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†ä¸Šï¼Œéƒ½æ˜¯ç›´æ¥ä½¿ç”¨javaå¸¦æœ‰çš„è¿­ä»£å™¨ã€‚</p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>ç®€åŒ–äº†éå†æ–¹å¼ï¼Œå¯¹äºå¯¹è±¡é›†åˆçš„éå†ï¼Œè¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œå¯¹äºæ•°ç»„æˆ–è€…æœ‰åºåˆ—è¡¨ï¼Œæˆ‘ä»¬å°šå¯ä»¥é€šè¿‡æ¸¸æ ‡æ¥å–å¾—ï¼Œä½†ç”¨æˆ·éœ€è¦åœ¨å¯¹é›†åˆäº†è§£å¾ˆæ¸…æ¥šçš„å‰æä¸‹ï¼Œè‡ªè¡Œéå†å¯¹è±¡ï¼Œä½†æ˜¯å¯¹äºhashè¡¨æ¥è¯´ï¼Œç”¨æˆ·éå†èµ·æ¥å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚è€Œå¼•å…¥äº†è¿­ä»£å™¨æ–¹æ³•åï¼Œç”¨æˆ·ç”¨èµ·æ¥å°±ç®€å•çš„å¤šäº†ã€‚</li><li>å¯ä»¥æä¾›å¤šç§éå†æ–¹å¼ï¼Œæ¯”å¦‚è¯´å¯¹æœ‰åºåˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦æä¾›æ­£åºéå†ï¼Œå€’åºéå†ä¸¤ç§è¿­ä»£å™¨ï¼Œç”¨æˆ·ç”¨èµ·æ¥åªéœ€è¦å¾—åˆ°æˆ‘ä»¬å®ç°å¥½çš„è¿­ä»£å™¨ï¼Œå°±å¯ä»¥æ–¹ä¾¿çš„å¯¹é›†åˆè¿›è¡Œéå†äº†ã€‚</li><li>å°è£…æ€§è‰¯å¥½ï¼Œç”¨æˆ·åªéœ€è¦å¾—åˆ°è¿­ä»£å™¨å°±å¯ä»¥éå†ï¼Œè€Œå¯¹äºéå†ç®—æ³•åˆ™ä¸ç”¨å»å…³å¿ƒã€‚</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>ç”±äºè¿­ä»£å™¨æ¨¡å¼å°†å­˜å‚¨æ•°æ®å’Œéå†æ•°æ®çš„èŒè´£åˆ†ç¦»ï¼Œå¢åŠ æ–°çš„èšåˆç±»éœ€è¦å¯¹åº”å¢åŠ æ–°çš„è¿­ä»£å™¨ç±»ï¼Œç±»çš„ä¸ªæ•°æˆå¯¹å¢åŠ ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</p><p>å¯¹äºæ¯”è¾ƒç®€å•çš„éå†ï¼ˆåƒæ•°ç»„æˆ–è€…æœ‰åºåˆ—è¡¨ï¼‰ï¼Œä½¿ç”¨è¿­ä»£å™¨æ–¹å¼éå†è¾ƒä¸ºç¹çï¼Œå¤§å®¶å¯èƒ½éƒ½æœ‰æ„Ÿè§‰ï¼ŒåƒArrayListï¼Œæˆ‘ä»¬å®å¯æ„¿æ„ä½¿ç”¨forå¾ªç¯å’Œgetæ–¹æ³•æ¥éå†é›†åˆã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿­ä»£å™¨æ¨¡å¼æ˜¯ä¸é›†åˆå…±ç”Ÿå…±æ­»çš„ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åªè¦å®ç°ä¸€ä¸ªé›†åˆï¼Œå°±éœ€è¦åŒæ—¶æä¾›è¿™ä¸ªé›†åˆçš„è¿­ä»£å™¨ï¼Œå°±åƒjavaä¸­çš„Collectionï¼ŒListã€Setã€Mapç­‰ï¼Œè¿™äº›é›†åˆéƒ½æœ‰è‡ªå·±çš„è¿­ä»£å™¨ã€‚å‡å¦‚æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªè¿™æ ·çš„æ–°çš„å®¹å™¨ï¼Œå½“ç„¶ä¹Ÿéœ€è¦å¼•å…¥è¿­ä»£å™¨æ¨¡å¼ï¼Œç»™æˆ‘ä»¬çš„å®¹å™¨å®ç°ä¸€ä¸ªè¿­ä»£å™¨ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSXRlcmF0b3JfcGF0dGVybg==" title="https://en.wikipedia.org/wiki/Iterator_pattern">wikiçš„è¿­ä»£å™¨æ¨¡å¼<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2Rlc2lnbi1wYXR0ZXJuL2l0ZXJhdG9yLXBhdHRlcm4uaHRtbA==" title="http://www.runoob.com/design-pattern/iterator-pattern.html">è¿­ä»£å™¨æ¨¡å¼|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veXN3LWdvL3AvNTM4NDUxNi5odG1s" title="https://www.cnblogs.com/ysw-go/p/5384516.html">Javaè®¾è®¡æ¨¡å¼ç³»åˆ—ä¹‹è¿­ä»£å™¨æ¨¡å¼<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;è¿­ä»£å™¨æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è¿­ä»£å™¨æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è¿­ä»£å™¨æ¨¡å¼&quot;&gt;&lt;/a&gt;è¿­ä»£å™¨æ¨¡å¼&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;Provide a way to access the elements of an aggregate object sequentially without exposing its underlying representation.&lt;/p&gt;
&lt;p&gt;æä¾›ä¸€ç§ä¸å…¬ç¤ºå…¶åº•å±‚ç»†èŠ‚(ç»“æ„)çš„æƒ…å†µä¸‹èƒ½é¡ºåºè®¿é—®èšåˆå¯¹è±¡å…ƒç´ çš„æ–¹æ³•ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="è¿­ä»£å™¨" scheme="http://damonchow.github.io/tags/%E8%BF%AD%E4%BB%A3%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2019/01/02/design-pattern-command/"/>
    <id>http://damonchow.github.io/2019/01/02/design-pattern-command/</id>
    <published>2019-01-02T01:58:03.000Z</published>
    <updated>2019-01-12T06:10:17.120Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‘½ä»¤æ¨¡å¼"><a href="#å‘½ä»¤æ¨¡å¼" class="headerlink" title="å‘½ä»¤æ¨¡å¼"></a>å‘½ä»¤æ¨¡å¼</h3><blockquote><p>wikiä¸Šçš„æè¿° Encapsulate a request as an object, thereby allowing for the parameterization of clients with different requests, and the queuing or logging of requests. It also allows for the support of undoable operations.</p></blockquote><blockquote><p>ç¿»è¯‘æ„æ€ï¼ŒæŠŠè¯·æ±‚å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œå…è®¸æˆ‘ä»¬å¯ä»¥å¯¹å®¢æˆ·ç«¯çš„ä¸åŒè¯·æ±‚è¿›è¡Œå‚æ•°åŒ–ï¼Œä»¥åŠå¯¹è¯·æ±‚è¿›è¡Œæ’é˜Ÿæˆ–è®°å½•ã€‚è¿˜å…è®¸æ”¯æŒæ’¤é”€æ“ä½œã€‚çœ‹èµ·æ¥å¥½åƒå¾ˆå¤æ‚ï¼Œå¾ˆéš¾ç†è§£ã€‚<a id="more"></a></p><p>é€šä¿—ç®€å•ç†è§£ï¼Œå®ƒå°±æ˜¯å°†è¯·æ±‚å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨è¿™é‡Œå°±æ˜¯è¿™ä¸ªå¯¹è±¡å°±æ˜¯å‘½ä»¤ï¼Œè€Œè¿™ä¸ªå‘½ä»¤å°±æ˜¯å°†è¯·æ±‚æ–¹å’Œæ‰§è¡Œæ–¹åˆ†ç¦»éš”å¼€ã€‚ä»è€Œæ¯ä¸€ä¸ªå‘½ä»¤å…¶å®å°±æ˜¯æ“ä½œï¼Œè€Œè¿™æ ·çš„æµç¨‹å°±æ˜¯è¯·æ±‚æ–¹å‘å‡ºè¯·æ±‚è¦æ±‚æ‰§è¡ŒæŸæ“ä½œï¼Œæ¥æ”¶æ–¹æ”¶åˆ°è¯·æ±‚åå¹¶æ‰§è¡Œå¯¹åº”çš„æ“ä½œã€‚è¿™æ ·ä¸‹æ¥ï¼Œè¯·æ±‚æ–¹å’Œæ¥æ”¶æ–¹å°±è§£è€¦äº†ï¼Œä½¿å¾—è¯·æ±‚æ–¹å®Œå…¨ä¸çŸ¥é“æ¥å—çš„æ“ä½œæ–¹æ³•ï¼Œä»ä¹Ÿä¸ä¼šçŸ¥é“æ¥æ”¶æ–¹æ˜¯ä½•æ—¶æ¥å—åˆ°è¯·æ±‚çš„ï¼Œåˆæ˜¯ä½•æ—¶æ‰§è¡Œæ“ä½œçš„ï¼Œåˆæ˜¯æ€ä¹ˆæ‰§è¡Œæ“ä½œçš„ã€‚</p></blockquote><h3 id="å…·ä½“çš„è§’è‰²"><a href="#å…·ä½“çš„è§’è‰²" class="headerlink" title="å…·ä½“çš„è§’è‰²"></a>å…·ä½“çš„è§’è‰²</h3><blockquote><p>Commandï¼ˆæŠ½è±¡å‘½ä»¤ç±»ï¼‰ï¼šæŠ½è±¡å‘½ä»¤ç±»ä¸€èˆ¬æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£ï¼Œåœ¨å…¶ä¸­å£°æ˜äº†ç”¨äºæ‰§è¡Œè¯·æ±‚çš„execute()ç­‰æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›æ–¹æ³•å¯ä»¥è°ƒç”¨è¯·æ±‚æ¥æ”¶è€…çš„ç›¸å…³æ“ä½œã€‚</p><p>ConcreteCommandï¼ˆå…·ä½“å‘½ä»¤ç±»ï¼‰ï¼šå…·ä½“å‘½ä»¤ç±»æ˜¯æŠ½è±¡å‘½ä»¤ç±»çš„å­ç±»ï¼Œå®ç°äº†åœ¨æŠ½è±¡å‘½ä»¤ç±»ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œå®ƒå¯¹åº”å…·ä½“çš„æ¥æ”¶è€…å¯¹è±¡ï¼Œå°†æ¥æ”¶è€…å¯¹è±¡çš„åŠ¨ä½œç»‘å®šå…¶ä¸­ã€‚åœ¨å®ç°execute()æ–¹æ³•æ—¶ï¼Œå°†è°ƒç”¨æ¥æ”¶è€…å¯¹è±¡çš„ç›¸å…³æ“ä½œ(Action)ã€‚</p><p>Invokerï¼ˆè¯·æ±‚æ–¹ï¼‰ï¼šè°ƒç”¨è€…å³è¯·æ±‚å‘é€è€…ï¼Œå®ƒé€šè¿‡å‘½ä»¤å¯¹è±¡æ¥æ‰§è¡Œè¯·æ±‚ã€‚ä¸€ä¸ªè°ƒç”¨è€…å¹¶ä¸éœ€è¦åœ¨è®¾è®¡æ—¶ç¡®å®šå…¶æ¥æ”¶è€…ï¼Œå› æ­¤å®ƒåªä¸æŠ½è±¡å‘½ä»¤ç±»ä¹‹é—´å­˜åœ¨å…³è”å…³ç³»ã€‚åœ¨ç¨‹åºè¿è¡Œæ—¶å¯ä»¥å°†ä¸€ä¸ªå…·ä½“å‘½ä»¤å¯¹è±¡æ³¨å…¥å…¶ä¸­ï¼Œå†è°ƒç”¨å…·ä½“å‘½ä»¤å¯¹è±¡çš„execute()æ–¹æ³•ï¼Œä»è€Œå®ç°é—´æ¥è°ƒç”¨è¯·æ±‚æ¥æ”¶è€…çš„ç›¸å…³æ“ä½œã€‚</p><p>Receiverï¼ˆæ¥æ”¶æ–¹ï¼‰ï¼šæ¥æ”¶è€…æ‰§è¡Œä¸è¯·æ±‚ç›¸å…³çš„æ“ä½œï¼Œå®ƒå…·ä½“å®ç°å¯¹è¯·æ±‚çš„ä¸šåŠ¡å¤„ç†ã€‚</p><p>Clientï¼ˆå®¢æˆ·ç«¯ï¼‰ï¼šåˆ›å»ºå…·ä½“å‘½ä»¤çš„å¯¹è±¡å¹¶ä¸”è®¾ç½®å‘½ä»¤å¯¹è±¡çš„æ¥å—è€…ã€‚</p></blockquote><h3 id="å†æ¥çœ‹çœ‹UMLå›¾"><a href="#å†æ¥çœ‹çœ‹UMLå›¾" class="headerlink" title="å†æ¥çœ‹çœ‹UMLå›¾"></a>å†æ¥çœ‹çœ‹UMLå›¾</h3><p><img src="https://upload.wikimedia.org/wikipedia/commons/c/c8/W3sDesign_Command_Design_Pattern_UML.jpg" alt="img"></p><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Command_pattern.svg/700px-Command_pattern.svg.png" alt="img"></p><p>ä»ä¸Šæ–¹çš„æ—¶åºå›¾ä¸­å¯ä»¥çœ‹å‡ºè¿è¡Œçš„é¡ºåºï¼ŒInvokeræ‰§è¡Œexecuteæ–¹æ³•ï¼Œè°ƒç”¨Command1å¯¹è±¡ï¼ŒCommand1æ‰§è¡Œaction1æ–¹æ³•è°ƒç”¨Receiver1å¯¹è±¡ã€‚</p><h3 id="å¹²è´§ä»£ç "><a href="#å¹²è´§ä»£ç " class="headerlink" title="å¹²è´§ä»£ç "></a>å¹²è´§ä»£ç </h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci9jb21tYW5k" title="https://github.com/DamonChow/design_pattern/tree/master/command">æºç åœ¨æˆ‘çš„GitHubåœ°å€<i class="fa fa-external-link"></i></span></p><h4 id="æ™®é€šçš„å‘½ä»¤æ¨¡å¼"><a href="#æ™®é€šçš„å‘½ä»¤æ¨¡å¼" class="headerlink" title="æ™®é€šçš„å‘½ä»¤æ¨¡å¼"></a>æ™®é€šçš„å‘½ä»¤æ¨¡å¼</h4><p>ç°åœ¨ç»“åˆä¸‹ä¸Šå›è¯´åˆ°çš„<a href="https://damonchow.github.io/2018/12/24/design-pattern-state">çŠ¶æ€æ¨¡å¼</a>ä¸€èµ·æ¥å®ç°è¿™ä¸ªé£æ‰‡çš„å·¦è½¬å’Œå³è½¬åŠŸèƒ½ï¼Œè¿™æ¬¡æŠŠä»–ç”¨å‘½ä»¤æ¨¡å¼æ¥ä»£æ›¿ä¹‹å‰é£æ‰‡çš„è½¬åŠ¨ï¼ŒæŠŠå®ƒå½“åšå‘½ä»¤æ¥ã€‚</p><p>å®¢æˆ·ç«¯ç®€å•çš„å®šä¹‰è¯·æ±‚æ–¹å’Œæ¥æ”¶æ–¹ä»¥åŠå¯¹äºçš„å·¦è½¬å‘½ä»¤å’Œå³è½¬å‘½ä»¤ï¼Œè®¾ç½®å‘½ä»¤åå¯¹åº”çš„æ‰§è¡Œå‘½ä»¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Invoker invoker = <span class="keyword">new</span> Invoker();</span><br><span class="line">        Receiver receiver = <span class="keyword">new</span> Receiver();</span><br><span class="line">        Command leftCommand = <span class="keyword">new</span> LeftCommand(receiver);</span><br><span class="line">        Command rightCommand = <span class="keyword">new</span> RightCommand(receiver);</span><br><span class="line"></span><br><span class="line">        invoker.setCommand(rightCommand);</span><br><span class="line">        invoker.execute();</span><br><span class="line">        invoker.execute();</span><br><span class="line">        invoker.execute();</span><br><span class="line"></span><br><span class="line">        invoker.setCommand(leftCommand);</span><br><span class="line">        invoker.execute();</span><br><span class="line">        invoker.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fys3lfn4bnj31es0740v1.jpg" alt="image-20190102115207650"></p><p>è¯·æ±‚æ–¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Invoker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Command command;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        command.execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠ½è±¡å‘½ä»¤</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å…³å·¦è½¬</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LeftCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Receiver receiver;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        receiver.left();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å…³å³è½¬</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RightCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Receiver receiver;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        receiver.right();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥æ”¶æ–¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Receiver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Context context = <span class="keyword">new</span> Context(<span class="keyword">new</span> CloseLevelState());</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">left</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        context.left();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        context.right();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‘½ä»¤æ¨¡å¼æŠŠå·¦è½¬å’Œå³è½¬å°è£…æˆå‘½ä»¤ï¼Œä»¥åŠä¹‹å‰çš„çŠ¶æ€æ¨¡å¼å˜æ›´é£æ‰‡çš„çŠ¶æ€ã€‚æœ¬æ¬¡å°±æ˜¯é€šè¿‡çŠ¶æ€æ¨¡å¼å’Œå‘½ä»¤æ¨¡å¼å®ç°äº†ä¸€ä¸ªé£æ‰‡å¼€å…³å·¦å³è½¬çš„åŠŸèƒ½ã€‚</p><h4 id="å®å‘½ä»¤æˆ–è€…å«åšç»„åˆå‘½ä»¤"><a href="#å®å‘½ä»¤æˆ–è€…å«åšç»„åˆå‘½ä»¤" class="headerlink" title="å®å‘½ä»¤æˆ–è€…å«åšç»„åˆå‘½ä»¤"></a>å®å‘½ä»¤æˆ–è€…å«åšç»„åˆå‘½ä»¤</h4><p>è®¾è®¡ä¸€ç»„å‘½ä»¤ï¼Œç®€å•çš„å¤„ç†äº‹æƒ…ï¼Œæ‰“å°ä¸€å¥è¯ï¼Œå°è£…æˆä¸€ç»„å‘½ä»¤ã€‚è¿™æ¬¡æˆ‘ä»¬ç”¨äº†Java8æ¥å†™ï¼Œå¯ä»¥ä½¿ç”¨lambdaã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Invoker invoker = <span class="keyword">new</span> Invoker();</span><br><span class="line">        log.info(<span class="string">"åˆå§‹åŒ–ABC3ä¸ªå‘½ä»¤"</span>);</span><br><span class="line">        Command aCommand = () -&gt; log.info(<span class="string">"Aå¤„ç†è¿™ä¸ªè¯·æ±‚"</span>);</span><br><span class="line">        invoker.addCommand(aCommand);</span><br><span class="line">        invoker.addCommand(() -&gt; log.info(<span class="string">"Bå¤„ç†è¿™ä¸ªè¯·æ±‚"</span>));</span><br><span class="line">        invoker.addCommand(() -&gt; log.info(<span class="string">"Cå¤„ç†è¿™ä¸ªè¯·æ±‚"</span>));</span><br><span class="line">        invoker.execute();</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"---------------------------"</span>);</span><br><span class="line">        log.info(<span class="string">"åŠ å…¥æ–°å‘½ä»¤D"</span>);</span><br><span class="line">        invoker.addCommand(() -&gt; log.info(<span class="string">"Då¤„ç†è¿™ä¸ªè¯·æ±‚"</span>));</span><br><span class="line">        invoker.execute();</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"---------------------------"</span>);</span><br><span class="line">        log.info(<span class="string">"åŠ å…¥æ–°å‘½ä»¤E"</span>);</span><br><span class="line">        invoker.addCommand(() -&gt; log.info(<span class="string">"Eå¤„ç†è¿™ä¸ªè¯·æ±‚"</span>));</span><br><span class="line">        invoker.execute();</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">"---------------------------"</span>);</span><br><span class="line">        log.info(<span class="string">"ç§»é™¤å‘½ä»¤A"</span>);</span><br><span class="line">        invoker.removeCommand(aCommand);</span><br><span class="line">        invoker.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å°è¯­å¥ã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fys86bil8zj31kw0skwov.jpg" alt="image-20190102143032334"></p><p>æŠ½è±¡å‘½ä»¤</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·æ±‚æ–¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Invoker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Command&gt; commandList = Lists.newArrayList();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCommand</span><span class="params">(Command command)</span> </span>&#123;</span><br><span class="line">        commandList.add(command);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeCommand</span><span class="params">(Command command)</span> </span>&#123;</span><br><span class="line">        commandList.remove(command);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(CollectionUtils.isEmpty(commandList)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        commandList.stream().forEach(command -&gt; command.execute());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ’¤é”€æ“ä½œ"><a href="#æ’¤é”€æ“ä½œ" class="headerlink" title="æ’¤é”€æ“ä½œ"></a>æ’¤é”€æ“ä½œ</h4><p>åœ¨æ™®é€šçš„å‘½ä»¤æ¨¡å¼çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†æ’¤é”€æ“ä½œï¼Œåœ¨è¿™é‡Œçš„æ’¤é”€æ“ä½œï¼Œå…¶å®å³ä¸ºå·¦è½¬æ—¶çš„å³è½¬ï¼Œå³è½¬æ—¶çš„å·¦è½¬ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Invoker invoker = <span class="keyword">new</span> Invoker();</span><br><span class="line">        Receiver receiver = <span class="keyword">new</span> Receiver();</span><br><span class="line">        Command leftCommand = <span class="keyword">new</span> LeftCommand(receiver);</span><br><span class="line">        Command rightCommand = <span class="keyword">new</span> RightCommand(receiver);</span><br><span class="line"></span><br><span class="line">        invoker.setCommand(rightCommand);</span><br><span class="line">        invoker.execute();</span><br><span class="line">        invoker.execute();</span><br><span class="line">        invoker.execute();</span><br><span class="line">        invoker.undo();</span><br><span class="line">        invoker.undo();</span><br><span class="line"></span><br><span class="line">        invoker.setCommand(leftCommand);</span><br><span class="line">        invoker.execute();</span><br><span class="line">        invoker.undo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fys8vu4smbj319o08s0w2.jpg" alt="image-20190102145507099"></p><p>æŠ½è±¡å‘½ä»¤å¢åŠ äº†æ’¤é”€æ“ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“å·¦è½¬æ—¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LeftCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Receiver receiver;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        receiver.left();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        receiver.right();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å³è½¬æ—¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RightCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Receiver receiver;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        receiver.right();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        receiver.left();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·æ±‚æ–¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Invoker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Command command;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        command.execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        command.undo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥æ”¶æ–¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Receiver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Context context = <span class="keyword">new</span> Context(<span class="keyword">new</span> CloseLevelState());</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">left</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        context.left();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        context.right();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‘½ä»¤æ¨¡å¼æ€»ç»“"><a href="#å‘½ä»¤æ¨¡å¼æ€»ç»“" class="headerlink" title="å‘½ä»¤æ¨¡å¼æ€»ç»“"></a>å‘½ä»¤æ¨¡å¼æ€»ç»“</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><blockquote><p>(1) <strong>é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦</strong>ã€‚ç”±äºè¯·æ±‚è€…ä¸æ¥æ”¶è€…ä¹‹é—´ä¸å­˜åœ¨ç›´æ¥å¼•ç”¨ï¼Œå› æ­¤è¯·æ±‚è€…ä¸æ¥æ”¶è€…ä¹‹é—´å®ç°å®Œå…¨è§£è€¦ï¼Œç›¸åŒçš„è¯·æ±‚è€…å¯ä»¥å¯¹åº”ä¸åŒçš„æ¥æ”¶è€…ï¼ŒåŒæ ·ï¼Œç›¸åŒçš„æ¥æ”¶è€…ä¹Ÿå¯ä»¥ä¾›ä¸åŒçš„è¯·æ±‚è€…ä½¿ç”¨ï¼Œä¸¤è€…ä¹‹é—´å…·æœ‰è‰¯å¥½çš„ç‹¬ç«‹æ€§ã€‚</p><p>(2) <strong>æ–°çš„å‘½ä»¤å¯ä»¥å¾ˆå®¹æ˜“åœ°åŠ å…¥åˆ°ç³»ç»Ÿä¸­</strong>ã€‚ç”±äºå¢åŠ æ–°çš„å…·ä½“å‘½ä»¤ç±»ä¸ä¼šå½±å“åˆ°å…¶ä»–ç±»ï¼Œå› æ­¤å¢åŠ æ–°çš„å…·ä½“å‘½ä»¤ç±»å¾ˆå®¹æ˜“ï¼Œæ— é¡»ä¿®æ”¹åŸæœ‰ç³»ç»Ÿæºä»£ç ï¼Œç”šè‡³å®¢æˆ·ç±»ä»£ç ï¼Œæ»¡è¶³â€œå¼€é—­åŸåˆ™â€çš„è¦æ±‚ã€‚</p><p>(3) <strong>å¯ä»¥æ¯”è¾ƒå®¹æ˜“åœ°è®¾è®¡ä¸€ä¸ªå‘½ä»¤é˜Ÿåˆ—æˆ–å®å‘½ä»¤ï¼ˆç»„åˆå‘½ä»¤ï¼‰</strong>ã€‚</p><p>(4) <strong>ä¸ºè¯·æ±‚çš„æ’¤é”€(Undo)å’Œæ¢å¤(Redo)æ“ä½œæä¾›äº†ä¸€ç§è®¾è®¡å’Œå®ç°æ–¹æ¡ˆ</strong>ã€‚</p></blockquote><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><blockquote><p><strong>ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ã€‚</strong>å› ä¸ºé’ˆå¯¹æ¯ä¸€ä¸ªå¯¹è¯·æ±‚æ¥æ”¶è€…çš„è°ƒç”¨æ“ä½œéƒ½éœ€è¦è®¾è®¡ä¸€ä¸ªå…·ä½“å‘½ä»¤ç±»ï¼Œå› æ­¤åœ¨æŸäº›ç³»ç»Ÿä¸­å¯èƒ½éœ€è¦æä¾›å¤§é‡çš„å…·ä½“å‘½ä»¤ç±»ï¼Œè¿™å°†å½±å“å‘½ä»¤æ¨¡å¼çš„ä½¿ç”¨ã€‚</p></blockquote><h4 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h4><blockquote><p>(1) ç³»ç»Ÿéœ€è¦å°†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æ¥æ”¶è€…è§£è€¦ï¼Œä½¿å¾—è°ƒç”¨è€…å’Œæ¥æ”¶è€…ä¸ç›´æ¥äº¤äº’ã€‚è¯·æ±‚è°ƒç”¨è€…æ— é¡»çŸ¥é“æ¥æ”¶è€…çš„å­˜åœ¨ï¼Œä¹Ÿæ— é¡»çŸ¥é“æ¥æ”¶è€…æ˜¯è°ï¼Œæ¥æ”¶è€…ä¹Ÿæ— é¡»å…³å¿ƒä½•æ—¶è¢«è°ƒç”¨ã€‚</p><p>(2) ç³»ç»Ÿéœ€è¦åœ¨ä¸åŒçš„æ—¶é—´æŒ‡å®šè¯·æ±‚ã€å°†è¯·æ±‚æ’é˜Ÿå’Œæ‰§è¡Œè¯·æ±‚ã€‚ä¸€ä¸ªå‘½ä»¤å¯¹è±¡å’Œè¯·æ±‚çš„åˆå§‹è°ƒç”¨è€…å¯ä»¥æœ‰ä¸åŒçš„ç”Ÿå‘½æœŸï¼Œæ¢è¨€ä¹‹ï¼Œæœ€åˆçš„è¯·æ±‚å‘å‡ºè€…å¯èƒ½å·²ç»ä¸åœ¨äº†ï¼Œè€Œå‘½ä»¤å¯¹è±¡æœ¬èº«ä»ç„¶æ˜¯æ´»åŠ¨çš„ï¼Œå¯ä»¥é€šè¿‡è¯¥å‘½ä»¤å¯¹è±¡å»è°ƒç”¨è¯·æ±‚æ¥æ”¶è€…ï¼Œè€Œæ— é¡»å…³å¿ƒè¯·æ±‚è°ƒç”¨è€…çš„å­˜åœ¨æ€§ï¼Œå¯ä»¥é€šè¿‡è¯·æ±‚æ—¥å¿—æ–‡ä»¶ç­‰æœºåˆ¶æ¥å…·ä½“å®ç°ã€‚</p><p>(3) ç³»ç»Ÿéœ€è¦æ”¯æŒå‘½ä»¤çš„æ’¤é”€(Undo)æ“ä½œå’Œæ¢å¤(Redo)æ“ä½œã€‚</p><p>(4) ç³»ç»Ÿéœ€è¦å°†ä¸€ç»„æ“ä½œç»„åˆåœ¨ä¸€èµ·å½¢æˆå®å‘½ä»¤ã€‚</p><p>(5)çº¿ç¨‹æ± æœ‰ä¸€ä¸ªaddTashæ–¹æ³•ï¼Œå°†ä»»åŠ¡æ·»åŠ åˆ°å¾…å®Œæˆçš„é˜Ÿåˆ—ä¸­ï¼Œé˜Ÿåˆ—ä¸­çš„å…ƒç´ å°±æ˜¯å‘½ä»¤å¯¹è±¡ï¼Œé€šå¸¸çš„å°±æ˜¯ä¸€ä¸ªå…¬å…±æ¥å£ï¼Œåƒæˆ‘ä»¬å¸¸ç”¨çš„java.lang.Runnableæ¥å£ã€‚</p><p>(6)java8ä¹‹åï¼Œæœ€å¥½åœ¨Commandæ¥å£ä¸­@FunctionalInterfaceä¿®é¥°ï¼Œè¿™æ ·å…·ä½“çš„å‘½ä»¤å°±å¯ä»¥ä½¿ç”¨lambdaè¡¨è¾¾å¼å•¦ã€‚</p></blockquote><h4 id="Javaä¸­çš„ä½¿ç”¨"><a href="#Javaä¸­çš„ä½¿ç”¨" class="headerlink" title="Javaä¸­çš„ä½¿ç”¨"></a>Javaä¸­çš„ä½¿ç”¨</h4><p>å°†æ“ä½œå°è£…åˆ°å¯¹è±¡å†…ï¼Œä»¥ä¾¿å­˜å‚¨ï¼Œä¼ é€’å’Œè¿”å›ã€‚</p><blockquote><p>java.lang.Runnable </p><p>javax.swing.Action</p></blockquote><h3 id="æ–‡ç« å‚è€ƒ"><a href="#æ–‡ç« å‚è€ƒ" class="headerlink" title="æ–‡ç« å‚è€ƒ"></a>æ–‡ç« å‚è€ƒ</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbGZ4aWFvL3AvNjgyNTY0NC5odG1s" title="https://www.cnblogs.com/lfxiao/p/6825644.html">javaè®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdGlueWtpbmcvcC81OTM4NTQ3Lmh0bWw=" title="https://www.cnblogs.com/tinyking/p/5938547.html">ç»†æ•°JDKé‡Œçš„è®¾è®¡æ¨¡å¼<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ29tbWFuZF9wYXR0ZXJu" title="https://en.wikipedia.org/wiki/Command_pattern">wikiçš„å‘½ä»¤æ¨¡å¼<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;å‘½ä»¤æ¨¡å¼&quot;&gt;&lt;a href=&quot;#å‘½ä»¤æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;å‘½ä»¤æ¨¡å¼&quot;&gt;&lt;/a&gt;å‘½ä»¤æ¨¡å¼&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;wikiä¸Šçš„æè¿° Encapsulate a request as an object, thereby allowing for the parameterization of clients with different requests, and the queuing or logging of requests. It also allows for the support of undoable operations.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¿»è¯‘æ„æ€ï¼ŒæŠŠè¯·æ±‚å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œå…è®¸æˆ‘ä»¬å¯ä»¥å¯¹å®¢æˆ·ç«¯çš„ä¸åŒè¯·æ±‚è¿›è¡Œå‚æ•°åŒ–ï¼Œä»¥åŠå¯¹è¯·æ±‚è¿›è¡Œæ’é˜Ÿæˆ–è®°å½•ã€‚è¿˜å…è®¸æ”¯æŒæ’¤é”€æ“ä½œã€‚çœ‹èµ·æ¥å¥½åƒå¾ˆå¤æ‚ï¼Œå¾ˆéš¾ç†è§£ã€‚
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="å‘½ä»¤" scheme="http://damonchow.github.io/tags/%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹çŠ¶æ€æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2018/12/24/design-pattern-state/"/>
    <id>http://damonchow.github.io/2018/12/24/design-pattern-state/</id>
    <published>2018-12-24T08:46:14.000Z</published>
    <updated>2018-12-26T02:39:52.567Z</updated>
    
    <content type="html"><![CDATA[<h3 id="çŠ¶æ€æ¨¡å¼"><a href="#çŠ¶æ€æ¨¡å¼" class="headerlink" title="çŠ¶æ€æ¨¡å¼"></a>çŠ¶æ€æ¨¡å¼</h3><blockquote><p>åœ¨çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰ä¸­ï¼Œç±»çš„è¡Œä¸ºæ˜¯åŸºäºå®ƒçš„çŠ¶æ€æ”¹å˜çš„ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨çŠ¶æ€æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºè¡¨ç¤ºå„ç§çŠ¶æ€çš„å¯¹è±¡å’Œä¸€ä¸ªè¡Œä¸ºéšç€çŠ¶æ€å¯¹è±¡æ”¹å˜è€Œæ”¹å˜çš„ context å¯¹è±¡ã€‚é€šä¿—ç‚¹å°±æ˜¯ä¸€ä¸ªå¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚</p></blockquote><a id="more"></a><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p><strong>æ„å›¾</strong> å…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥å¥½åƒä¿®æ”¹äº†å®ƒçš„ç±»ã€‚</p><p><strong>ä¸»è¦è§£å†³</strong> å¯¹è±¡çš„è¡Œä¸ºä¾èµ–äºå®ƒçš„çŠ¶æ€ï¼ˆå±æ€§ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®å®ƒçš„çŠ¶æ€æ”¹å˜è€Œæ”¹å˜å®ƒçš„ç›¸å…³è¡Œä¸ºã€‚</p><p><strong>ä½•æ—¶ä½¿ç”¨</strong> ä»£ç ä¸­åŒ…å«å¤§é‡ä¸å¯¹è±¡çŠ¶æ€æœ‰å…³çš„æ¡ä»¶è¯­å¥ã€‚</p><p><strong>å¦‚ä½•è§£å†³</strong> å°†å„ç§å…·ä½“çš„çŠ¶æ€ç±»æŠ½è±¡å‡ºæ¥ã€‚</p><p><strong>å…³é”®ä»£ç </strong> é€šå¸¸å‘½ä»¤æ¨¡å¼çš„æ¥å£ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ã€‚è€ŒçŠ¶æ€æ¨¡å¼çš„æ¥å£ä¸­æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ–¹æ³•ã€‚è€Œä¸”ï¼ŒçŠ¶æ€æ¨¡å¼çš„å®ç°ç±»çš„æ–¹æ³•ï¼Œä¸€èˆ¬è¿”å›å€¼ï¼Œæˆ–è€…æ˜¯æ”¹å˜å®ä¾‹å˜é‡çš„å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒçŠ¶æ€æ¨¡å¼ä¸€èˆ¬å’Œå¯¹è±¡çš„çŠ¶æ€æœ‰å…³ã€‚å®ç°ç±»çš„æ–¹æ³•æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œè¦†ç›–æ¥å£ä¸­çš„æ–¹æ³•ã€‚çŠ¶æ€æ¨¡å¼å’Œå‘½ä»¤æ¨¡å¼ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ç”¨äºæ¶ˆé™¤ ifâ€¦else ç­‰æ¡ä»¶é€‰æ‹©è¯­å¥ã€‚</p><p><strong>UMLå›¾</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/3344200-0407b24a011bc7fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p><strong>ä¸»è¦è§’è‰²</strong></p><blockquote><p>1ï¼‰Context(ç¯å¢ƒç±»)ï¼šç¯å¢ƒç±»æ‹¥æœ‰å„ç§ä¸åŒçŠ¶æ€çš„å¯¹è±¡ï¼Œä½œä¸ºå¤–éƒ¨ä½¿ç”¨çš„æ¥å£ï¼Œè´Ÿè´£è°ƒç”¨çŠ¶æ€ç±»æ¥å£ã€‚ </p><p>2ï¼‰State(æŠ½è±¡çŠ¶æ€)ï¼šæŠ½è±¡çŠ¶æ€æ—¢å¯ä»¥ä¸ºæŠ½è±¡ç±»ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å®šä¹‰æˆæ¥å£ã€‚ä¸»è¦ç”¨äºå®šä¹‰çŠ¶æ€æŠ½è±¡æ–¹æ³•ï¼Œå…·ä½“å®ç°ç”±å­ç±»è´Ÿè´£ã€‚ </p><p>3ï¼‰ConcreteState(å…·ä½“çŠ¶æ€ç±»):å…·ä½“çŠ¶æ€ç±»ä¸ºæŠ½è±¡çŠ¶æ€çš„å®ç°è€…ï¼Œä¸åŒçš„çŠ¶æ€ç±»å¯¹åº”è¿™ä¸åŒçš„çŠ¶æ€ï¼Œå…¶å†…éƒ¨å®ç°ä¹Ÿä¸ç›¸åŒã€‚ç¯å¢ƒç±»ä¸­ä½¿ç”¨ä¸åŒçŠ¶æ€çš„å¯¹è±¡æ—¶ï¼Œèƒ½å®ç°ä¸åŒçš„å¤„ç†é€»è¾‘</p></blockquote><p><strong>åº”ç”¨å®ä¾‹</strong> </p><blockquote><p> 1ã€æ‰“ç¯®çƒçš„æ—¶å€™è¿åŠ¨å‘˜å¯ä»¥æœ‰æ­£å¸¸çŠ¶æ€ã€ä¸æ­£å¸¸çŠ¶æ€å’Œè¶…å¸¸çŠ¶æ€ã€‚</p><p> 2ã€æ›¾ä¾¯ä¹™ç¼–é’Ÿä¸­ï¼Œâ€™é’Ÿæ˜¯æŠ½è±¡æ¥å£â€™,â€™é’ŸAâ€™ç­‰æ˜¯å…·ä½“çŠ¶æ€ï¼Œâ€™æ›¾ä¾¯ä¹™ç¼–é’Ÿâ€™æ˜¯å…·ä½“ç¯å¢ƒï¼ˆContextï¼‰ã€‚</p></blockquote><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a><strong>ä¼˜ç‚¹</strong></h3><blockquote><p>1ã€å°è£…äº†è½¬æ¢è§„åˆ™ã€‚ </p><p>2ã€æšä¸¾å¯èƒ½çš„çŠ¶æ€ï¼Œåœ¨æšä¸¾çŠ¶æ€ä¹‹å‰éœ€è¦ç¡®å®šçŠ¶æ€ç§ç±»ã€‚ </p><p>3ã€å°†æ‰€æœ‰ä¸æŸä¸ªçŠ¶æ€æœ‰å…³çš„è¡Œä¸ºæ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œå¹¶ä¸”å¯ä»¥æ–¹ä¾¿åœ°å¢åŠ æ–°çš„çŠ¶æ€ï¼Œåªéœ€è¦æ”¹å˜å¯¹è±¡çŠ¶æ€å³å¯æ”¹å˜å¯¹è±¡çš„è¡Œä¸ºã€‚ </p><p>4ã€å…è®¸çŠ¶æ€è½¬æ¢é€»è¾‘ä¸çŠ¶æ€å¯¹è±¡åˆæˆä¸€ä½“ï¼Œè€Œä¸æ˜¯æŸä¸€ä¸ªå·¨å¤§çš„æ¡ä»¶è¯­å¥å—ã€‚ </p><p>5ã€å¯ä»¥è®©å¤šä¸ªç¯å¢ƒå¯¹è±¡å…±äº«ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ï¼Œä»è€Œå‡å°‘ç³»ç»Ÿä¸­å¯¹è±¡çš„ä¸ªæ•°ã€‚</p></blockquote><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a><strong>ç¼ºç‚¹</strong></h3><blockquote><p>1ã€çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨å¿…ç„¶ä¼šå¢åŠ ç³»ç»Ÿç±»å’Œå¯¹è±¡çš„ä¸ªæ•°ã€‚ </p><p>2ã€çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°éƒ½è¾ƒä¸ºå¤æ‚ï¼Œå¦‚æœä½¿ç”¨ä¸å½“å°†å¯¼è‡´ç¨‹åºç»“æ„å’Œä»£ç çš„æ··ä¹±ã€‚</p><p> 3ã€çŠ¶æ€æ¨¡å¼å¯¹â€å¼€é—­åŸåˆ™â€çš„æ”¯æŒå¹¶ä¸å¤ªå¥½ï¼Œå¯¹äºå¯ä»¥åˆ‡æ¢çŠ¶æ€çš„çŠ¶æ€æ¨¡å¼ï¼Œå¢åŠ æ–°çš„çŠ¶æ€ç±»éœ€è¦ä¿®æ”¹é‚£äº›è´Ÿè´£çŠ¶æ€è½¬æ¢çš„æºä»£ç ï¼Œå¦åˆ™æ— æ³•åˆ‡æ¢åˆ°æ–°å¢çŠ¶æ€ï¼Œè€Œä¸”ä¿®æ”¹æŸä¸ªçŠ¶æ€ç±»çš„è¡Œä¸ºä¹Ÿéœ€ä¿®æ”¹å¯¹åº”ç±»çš„æºä»£ç ã€‚</p></blockquote><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><blockquote><ul><li><p>è¡Œä¸ºéšçŠ¶æ€æ”¹å˜è€Œæ”¹å˜çš„åœºæ™¯ã€‚</p></li><li><p>æ¡ä»¶ã€åˆ†æ”¯è¯­å¥çš„ä»£æ›¿è€…ã€‚</p></li></ul></blockquote><h3 id="çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„å¯¹æ¯”"><a href="#çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„å¯¹æ¯”" class="headerlink" title="çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„å¯¹æ¯”"></a>çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„å¯¹æ¯”</h3><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“ï¼ŒçŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„ç»“æ„æ˜¯ç›¸ä¼¼çš„ï¼Œä½†å®ƒä»¬çš„æ„å›¾ä¸åŒã€‚è®©æˆ‘ä»¬é‡æ¸©ä¸€ä¸‹å®ƒä»¬çš„ä¸»è¦ä¸åŒä¹‹å¤„ï¼š</p><blockquote><ol><li>ç­–ç•¥æ¨¡å¼å°è£…äº†ä¸€ç»„ç›¸å…³ç®—æ³•ï¼Œå®ƒå…è®¸Clientåœ¨è¿è¡Œæ—¶ä½¿ç”¨å¯äº’æ¢çš„è¡Œä¸ºï¼›çŠ¶æ€æ¨¡å¼å¸®åŠ©ä¸€ä¸ªç±»åœ¨ä¸åŒçš„çŠ¶æ€æ˜¾ç¤ºä¸åŒçš„è¡Œä¸ºã€‚</li><li>çŠ¶æ€æ¨¡å¼å°è£…äº†å¯¹è±¡çš„çŠ¶æ€ï¼Œè€Œç­–ç•¥æ¨¡å¼å°è£…ç®—æ³•æˆ–ç­–ç•¥ã€‚å› ä¸ºçŠ¶æ€æ˜¯è·Ÿå¯¹è±¡å¯†åˆ‡ç›¸å…³çš„ï¼Œå®ƒä¸èƒ½è¢«é‡ç”¨ï¼›è€Œé€šè¿‡ä»Contextä¸­åˆ†ç¦»å‡ºç­–ç•¥æˆ–ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é‡ç”¨å®ƒä»¬ã€‚</li><li>åœ¨çŠ¶æ€æ¨¡å¼ä¸­ï¼Œæ¯ä¸ªçŠ¶æ€é€šè¿‡æŒæœ‰Contextçš„å¼•ç”¨ï¼Œæ¥å®ç°çŠ¶æ€è½¬ç§»ï¼›ä½†æ˜¯æ¯ä¸ªç­–ç•¥éƒ½ä¸æŒæœ‰Contextçš„å¼•ç”¨ï¼Œå®ƒä»¬åªæ˜¯è¢«Contextä½¿ç”¨ã€‚</li><li>ç­–ç•¥å®ç°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä½¿ç”¨å®ƒçš„å¯¹è±¡ï¼Œä¾‹å¦‚Collections.sort()ï¼Œå®ƒçš„å‚æ•°åŒ…å«ä¸€ä¸ªComparatorç­–ç•¥ã€‚å¦ä¸€æ–¹é¢ï¼ŒçŠ¶æ€æ˜¯Contextå¯¹è±¡è‡ªå·±çš„ä¸€éƒ¨åˆ†ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼ŒContextå¯¹è±¡ä»ä¸€ä¸ªçŠ¶æ€è½¬ç§»åˆ°å¦ä¸€ä¸ªçŠ¶æ€ã€‚</li><li>è™½ç„¶å®ƒä»¬éƒ½ç¬¦åˆOCPåŸåˆ™ï¼Œç­–ç•¥æ¨¡å¼ä¹Ÿç¬¦åˆSRPåŸåˆ™ï¼ˆå•ä¸€èŒè´£åŸåˆ™ï¼‰ï¼Œå› ä¸ºæ¯ä¸ªç­–ç•¥éƒ½å°è£…è‡ªå·±çš„ç®—æ³•ï¼Œä¸”ä¸ä¾èµ–å…¶ä»–ç­–ç•¥ã€‚ä¸€ä¸ªç­–ç•¥çš„æ”¹å˜ï¼Œå¹¶ä¸ä¼šå¯¼è‡´å…¶ä»–ç­–ç•¥çš„å˜åŒ–ã€‚</li><li>å¦ä¸€ä¸ªç†è®ºä¸Šçš„ä¸åŒï¼šç­–ç•¥æ¨¡å¼å®šä¹‰äº†å¯¹è±¡â€œæ€ä¹ˆåšâ€çš„éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œæ’åºå¯¹è±¡æ€ä¹ˆå¯¹æ•°æ®æ’åºã€‚çŠ¶æ€æ¨¡å¼å®šä¹‰äº†å¯¹è±¡â€œæ˜¯ä»€ä¹ˆâ€å’Œâ€œä»€ä¹ˆæ—¶å€™åšâ€çš„éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œå¯¹è±¡å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Œä»€ä¹ˆæ—¶å€™å¤„åœ¨æŸä¸ªç‰¹å®šçš„çŠ¶æ€ã€‚</li><li>çŠ¶æ€æ¨¡å¼ä¸­å¾ˆå¥½çš„å®šä¹‰äº†çŠ¶æ€è½¬ç§»çš„æ¬¡åºï¼›è€Œç­–ç•¥æ¨¡å¼å¹¶æ— æ­¤éœ€è¦ï¼šClientå¯ä»¥è‡ªç”±çš„é€‰æ‹©ä»»ä½•ç­–ç•¥ã€‚</li><li>ä¸€äº›å¸¸è§çš„ç­–ç•¥æ¨¡å¼çš„ä¾‹å­æ˜¯å°è£…ç®—æ³•ï¼Œä¾‹å¦‚æ’åºç®—æ³•ï¼ŒåŠ å¯†ç®—æ³•æˆ–è€…å‹ç¼©ç®—æ³•ã€‚å¦‚æœä½ çœ‹åˆ°ä½ çš„ä»£ç éœ€è¦ä½¿ç”¨ä¸åŒç±»å‹çš„ç›¸å…³ç®—æ³•ï¼Œé‚£ä¹ˆè€ƒè™‘ä½¿ç”¨ç­–ç•¥æ¨¡å¼å§ã€‚è€Œè¯†åˆ«ä½•æ—¶ä½¿ç”¨çŠ¶æ€æ¨¡å¼æ˜¯å¾ˆç®€å•çš„ï¼šå¦‚æœä½ éœ€è¦ç®¡ç†çŠ¶æ€å’ŒçŠ¶æ€è½¬ç§»ï¼Œä½†ä¸æƒ³ä½¿ç”¨å¤§é‡åµŒå¥—çš„æ¡ä»¶è¯­å¥ï¼Œé‚£ä¹ˆå°±æ˜¯å®ƒäº†ã€‚</li><li>æœ€åä½†æœ€é‡è¦çš„ä¸€ä¸ªä¸åŒä¹‹å¤„æ˜¯ï¼Œç­–ç•¥çš„æ”¹å˜ç”±Clientå®Œæˆï¼›è€ŒçŠ¶æ€çš„æ”¹å˜ï¼Œç”±Contextæˆ–çŠ¶æ€è‡ªå·±ã€‚</li></ol></blockquote><h3 id="é¡¹ç›®å®ä¾‹"><a href="#é¡¹ç›®å®ä¾‹" class="headerlink" title="é¡¹ç›®å®ä¾‹"></a>é¡¹ç›®å®ä¾‹</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci9zdGF0ZQ==" title="https://github.com/DamonChow/design_pattern/tree/master/state">è·³è½¬åˆ°æˆ‘çš„æºç åœ°å€<i class="fa fa-external-link"></i></span></p><p>simple1åŒ…ä¸­ä¸»è¦æ˜¯å¯¹é£æ‰‡çš„å¼€å…³çŠ¶æ€è¿›è¡Œè½¬æ¢ï¼Œå…¶å®æˆ‘ä»¬æ˜¯æŠŠçŠ¶æ€æ”¾åœ¨çŠ¶æ€ç±»ä¸­è¿›è¡ŒæŒ‰ç…§å›ºå®šçš„é€»è¾‘è½¬æ¢ï¼Œä½†æ˜¯è¿™ç§æ¨¡å¼å…¶å®ä»–ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œä¸ºä»€ä¹ˆäº†ï¼Œå› ä¸ºä¸€æ—¦æˆ‘ä»¬å‘ç”Ÿæ–°å¢ã€ä¿®æ”¹æˆ–è€…åˆ é™¤çŠ¶æ€çš„æ—¶å€™ï¼Œå°±éœ€è¦ä¿®æ”¹çŠ¶æ€ç±»ä¸­çš„çŠ¶æ€è½¬æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Context context = <span class="keyword">new</span> Context(<span class="keyword">new</span> CloseLevelState());</span><br><span class="line">        context.right();</span><br><span class="line">        context.right();</span><br><span class="line">        context.right();</span><br><span class="line">        context.left();</span><br><span class="line">        context.right();</span><br><span class="line">        context.right();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fyjy0dgqvcj31cc07egoh.jpg" alt="image-20181226103419685"></p><p>æŠ½è±¡çŠ¶æ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">LevelState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å·¦è½¬</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">left</span><span class="params">(Context context)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å³è½¬</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">right</span><span class="params">(Context context)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰æ¡£ä½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">info</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“æ¡£ä½çŠ¶æ€ï¼Œæˆ‘åªåˆ—äº†2ä¸ªï¼Œå…¶ä»–çš„ç±»ä¼¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OneLevelState</span> <span class="keyword">implements</span> <span class="title">LevelState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">left</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        LevelState levelState = <span class="keyword">new</span> CloseLevelState();</span><br><span class="line">        context.setLevelState(levelState);</span><br><span class="line">        log.info(<span class="string">"é£æ‰‡å·¦è½¬åˆ°&#123;&#125;"</span>, levelState.info());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">right</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        LevelState levelState = <span class="keyword">new</span> TwoLevelState();</span><br><span class="line">        context.setLevelState(levelState);</span><br><span class="line">        log.info(<span class="string">"é£æ‰‡å³è½¬åˆ°&#123;&#125;"</span>, levelState.info());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">info</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"1æ¡£"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloseLevelState</span> <span class="keyword">implements</span> <span class="title">LevelState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">left</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        LevelState levelState = <span class="keyword">new</span> ForeLevelState();</span><br><span class="line">        context.setLevelState(levelState);</span><br><span class="line">        log.info(<span class="string">"é£æ‰‡å·¦è½¬åˆ°&#123;&#125;"</span>, levelState.info());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">right</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        LevelState levelState = <span class="keyword">new</span> OneLevelState();</span><br><span class="line">        context.setLevelState(levelState);</span><br><span class="line">        log.info(<span class="string">"é£æ‰‡å³è½¬åˆ°&#123;&#125;"</span>, levelState.info());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">info</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"0æ¡£"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœŸæ­£çš„å¼€å…³ä¹Ÿå°±æ˜¯ä¸Šä¸‹æ–‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LevelState levelState;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">left</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        levelState.left(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">right</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        levelState.right(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">info</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> levelState.info();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nvbmd3ZW5iaW5hc2RmL2FydGljbGUvZGV0YWlscy81MTgzMTkyNg==" title="https://blog.csdn.net/songwenbinasdf/article/details/51831926">Javaä¸­ï¼ŒçŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„åŒºåˆ«<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2Rlc2lnbi1wYXR0ZXJuL3N0YXRlLXBhdHRlcm4uaHRtbA==" title="http://www.runoob.com/design-pattern/state-pattern.html">çŠ¶æ€æ¨¡å¼|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;çŠ¶æ€æ¨¡å¼&quot;&gt;&lt;a href=&quot;#çŠ¶æ€æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;çŠ¶æ€æ¨¡å¼&quot;&gt;&lt;/a&gt;çŠ¶æ€æ¨¡å¼&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;åœ¨çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰ä¸­ï¼Œç±»çš„è¡Œä¸ºæ˜¯åŸºäºå®ƒçš„çŠ¶æ€æ”¹å˜çš„ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨çŠ¶æ€æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºè¡¨ç¤ºå„ç§çŠ¶æ€çš„å¯¹è±¡å’Œä¸€ä¸ªè¡Œä¸ºéšç€çŠ¶æ€å¯¹è±¡æ”¹å˜è€Œæ”¹å˜çš„ context å¯¹è±¡ã€‚é€šä¿—ç‚¹å°±æ˜¯ä¸€ä¸ªå¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="çŠ¶æ€" scheme="http://damonchow.github.io/tags/%E7%8A%B6%E6%80%81/"/>
    
  </entry>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹è´£ä»»é“¾æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2018/12/21/design-pattern-chain/"/>
    <id>http://damonchow.github.io/2018/12/21/design-pattern-chain/</id>
    <published>2018-12-21T07:43:12.000Z</published>
    <updated>2019-01-26T02:26:50.972Z</updated>
    
    <content type="html"><![CDATA[<h3 id="è´£ä»»é“¾æ¨¡å¼"><a href="#è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="è´£ä»»é“¾æ¨¡å¼"></a>è´£ä»»é“¾æ¨¡å¼</h3><blockquote><p>é¡¾åæ€ä¹‰ï¼Œè´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ã€‚è¿™ç§æ¨¡å¼ç»™äºˆè¯·æ±‚çš„ç±»å‹ï¼Œå¯¹è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œé€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä¾æ­¤ç±»æ¨ã€‚</p></blockquote><a id="more"></a><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p><strong>æ„å›¾</strong>  é¿å…è¯·æ±‚å‘é€è€…ä¸æ¥æ”¶è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œè®©å¤šä¸ªå¯¹è±¡éƒ½æœ‰å¯èƒ½æ¥æ”¶è¯·æ±‚ï¼Œå°†è¿™äº›å¯¹è±¡è¿æ¥æˆä¸€æ¡é“¾ï¼Œå¹¶ä¸”æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><p><strong>ä¸»è¦è§£å†³</strong>  èŒè´£é“¾ä¸Šçš„å¤„ç†è€…è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°èŒè´£é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’ï¼Œæ‰€ä»¥èŒè´£é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚</p><p><strong>ä½•æ—¶ä½¿ç”¨</strong>  åœ¨å¤„ç†æ¶ˆæ¯çš„æ—¶å€™ä»¥è¿‡æ»¤å¾ˆå¤šé“ã€‚</p><p><strong>å¦‚ä½•è§£å†³</strong>  æ‹¦æˆªçš„ç±»éƒ½å®ç°ç»Ÿä¸€æ¥å£ã€‚</p><p><strong>å…³é”®ä»£ç </strong>  Handler é‡Œé¢èšåˆå®ƒè‡ªå·±ï¼Œåœ¨ handleRequest é‡Œåˆ¤æ–­æ˜¯å¦åˆé€‚ï¼Œå¦‚æœæ²¡è¾¾åˆ°æ¡ä»¶åˆ™å‘ä¸‹ä¼ é€’ã€‚</p><p><strong>çº¯è´£ä»»é“¾ä¸ä¸çº¯è´£ä»»é“¾</strong></p><ul><li>çº¯ï¼šçº¯è´£ä»»é“¾ä¸­çš„èŠ‚ç‚¹åªæœ‰ä¸¤ç§è¡Œä¸ºï¼Œä¸€å¤„ç†è´£ä»»ï¼ŒäºŒå°†è´£ä»»ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ä¸å…è®¸å‡ºç°æŸä¸€ä¸ªèŠ‚ç‚¹å¤„ç†éƒ¨åˆ†æˆ–å…¨éƒ¨è´£ä»»ååˆå°†è´£ä»»å‘ä¸‹ä¼ é€’çš„æƒ…å†µã€‚</li><li>ä¸çº¯ï¼šå…è®¸æŸä¸ªè¯·æ±‚è¢«ä¸€ä¸ªèŠ‚ç‚¹å¤„ç†éƒ¨åˆ†è´£ä»»åå†å‘ä¸‹ä¼ é€’ï¼Œæˆ–è€…å¤„ç†å®Œåå…¶åç»­èŠ‚ç‚¹å¯ä»¥ç»§ç»­å¤„ç†è¯¥è´£ä»»ï¼Œè€Œä¸”ä¸€ä¸ªè´£ä»»å¯ä»¥æœ€ç»ˆä¸è¢«ä»»ä½•èŠ‚ç‚¹æ‰€å¤„ç†ã€‚</li></ul><p><strong>ä¸»è¦è§’è‰²</strong></p><blockquote><ul><li><p>Handlerï¼ˆæŠ½è±¡å¤„ç†è€…ï¼‰ï¼š å®šä¹‰ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ï¼Œæä¾›å¯¹åç»­å¤„ç†è€…çš„å¼•ç”¨</p></li><li><p>ConcreteHandlerï¼ˆå…·ä½“å¤„ç†è€…ï¼‰ï¼š æŠ½è±¡å¤„ç†è€…çš„å­ç±»ï¼Œå¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œå¯é€‰å°†è¯·æ±‚å¤„ç†æ‰è¿˜æ˜¯ä¼ ç»™ä¸‹å®¶ï¼›åœ¨å…·ä½“å¤„ç†è€…ä¸­å¯ä»¥è®¿é—®é“¾ä¸­ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿è¯·æ±‚çš„è½¬å‘</p></li></ul></blockquote><p><strong>åº”ç”¨å®ä¾‹</strong> </p><blockquote><p>1ã€çº¢æ¥¼æ¢¦ä¸­çš„â€å‡»é¼“ä¼ èŠ±â€ã€‚ </p><p>2ã€JS ä¸­çš„äº‹ä»¶å†’æ³¡ã€‚ </p><p>3ã€JAVA WEB ä¸­ Apache Tomcat å¯¹ Encoding çš„å¤„ç†ï¼ŒStruts2 çš„æ‹¦æˆªå™¨ï¼Œjsp servlet çš„ Filterã€‚</p></blockquote><p><strong>ä¼˜ç‚¹</strong>  </p><blockquote><p>1ã€é™ä½è€¦åˆåº¦ã€‚å®ƒå°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è§£è€¦ã€‚ </p><p>2ã€ç®€åŒ–äº†å¯¹è±¡ã€‚ä½¿å¾—å¯¹è±¡ä¸éœ€è¦çŸ¥é“é“¾çš„ç»“æ„ã€‚</p><p>3ã€å¢å¼ºç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ã€‚é€šè¿‡æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…è°ƒåŠ¨å®ƒä»¬çš„æ¬¡åºï¼Œå…è®¸åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚ </p><p>4ã€å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»å¾ˆæ–¹ä¾¿ã€‚</p></blockquote><p><strong>ç¼ºç‚¹</strong> </p><blockquote><p> 1ã€ä¸èƒ½ä¿è¯è¯·æ±‚ä¸€å®šè¢«æ¥æ”¶ã€‚</p><p> 2ã€ç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ï¼Œè€Œä¸”åœ¨è¿›è¡Œä»£ç è°ƒè¯•æ—¶ä¸å¤ªæ–¹ä¾¿ï¼Œå¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚</p><p> 3ã€å¯èƒ½ä¸å®¹æ˜“è§‚å¯Ÿè¿è¡Œæ—¶çš„ç‰¹å¾ï¼Œæœ‰ç¢äºé™¤é”™ã€‚</p></blockquote><p><strong>ä½¿ç”¨åœºæ™¯</strong>  </p><blockquote><p>1ã€æœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ï¼Œå…·ä½“å“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚ç”±è¿è¡Œæ—¶åˆ»è‡ªåŠ¨ç¡®å®šã€‚ </p><p>2ã€åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚ </p><p>3ã€å¯åŠ¨æ€æŒ‡å®šä¸€ç»„å¯¹è±¡å¤„ç†è¯·æ±‚ã€‚</p></blockquote><h3 id="Githubé¡¹ç›®æè¿°"><a href="#Githubé¡¹ç›®æè¿°" class="headerlink" title="Githubé¡¹ç›®æè¿°"></a>Githubé¡¹ç›®æè¿°</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci9jaGFpbg==" title="https://github.com/DamonChow/design_pattern/tree/master/chain">è·³è½¬åˆ°æˆ‘çš„è´£ä»»é“¾è®¾è®¡æ¨¡å¼æºç <i class="fa fa-external-link"></i></span></p><h4 id="1-å‡ºè¡Œæ–¹å¼"><a href="#1-å‡ºè¡Œæ–¹å¼" class="headerlink" title="1.å‡ºè¡Œæ–¹å¼"></a>1.å‡ºè¡Œæ–¹å¼</h4><p>travelåŒ…é‡Œä¸»è¦å¯¹å‡ºè¡Œæ–¹å¼çš„è´£ä»»é“¾æ¨¡å¼ã€‚è·Ÿè¿›ç”¨æˆ·èº«ä¸Šçš„é’±ï¼Œåœ¨ä¼˜å…ˆçº§å¦‚é£æœº-&gt;ç«è½¦-&gt;å¤§å·´çš„é¡ºåºä¸‹é€‰æ‹©å¯¹åº”çš„å‡ºè¡Œæ¨¡å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Handler planeHandler = <span class="keyword">new</span> PlaneHandler();</span><br><span class="line">        Handler trainHandler = <span class="keyword">new</span> TrainHandler();</span><br><span class="line">        Handler busHandler = <span class="keyword">new</span> BusHandler();</span><br><span class="line">        planeHandler.setNext(trainHandler);</span><br><span class="line">        trainHandler.setNext(busHandler);</span><br><span class="line"></span><br><span class="line">        planeHandler.handleRequest(<span class="string">"è€ç‹"</span>, <span class="number">40</span>d);</span><br><span class="line">        planeHandler.handleRequest(<span class="string">"å¼ ä¸‰"</span>, <span class="number">140</span>d);</span><br><span class="line">        planeHandler.handleRequest(<span class="string">"æå››"</span>, <span class="number">240</span>d);</span><br><span class="line">        planeHandler.handleRequest(<span class="string">"å´è€äº”"</span>, <span class="number">340</span>d);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fyh0p6ch0qj31d2054tam.jpg" alt="img"></p><p>æŠ½è±¡å¤„ç†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹ä¸€ä¸ªé“¾èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> Handler next;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String name, Double wallet)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“çš„å¤„ç†è€…ï¼ˆé£æœºã€ç«è½¦ã€å¤§å·´ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PlaneHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price = <span class="number">280</span>d;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String name, Double wallet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (price &lt;= wallet) &#123;</span><br><span class="line">            log.info(<span class="string">"&#123;&#125;èº«ä¸Šçš„é’±å¯ä»¥åé£æœºã€‚"</span>, name);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (Objects.nonNull(next)) &#123;</span><br><span class="line">            next.handleRequest(name, wallet);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"&#123;&#125;é’±ä¸å¤Ÿï¼Œåªèƒ½å¾’æ­¥å•¦"</span>, name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrainHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price = <span class="number">149.99</span>d;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String name, Double wallet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (price &lt;= wallet) &#123;</span><br><span class="line">           log.info(<span class="string">"&#123;&#125;èº«ä¸Šçš„é’±åªèƒ½åç«è½¦ã€‚"</span>, name);</span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (Objects.nonNull(next)) &#123;</span><br><span class="line">            next.handleRequest(name, wallet);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"&#123;&#125;é’±ä¸å¤Ÿï¼Œåªèƒ½å¾’æ­¥å•¦"</span>, name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BusHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price = <span class="number">59.99</span>d;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String name, Double wallet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (price &lt;= wallet) &#123;</span><br><span class="line">            log.info(<span class="string">"&#123;&#125;èº«ä¸Šçš„é’±åªèƒ½åå¤§å·´ã€‚"</span>, name);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (Objects.nonNull(next)) &#123;</span><br><span class="line">            next.handleRequest(name, wallet);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"&#123;&#125;é’±ä¸å¤Ÿï¼Œåªèƒ½å¾’æ­¥å•¦"</span>, name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-å‡ºè¡Œæ–¹å¼2ï¼Œå‚è€ƒFilteré“¾çš„å†™æ³•"><a href="#2-å‡ºè¡Œæ–¹å¼2ï¼Œå‚è€ƒFilteré“¾çš„å†™æ³•" class="headerlink" title="2.å‡ºè¡Œæ–¹å¼2ï¼Œå‚è€ƒFilteré“¾çš„å†™æ³•"></a>2.å‡ºè¡Œæ–¹å¼2ï¼Œå‚è€ƒFilteré“¾çš„å†™æ³•</h4><p>travel2åŒ…æ˜¯å¯¹travelåŒ…çš„é‡æ–°å†™æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        HandlerChain chain = <span class="keyword">new</span> HandlerChain();</span><br><span class="line">        Handler planeHandler = <span class="keyword">new</span> PlaneHandler();</span><br><span class="line">        Handler trainHandler = <span class="keyword">new</span> TrainHandler();</span><br><span class="line">        Handler busHandler = <span class="keyword">new</span> BusHandler();</span><br><span class="line">        chain.addHandler(planeHandler);</span><br><span class="line">        chain.addHandler(trainHandler);</span><br><span class="line">        chain.addHandler(busHandler);</span><br><span class="line"></span><br><span class="line">        chain.handle(<span class="string">"è€ç‹"</span>, <span class="number">40</span>d);</span><br><span class="line">        chain.handle(<span class="string">"å¼ ä¸‰"</span>, <span class="number">140</span>d);</span><br><span class="line">        chain.handle(<span class="string">"æå››"</span>, <span class="number">240</span>d);</span><br><span class="line">        chain.handle(<span class="string">"å´è€äº”"</span>, <span class="number">340</span>d);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fyh1k4ax4xj31i4060di2.jpg" alt="image-20181223222027677"></p><p>æŠ½è±¡å¤„ç†è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String name, Double wallet, HandlerChain chain)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“å¤„ç†è€…ï¼ˆé£æœºã€ç«è½¦ã€å¤§å·´ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PlaneHandler</span> <span class="keyword">implements</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price = <span class="number">280</span>d;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String name, Double wallet, HandlerChain chain)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (price &lt;= wallet) &#123;</span><br><span class="line">            log.info(<span class="string">"&#123;&#125;èº«ä¸Šçš„é’±å¯ä»¥åé£æœºã€‚"</span>, name);</span><br><span class="line">            chain.reuse();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        chain.handle(name, wallet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrainHandler</span> <span class="keyword">implements</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price = <span class="number">149.99</span>d;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String name, Double wallet, HandlerChain chain)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (price &lt;= wallet) &#123;</span><br><span class="line">            log.info(<span class="string">"&#123;&#125;èº«ä¸Šçš„é’±åªèƒ½åç«è½¦ã€‚"</span>, name);</span><br><span class="line">            chain.reuse();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        chain.handle(name, wallet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BusHandler</span> <span class="keyword">implements</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> price = <span class="number">59.99</span>d;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String name, Double wallet, HandlerChain chain)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (price &lt;= wallet) &#123;</span><br><span class="line">            log.info(<span class="string">"&#123;&#125;èº«ä¸Šçš„é’±åªèƒ½åå¤§å·´ã€‚"</span>, name);</span><br><span class="line">            chain.reuse();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        chain.handle(name, wallet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è´£ä»»é“¾ç®¡ç†è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandlerChain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Handler&gt; handlerList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»´æŠ¤å½“å‰é“¾ä¸Šä½ç½®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pos;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é“¾çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> handlerLength;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addHandler</span><span class="params">(Handler handler)</span> </span>&#123;</span><br><span class="line">        handlerList.add(handler);</span><br><span class="line">        handlerLength = handlerList.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String name, <span class="keyword">double</span> wallet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(handlerList)) &#123;</span><br><span class="line">            log.error(<span class="string">"æœ‰é’±ï¼Œä½†æ²¡æä¾›æœåŠ¡ï¼Œ&#123;&#125;ä¹Ÿä¼°è®¡å°±åªèƒ½æ­¥è¡Œäº†ã€‚"</span>, name);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pos &gt;= handlerLength) &#123;</span><br><span class="line">            log.error(<span class="string">"èº«ä¸Šé’±ä¸å¤Ÿï¼Œ&#123;&#125;ä¹Ÿä¼°è®¡å°±åªèƒ½æ­¥è¡Œäº†ã€‚"</span>, name);</span><br><span class="line">            reuse();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Handler handler = handlerList.get(pos++);</span><br><span class="line">        <span class="keyword">if</span> (Objects.isNull(handler)) &#123;</span><br><span class="line">            log.error(<span class="string">"å‡æœåŠ¡ï¼Œ&#123;&#125;ä¹Ÿä¼°è®¡å°±åªèƒ½æ­¥è¡Œäº†ã€‚"</span>, name);</span><br><span class="line">            reuse();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        handler.handleRequest(name, wallet, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é“¾é‡æ–°ä½¿ç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reuse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        pos = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å­¦ä¹ Webé¡¹ç›®çš„Filter"><a href="#å­¦ä¹ Webé¡¹ç›®çš„Filter" class="headerlink" title="å­¦ä¹ Webé¡¹ç›®çš„Filter"></a>å­¦ä¹ Webé¡¹ç›®çš„Filter</h3><p>å¾…è¡¥å……â€¦</p><p>è¡¥å……è¡¥å……é—ç•™çš„Filterè¿‡æ»¤å™¨ä¸­çš„è´£ä»»é“¾å¤„ç†ã€‚</p><p>æœ¬æ¬¡ä¸»è¦æ˜¯å¯¹Tomcatä¸­çš„Filterå¤„ç†ç®€å•çš„æ¢³ç†ï¼Œå¦‚æœ‰ä¸æ­£ç¡®çš„åœ°æ–¹ï¼Œè¿˜æœ›æŒ‡å‡ºæ¥ï¼Œå¤§å®¶äº’å‹‰ï¼Œå…±è¿›ã€‚</p><p>è€é¡¹ç›®å¤§å®¶å¯ä»¥åœ¨web.xmlä¸­é…ç½®filterï¼Œç°ä½¿ç”¨Springbootåï¼Œä¹Ÿæœ‰ä¸¤ç§é…ç½®filteræ–¹å¼ï¼Œé€šè¿‡åˆ›å»ºFilterRegistrationBeançš„æ–¹å¼å’Œé€šè¿‡æ³¨è§£@WebFilter+@ServletComponentScançš„æ–¹å¼ã€‚</p><p>ä¸‰ä¸ªä¸»è¦çš„è§’è‰²</p><p>FIlterï¼Œä¸å¤šä»‹ç»äº†ã€‚</p><p>FilterChain  servletå®¹å™¨æä¾›çš„å¼€å‘è°ƒç”¨é“¾çš„è¿‡æ»¤è¯·æ±‚çš„èµ„æºã€‚é€šè¿‡è°ƒç”¨ä¸‹ä¸€ä¸ªfilterå®ç°è¿‡æ»¤ï¼Œåœ¨æ•´ä½“é“¾ä¸Šã€‚</p><p>FilterConfig  filterçš„é…ç½®å™¨ï¼Œåœ¨servletå®¹å™¨åœ¨Filteråˆå§‹åŒ–çš„æ—¶å€™ä¼ é€’ä¿¡æ¯ã€‚</p><p>å…·ä½“çš„filterï¼Œä¸»è¦è¯´è¯´Springä¸­çš„ä¸¤ä¸ªæŠ½è±¡Filterï¼ŒGenericFilterBeanå’ŒOncePerRequestFilterã€‚</p><p>å‰è€…ä¸»è¦æ˜¯åšinitå’Œdestroyçš„æ“ä½œï¼Œé‡ç‚¹è¿˜æ˜¯initæ–¹æ³•ï¼Œdestroyåªæ˜¯ç©ºå®ç°è€Œå·²ã€‚</p><p>åè€…ä¸»è¦æ˜¯åšçœŸæ­£çš„doFilteræ“ä½œï¼Œä¹Ÿæ˜¯æˆ‘ä»¬åœ¨Springä¸­åˆ›å»ºFilteré€šå¸¸ç»§æ‰¿çš„ã€‚</p><p>è€ŒApplicationFilterChainå°±ç®—Tomcatä¸­çš„FilterChainå®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The int which is used to maintain the current position</span></span><br><span class="line"><span class="comment">     * in the filter chain.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pos = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The int which gives the current number of filters in the chain.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"><span class="comment">//å®‰å…¨ç›¸å…³çš„ï¼Œæš‚ä¸å…³æ³¨</span></span><br><span class="line">    <span class="keyword">if</span>( Globals.IS_SECURITY_ENABLED ) &#123;</span><br><span class="line">        <span class="keyword">final</span> ServletRequest req = request;</span><br><span class="line">        <span class="keyword">final</span> ServletResponse res = response;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            java.security.AccessController.doPrivileged(</span><br><span class="line">                <span class="keyword">new</span> java.security.PrivilegedExceptionAction&lt;Void&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Void <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">                        <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">                        internalDoFilter(req,res);</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            );</span><br><span class="line">        &#125; <span class="keyword">catch</span>( PrivilegedActionException pe) &#123;</span><br><span class="line">            Exception e = pe.getException();</span><br><span class="line">            <span class="keyword">if</span> (e <span class="keyword">instanceof</span> ServletException)</span><br><span class="line">                <span class="keyword">throw</span> (ServletException) e;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> IOException)</span><br><span class="line">                <span class="keyword">throw</span> (IOException) e;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> RuntimeException)</span><br><span class="line">                <span class="keyword">throw</span> (RuntimeException) e;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//çœŸæ­£çš„doFilter</span></span><br><span class="line">        internalDoFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">internalDoFilter</span><span class="params">(ServletRequest request,</span></span></span><br><span class="line"><span class="function"><span class="params">                              ServletResponse response)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"><span class="comment">//pos è°ƒç”¨é“¾ä¸­å½“å‰è¿æ¥ç‚¹æ‰€åœ¨çš„ä½ç½®</span></span><br><span class="line">    <span class="comment">//n è°ƒç”¨é“¾æ€»èŠ‚ç‚¹é•¿åº¦</span></span><br><span class="line">    <span class="comment">// Call the next filter if there is one</span></span><br><span class="line">    <span class="keyword">if</span> (pos &lt; n) &#123;</span><br><span class="line">        <span class="comment">//å¯¹èŠ‚ç‚¹è¿›è¡Œè‡ªå¢ pos++</span></span><br><span class="line">        ApplicationFilterConfig filterConfig = filters[pos++];</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//å½“å‰èŠ‚ç‚¹å°äºæ€»é•¿åº¦åï¼Œä»filteré…ç½®ç±»ä¸­å–å‡ºfilter</span></span><br><span class="line">            Filter filter = filterConfig.getFilter();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (request.isAsyncSupported() &amp;&amp; <span class="string">"false"</span>.equalsIgnoreCase(</span><br><span class="line">                    filterConfig.getFilterDef().getAsyncSupported())) &#123;</span><br><span class="line">                request.setAttribute(Globals.ASYNC_SUPPORTED_ATTR, Boolean.FALSE);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>( Globals.IS_SECURITY_ENABLED ) &#123;</span><br><span class="line">                <span class="keyword">final</span> ServletRequest req = request;</span><br><span class="line">                <span class="keyword">final</span> ServletResponse res = response;</span><br><span class="line">                Principal principal =</span><br><span class="line">                    ((HttpServletRequest) req).getUserPrincipal();</span><br><span class="line"></span><br><span class="line">                Object[] args = <span class="keyword">new</span> Object[]&#123;req, res, <span class="keyword">this</span>&#125;;</span><br><span class="line">                SecurityUtil.doAsPrivilege (<span class="string">"doFilter"</span>, filter, classType, args, principal);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//çœŸæ­£çš„filter</span></span><br><span class="line">                filter.doFilter(request, response, <span class="keyword">this</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | ServletException | RuntimeException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            e = ExceptionUtils.unwrapInvocationTargetException(e);</span><br><span class="line">            ExceptionUtils.handleThrowable(e);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(sm.getString(<span class="string">"filterChain.filter"</span>), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We fell off the end of the chain -- call the servlet instance</span></span><br><span class="line"><span class="comment">//åˆ°äº†è°ƒç”¨é“¾ç»“å°¾å¤„ï¼Œå°±çœŸæ­£è°ƒç”¨servletå®ä¾‹çš„servlet.service(request, response);</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (ApplicationDispatcher.WRAP_SAME_OBJECT) &#123;</span><br><span class="line">            lastServicedRequest.set(request);</span><br><span class="line">            lastServicedResponse.set(response);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (request.isAsyncSupported() &amp;&amp; !servletSupportsAsync) &#123;</span><br><span class="line">            request.setAttribute(Globals.ASYNC_SUPPORTED_ATTR,</span><br><span class="line">                    Boolean.FALSE);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Use potentially wrapped request from this point</span></span><br><span class="line">        <span class="keyword">if</span> ((request <span class="keyword">instanceof</span> HttpServletRequest) &amp;&amp;</span><br><span class="line">                (response <span class="keyword">instanceof</span> HttpServletResponse) &amp;&amp;</span><br><span class="line">                Globals.IS_SECURITY_ENABLED ) &#123;</span><br><span class="line">            <span class="keyword">final</span> ServletRequest req = request;</span><br><span class="line">            <span class="keyword">final</span> ServletResponse res = response;</span><br><span class="line">            Principal principal =</span><br><span class="line">                ((HttpServletRequest) req).getUserPrincipal();</span><br><span class="line">            Object[] args = <span class="keyword">new</span> Object[]&#123;req, res&#125;;</span><br><span class="line">            SecurityUtil.doAsPrivilege(<span class="string">"service"</span>,</span><br><span class="line">                                       servlet,</span><br><span class="line">                                       classTypeUsedInService,</span><br><span class="line">                                       args,</span><br><span class="line">                                       principal);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            servlet.service(request, response);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException | ServletException | RuntimeException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> e;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        e = ExceptionUtils.unwrapInvocationTargetException(e);</span><br><span class="line">        ExceptionUtils.handleThrowable(e);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(sm.getString(<span class="string">"filterChain.servlet"</span>), e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (ApplicationDispatcher.WRAP_SAME_OBJECT) &#123;</span><br><span class="line">            lastServicedRequest.set(<span class="keyword">null</span>);</span><br><span class="line">            lastServicedResponse.set(<span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Prepare for reuse of the filters and wrapper executed by this chain.</span></span><br><span class="line"><span class="comment">* é‡å¤ä½¿ç”¨filterè°ƒç”¨é“¾ï¼Œposé‡è®¾ä¸º0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reuse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    pos = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡ç‚¹ä»ApplicationFilterChainä¸­æŒ‘å‡ºå‡ ä¸ªé‡è¦çš„æ–¹æ³•æ‹¿å‡ºæ¥åˆ†æä¸‹Filterçš„è°ƒç”¨é“¾ï¼Œå…¶å®è¿˜æœ‰å‡ å¤„æ²¡æœ‰å…·ä½“è®²åˆ°ï¼ŒApplicationFilterChainæ˜¯åˆé€‚åˆ›å»ºçš„ï¼ŒFilteræ˜¯æ€ä¹ˆåŠ å…¥åˆ°ApplicationFilterChainä¸­çš„ã€‚è¿™æ¶‰åŠåˆ°Tomcatæ˜¯æ€æ ·åŠ è½½Contentçš„ï¼Œä¸‹æ¬¡åˆ†æTomcatçš„æ—¶å€™ï¼Œå†æ¥å…·ä½“åˆ†æï¼Œå®ƒæ˜¯å¦‚ä½•è¿ä½œçš„ï¼Œå¦‚ä½•åŠ è½½web.xmlã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ2hhaW4tb2YtcmVzcG9uc2liaWxpdHlfcGF0dGVybg==" title="https://en.wikipedia.org/wiki/Chain-of-responsibility_pattern">ç»´åŸºçš„è´£ä»»é“¾æ¨¡å¼<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2Rlc2lnbi1wYXR0ZXJuL2NoYWluLW9mLXJlc3BvbnNpYmlsaXR5LXBhdHRlcm4uaHRtbA==" title="http://www.runoob.com/design-pattern/chain-of-responsibility-pattern.html">è´£ä»»é“¾æ¨¡å¼|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL3czY25vdGUvZmlsdGVyLWZpbHRlcmNoYWluLWZpbHRlcmNvbmZpZy1pbnRyby5odG1s" title="http://www.runoob.com/w3cnote/filter-filterchain-filterconfig-intro.html">Filterã€FilterConfigã€FilterChain|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9lNTJkMTAwNWQ4ZjE=" title="https://www.jianshu.com/p/e52d1005d8f1">å—ä¹¡æ¸…æ°´çš„å®é™…é¡¹ç›®è¿ç”¨ä¹‹Responsibility-Chainæ¨¡å¼<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9zZWdtZW50ZmF1bHQuY29tL2EvMTE5MDAwMDAxMjE0ODQ5Ng==" title="https://segmentfault.com/a/1190000012148496">ä¸€èµ·å­¦è®¾è®¡æ¨¡å¼ - è´£ä»»é“¾æ¨¡å¼<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;è´£ä»»é“¾æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è´£ä»»é“¾æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è´£ä»»é“¾æ¨¡å¼&quot;&gt;&lt;/a&gt;è´£ä»»é“¾æ¨¡å¼&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;é¡¾åæ€ä¹‰ï¼Œè´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ã€‚è¿™ç§æ¨¡å¼ç»™äºˆè¯·æ±‚çš„ç±»å‹ï¼Œå¯¹è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œé€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä¾æ­¤ç±»æ¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="è´£ä»»é“¾" scheme="http://damonchow.github.io/tags/%E8%B4%A3%E4%BB%BB%E9%93%BE/"/>
    
  </entry>
  
  <entry>
    <title>æŠ˜è…¾Javaè®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼</title>
    <link href="http://damonchow.github.io/2018/12/20/design-pattern-strategy/"/>
    <id>http://damonchow.github.io/2018/12/20/design-pattern-strategy/</id>
    <published>2018-12-20T06:31:13.000Z</published>
    <updated>2019-01-05T02:09:35.082Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h3><blockquote><p>åœ¨ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰ä¸­ï¼Œä¸€ä¸ªç±»çš„è¡Œä¸ºæˆ–å…¶ç®—æ³•å¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ”¹ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚ç®€å•ç†è§£å°±æ˜¯ä¸€ç»„ç®—æ³•ï¼Œå¯ä»¥äº’æ¢ï¼Œå†ç®€å•ç‚¹ç­–ç•¥å°±æ˜¯å°è£…ç®—æ³•ã€‚</p></blockquote><a id="more"></a><p><strong>æ„å›¾</strong> å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚</p><p><strong>ä¸»è¦è§£å†³</strong> åœ¨æœ‰å¤šç§ç®—æ³•ç›¸ä¼¼çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ ifâ€¦else æ‰€å¸¦æ¥çš„å¤æ‚å’Œéš¾ä»¥ç»´æŠ¤ã€‚</p><p><strong>ä½•æ—¶ä½¿ç”¨</strong> ä¸€ä¸ªç³»ç»Ÿæœ‰è®¸å¤šè®¸å¤šç±»ï¼Œè€ŒåŒºåˆ†å®ƒä»¬çš„åªæ˜¯ä»–ä»¬ç›´æ¥çš„è¡Œä¸ºã€‚</p><p><strong>å¦‚ä½•è§£å†³</strong> å°†è¿™äº›ç®—æ³•å°è£…æˆä¸€ä¸ªä¸€ä¸ªçš„ç±»ï¼Œä»»æ„åœ°æ›¿æ¢ã€‚</p><p><strong>ä¸»è¦è§’è‰²</strong> </p><ul><li>ä¸Šä¸‹æ–‡Contextï¼Œæ‹¥æœ‰ä¸€ä¸ªStrategyçš„å¼•ç”¨</li><li>æŠ½è±¡ç­–ç•¥Strategyï¼Œå¾€å¾€æ˜¯ä¸€ä¸ªæ¥å£(å å¤§éƒ¨åˆ†æƒ…å†µ)æˆ–è€…æŠ½è±¡ç±»ï¼Œé€šå¸¸æä¾›å„ç§å…·ä½“ç­–ç•¥çš„æ¥å£</li><li>å…·ä½“ç­–ç•¥ï¼Œè¿™å°±æ˜¯é‡ç‚¹äº†ï¼Œå°è£…äº†å„ç§å…·ä½“çš„ç®—æ³•</li></ul><p><strong>UML</strong></p><p><img src="https://upload.wikimedia.org/wikipedia/commons/4/45/W3sDesign_Strategy_Design_Pattern_UML.jpg" alt="img"></p><p><strong>åº”ç”¨å®ä¾‹</strong> </p><ul><li>è¯¸è‘›äº®çš„é”¦å›Šå¦™è®¡ï¼Œæ¯ä¸€ä¸ªé”¦å›Šå°±æ˜¯ä¸€ä¸ªç­–ç•¥ï¼›</li><li>æ—…è¡Œçš„å‡ºæ¸¸æ–¹å¼ï¼Œé€‰æ‹©éª‘è‡ªè¡Œè½¦ã€åæ±½è½¦ï¼Œæ¯ä¸€ç§æ—…è¡Œæ–¹å¼éƒ½æ˜¯ä¸€ä¸ªç­–ç•¥ï¼›</li><li>JAVA AWT ä¸­çš„ LayoutManagerï¼›</li></ul><p><strong>ä¼˜ç‚¹</strong> 1ã€ç®—æ³•å¯ä»¥è‡ªç”±åˆ‡æ¢ã€‚ 2ã€é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶åˆ¤æ–­ã€‚ 3ã€æ‰©å±•æ€§è‰¯å¥½ã€‚</p><p><strong>ç¼ºç‚¹</strong>  1ã€ç­–ç•¥ç±»ä¼šå¢å¤šã€‚ 2ã€æ‰€æœ‰ç­–ç•¥ç±»éƒ½éœ€è¦å¯¹å¤–æš´éœ²ã€‚</p><p><strong>ä½¿ç”¨åœºæ™¯</strong> </p><ol><li>å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿé‡Œé¢æœ‰è®¸å¤šç±»ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äºå®ƒä»¬çš„è¡Œä¸ºï¼Œé‚£ä¹ˆä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°è®©ä¸€ä¸ªå¯¹è±¡åœ¨è®¸å¤šè¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§è¡Œä¸ºã€‚</li><li>ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ã€‚</li><li>å¦‚æœä¸€ä¸ªå¯¹è±¡æœ‰å¾ˆå¤šçš„è¡Œä¸ºï¼Œå¦‚æœä¸ç”¨æ°å½“çš„æ¨¡å¼ï¼Œè¿™äº›è¡Œä¸ºå°±åªå¥½ä½¿ç”¨å¤šé‡çš„æ¡ä»¶é€‰æ‹©è¯­å¥æ¥å®ç°ã€‚</li></ol><blockquote><p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong> å¦‚æœä¸€ä¸ªç³»ç»Ÿçš„ç­–ç•¥å¤šäºå››ä¸ªï¼Œå°±éœ€è¦è€ƒè™‘ä½¿ç”¨æ··åˆæ¨¡å¼ï¼Œè§£å†³ç­–ç•¥ç±»è†¨èƒ€çš„é—®é¢˜ã€‚</p></blockquote><h3 id="é¡¹ç›®æè¿°"><a href="#é¡¹ç›®æè¿°" class="headerlink" title="é¡¹ç›®æè¿°"></a><strong>é¡¹ç›®æè¿°</strong></h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RhbW9uQ2hvdy9kZXNpZ25fcGF0dGVybi90cmVlL21hc3Rlci9zdHJhdGVneQ==" title="https://github.com/DamonChow/design_pattern/tree/master/strategy">è·³è½¬åˆ°æˆ‘çš„ç­–ç•¥æ¨¡å¼GitHub<i class="fa fa-external-link"></i></span></p><h4 id="1-æ“ä½œè¡Œä¸º"><a href="#1-æ“ä½œè¡Œä¸º" class="headerlink" title="1.æ“ä½œè¡Œä¸º"></a>1.æ“ä½œè¡Œä¸º</h4><p>simple1åŒ…ï¼Œä¸»è¦å¯¹æ“ä½œè¡Œä¸ºåŒ…è£…äº†åŠ å‡ä¹˜é™¤æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Context context = <span class="keyword">new</span> Context(<span class="keyword">new</span> AddStrategy());</span><br><span class="line">        log.info(<span class="string">"10 + 5 = &#123;&#125;"</span>, context.executeStrategy(<span class="number">10</span>, <span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">        context.setStrategy(<span class="keyword">new</span> SubstractStrategy());</span><br><span class="line">        log.info(<span class="string">"10 - 5 = &#123;&#125;"</span>, context.executeStrategy(<span class="number">10</span>, <span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">        context.setStrategy(<span class="keyword">new</span> MultiplyStrategy());</span><br><span class="line">        log.info(<span class="string">"10 * 5 = &#123;&#125;"</span>, context.executeStrategy(<span class="number">10</span>, <span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">        context.setStrategy(<span class="keyword">new</span> DivideStrategy());</span><br><span class="line">        log.info(<span class="string">"10 / 5 = &#123;&#125;"</span>, context.executeStrategy(<span class="number">10</span>, <span class="number">5</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœ</p><p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fyfcvvwjkfj317a04wmyd.jpg" alt="img"></p><h4 id="2-å‡ºç°æ–¹å¼"><a href="#2-å‡ºç°æ–¹å¼" class="headerlink" title="2.å‡ºç°æ–¹å¼"></a>2.å‡ºç°æ–¹å¼</h4><p>simple2åŒ…æè¿°ï¼Œä¸»è¦å¯¹å‡ºè¡Œæ–¹å¼çš„åŒ…è£…ï¼ŒåŒ…è£…äº†3ç§å‡ºè¡Œæ–¹å¼ï¼Œ</p><p>æ‰§è¡Œç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TravelApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Context context = <span class="keyword">new</span> Context(<span class="keyword">new</span> BusStrategy());</span><br><span class="line">        context.executeStrategy(<span class="string">"è€ç‹"</span>);</span><br><span class="line"></span><br><span class="line">        context.setStrategy(<span class="keyword">new</span> BicycleStrategy());</span><br><span class="line">        context.executeStrategy(<span class="string">"è€å¼ "</span>);</span><br><span class="line"></span><br><span class="line">        context.setStrategy(<span class="keyword">new</span> WalkStrategy());</span><br><span class="line">        context.executeStrategy(<span class="string">"è€æ"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœ</p><p><u><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fyfcryetvxj31es04475r.jpg" alt="image-20181222104657926"></u></p><p>ç­–ç•¥ä¸Šä¸‹æ–‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Strategy strategy;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Context</span><span class="params">(Strategy strategy)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.strategy = strategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡ºè¡Œ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">executeStrategy</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        strategy.travel(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠ½è±¡ç­–ç•¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡ºç°æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">travel</span><span class="params">(String name)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2Rlc2lnbi1wYXR0ZXJuL3N0cmF0ZWd5LXBhdHRlcm4uaHRtbA==" title="http://www.runoob.com/design-pattern/strategy-pattern.html">ç­–ç•¥æ¨¡å¼|èœé¸Ÿæ•™ç¨‹<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU3RyYXRlZ3lfcGF0dGVybg==" title="https://en.wikipedia.org/wiki/Strategy_pattern">ç»´åŸºé‡Œçš„ç­–ç•¥æ¨¡å¼<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC83YjdkZTgxY2RmYmU=" title="https://www.jianshu.com/p/7b7de81cdfbe">å—ä¹¡æ¸…æ°´çš„å®é™…é¡¹ç›®è¿ç”¨ä¹‹Strategyæ¨¡å¼<i class="fa fa-external-link"></i></span></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ç­–ç•¥æ¨¡å¼&quot;&gt;&lt;a href=&quot;#ç­–ç•¥æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;ç­–ç•¥æ¨¡å¼&quot;&gt;&lt;/a&gt;ç­–ç•¥æ¨¡å¼&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;åœ¨ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰ä¸­ï¼Œä¸€ä¸ªç±»çš„è¡Œä¸ºæˆ–å…¶ç®—æ³•å¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ”¹ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚ç®€å•ç†è§£å°±æ˜¯ä¸€ç»„ç®—æ³•ï¼Œå¯ä»¥äº’æ¢ï¼Œå†ç®€å•ç‚¹ç­–ç•¥å°±æ˜¯å°è£…ç®—æ³•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="ç­–ç•¥" scheme="http://damonchow.github.io/tags/%E7%AD%96%E7%95%A5/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼æ±‡æ€»</title>
    <link href="http://damonchow.github.io/2018/12/19/design-pattern/"/>
    <id>http://damonchow.github.io/2018/12/19/design-pattern/</id>
    <published>2018-12-19T03:27:02.000Z</published>
    <updated>2019-01-26T08:24:05.630Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h2><p>23ç§è®¾è®¡æ¨¡å¼å¤§çº²â€¦</p><a id="more"></a><p><a href="https://damonchow.github.io/2019/01/05/principles-of-software-design-patterns/">è½¯ä»¶è®¾è®¡æ¨¡å¼åŸåˆ™</a></p><h3 id="æ„å»ºæ¨¡å¼"><a href="#æ„å»ºæ¨¡å¼" class="headerlink" title="æ„å»ºæ¨¡å¼"></a>æ„å»ºæ¨¡å¼</h3><ul><li>Builder ï¼ˆå»ºé€ è€…æ¨¡å¼ï¼‰</li><li>Abstract Factory ï¼ˆæŠ½è±¡å·¥å‚æ¨¡å¼ï¼‰</li><li>Factory Method ï¼ˆå·¥å‚æ–¹æ³•ï¼‰</li><li>Prototype ï¼ˆåŸå‹æ¨¡å¼ï¼‰</li><li>Singleton ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰</li></ul><h3 id="ç»“æ„æ¨¡å¼"><a href="#ç»“æ„æ¨¡å¼" class="headerlink" title="ç»“æ„æ¨¡å¼"></a>ç»“æ„æ¨¡å¼</h3><ul><li>Adapter ï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰</li><li>Bridge ï¼ˆæ¡¥æ¥æ¨¡å¼ï¼‰</li><li>Composite ï¼ˆç»„åˆæ¨¡å¼ï¼‰</li><li>Decorator ï¼ˆè£…é¥°æ¨¡å¼ï¼‰</li><li>Facade ï¼ˆå¤–è§‚æ¨¡å¼ï¼‰</li><li>Flyweight ï¼ˆäº«å…ƒæ¨¡å¼ï¼‰</li><li>Proxy ï¼ˆä»£ç†æ¨¡å¼ï¼‰</li></ul><h3 id="è¡Œä¸ºæ¨¡å¼"><a href="#è¡Œä¸ºæ¨¡å¼" class="headerlink" title="è¡Œä¸ºæ¨¡å¼"></a>è¡Œä¸ºæ¨¡å¼</h3><ul><li>Chain of Responsibilityï¼ˆ<a href="https://damonchow.github.io/2018/12/21/design-pattern-chain/">è´£ä»»é“¾æ¨¡å¼</a>ï¼‰</li><li>Command ï¼ˆ<a href="https://damonchow.github.io/2019/01/02/design-pattern-command/">å‘½ä»¤æ¨¡å¼</a>ï¼‰</li><li>Interpreter ï¼ˆ<a href="https://damonchow.github.io/2019/01/10/design-pattern-interpreter">è§£é‡Šå™¨æ¨¡å¼</a>ï¼‰</li><li>Iteratorï¼ˆ<a href="https://damonchow.github.io/2019/01/02/design-pattern-iterator/">è¿­ä»£å™¨æ¨¡å¼</a>ï¼‰</li><li>Mediatorï¼ˆ<a href="http://damonchow.github.io/2019/01/15/design-pattern-mediator">ä¸­ä»‹è€…æ¨¡å¼</a>ï¼‰</li><li>Mementoï¼ˆ<a href="https://damonchow.github.io/2019/01/26/design-pattern-memento/">å¤‡å¿˜å½•æ¨¡å¼</a>ï¼‰</li><li>Observerï¼ˆ<a href="(http://damonchow.github.io/2019/01/24/design-pattern-observer">è§‚å¯Ÿè€…æ¨¡å¼</a>)ï¼‰</li><li>Stateï¼ˆ<a href="https://damonchow.github.io/2018/12/24/design-pattern-state">çŠ¶æ€æ¨¡å¼</a>ï¼‰</li><li>Strategy (<a href="https://damonchow.github.io/2018/12/20/design-pattern-strategy/">ç­–ç•¥æ¨¡å¼</a>)</li><li>Template Method ï¼ˆæ¨¡æ¿æ–¹æ³•ï¼‰</li><li>Visitorï¼ˆ<a href="https://damonchow.github.io/2019/01/07/design-pattern-visitor/">è®¿é—®è€…æ¨¡å¼</a>ï¼‰</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è®¾è®¡æ¨¡å¼&quot;&gt;&lt;a href=&quot;#è®¾è®¡æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;è®¾è®¡æ¨¡å¼&quot;&gt;&lt;/a&gt;è®¾è®¡æ¨¡å¼&lt;/h2&gt;&lt;p&gt;23ç§è®¾è®¡æ¨¡å¼å¤§çº²â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="æ±‡æ€»" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%B1%87%E6%80%BB/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>æµ‹è¯•è¯„è®º</title>
    <link href="http://damonchow.github.io/2018/12/18/test/"/>
    <id>http://damonchow.github.io/2018/12/18/test/</id>
    <published>2018-12-18T06:19:13.000Z</published>
    <updated>2019-01-05T08:19:21.894Z</updated>
    
    <content type="html"><![CDATA[<p>æµ‹è¯•è¯„è®º</p><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æµ‹è¯•è¯„è®º&lt;/p&gt;
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://damonchow.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
</feed>
